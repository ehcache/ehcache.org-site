<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Implementing a Cache Event Listener Factory and Cache Event Listener</title><link rel="Prev" href="co-clst_configuring_cache_listener.html" title="Previous"><link rel="Next" href="co-clst_adding_listener_programatically.html" title="Next"><link rel="StyleSheet" href="css/_ehcache_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/_ehcache_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/ehcache-webhelp/co-clst_implementing_listener_factory.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pm2xEMwoF1Rb7TL4ajioN9A" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/ehcache-webhelp/co-clst_implementing_listener_factory.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../ehcache-webhelp/_ehcache_all.1.017.html#wwconnect_header">Product Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../ehcache-webhelp/to-title_ehcache_developer_guide.html#wwconnect_header">Ehcache Developer Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../ehcache-webhelp/to-clst_cache_event_listeners.html#wwconnect_header">Cache Event Listeners</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Implementing a Cache Event Listener Factory and Cache Event Listener</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_12_3_27_10_1" class="Heading_3">Implementing a Cache Event Listener Factory and Cache Event Listener</div><div id="ww3_12_3_27_10_3_2" class="Body">A CacheEventListenerFactory is an abstract factory for creating cache event listeners. Implementers should provide their own concrete factory, extending this abstract factory. It can then be configured in ehcache.xml. The following example demonstrates how to create an abstract CacheEventListenerFactory:</div><div id="ww3_12_3_27_10_3_4" class="Preformatted">/** <br>* An abstract factory for creating listeners. Implementers should provide <br>* their own concrete factory extending this factory. It can then be configured <br>* in ehcache.xml <br>* <br>*/ <br>public abstract class CacheEventListenerFactory { <br>/** <br>* Create a CacheEventListener <br>* <br>* @param properties implementation specific properties. These are configured <br>* as comma-separated name-value pairs in ehcache.xml <br>* @return a constructed CacheEventListener <br>*/ <br>public abstract CacheEventListener createCacheEventListener(Properties properties); <br>}</div><div id="ww3_12_3_27_10_3_6" class="Body">The following example demonstrates how to create a concrete implementation of the CacheEventListener interface: </div><div id="ww3_12_3_27_10_3_8" class="Preformatted">/** <br>* Allows implementers to register callback methods that will be executed when <br>* a cache event occurs. <br>* The events include: <br>* &lt;ol&gt; <br>* &lt;li&gt;put Element <br>* &lt;li&gt;update Element <br>* &lt;li&gt;remove Element <br>* &lt;li&gt;an Element expires, either because timeToLive or timeToIdle has been <br>* reached. <br>* &lt;/ol&gt; <br>* <br>* Callbacks to these methods are synchronous and unsynchronized. It is the <br>* responsibility of the implementer to safely handle the potential performance <br>* and thread safety issues depending on what their listener is doing. <br>* <br>* Events are guaranteed to be notified in the order in which they occurred. <br>* <br>* Cache also has putQuiet and removeQuiet methods which do not notify listeners. <br>* <br>*/ <br>public interface CacheEventListener extends Cloneable { <br>/** <br>* Called immediately after an element has been removed. The remove method will <br>* block until this method returns. <br>* <br>* Ehcache does not check for <br>* <br>* <br>* As the {@link net.sf.ehcache.Element} has been removed, only what was the <br>* key of the element is known. <br>* <br>* <br>* @param cache   the cache emitting the notification <br>* @param element just deleted <br>*/ <br>void notifyElementRemoved(final Ehcache cache, final Element element) throws <br>&nbsp;&nbsp;CacheException; <br>/** <br>* Called immediately after an element has been put into the cache. The <br>* {@link net.sf.ehcache.Cache#put(net.sf.ehcache.Element)} method <br>* will block until this method returns. <br>* <br>* Implementers may wish to have access to the Element's fields, including value, <br>* so the element is provided. Implementers should be careful not to modify the <br>* element. The effect of any modifications is undefined. <br>* <br>* @param cache   the cache emitting the notification <br>* @param element the element which was just put into the cache. <br>*/ <br>void notifyElementPut(final Ehcache cache, final Element element) throws <br>&nbsp;&nbsp;CacheException; <br>/** <br>* Called immediately after an element has been put into the cache and the element <br>* already existed in the cache. This is thus an update. <br>* <br>* The {@link net.sf.ehcache.Cache#put(net.sf.ehcache.Element)} method <br>* will block until this method returns. <br>* <br>* Implementers may wish to have access to the Element's fields, including value, <br>* so the element is provided. Implementers should be careful not to modify the <br>* element. The effect of any modifications is undefined. <br>* <br>* @param cache   the cache emitting the notification <br>* @param element the element which was just put into the cache. <br>*/ <br>void notifyElementUpdated(final Ehcache cache, final Element element) throws <br>&nbsp;&nbsp;CacheException; <br>/** <br>* Called immediately after an element is found to be expired. The <br>* {@link net.sf.ehcache.Cache#remove(Object)} method will block until this <br>* method returns. <br>* As the {@link Element} has been expired, only what was the key of the element <br>* is known. <br>* <br>* Elements are checked for expiry in Ehcache at the following times: <br>* &lt;ul&gt; <br>* &lt;li&gt;When a get request is made <br>* &lt;li&gt;When an element is spooled to diskStore in accordance with a MemoryStore <br>* eviction policy <br>* &lt;li&gt;In the DiskStore when the expiry thread runs, which by default is <br>* {@link net.sf.ehcache.Cache#DEFAULT_EXPIRY_THREAD_INTERVAL_SECONDS} <br>* &lt;/ul&gt; <br>* If an element is found to be expired, it is deleted and this method is <br>* notified. <br>* <br>* @param cache   the cache emitting the notification <br>* @param element the element that has just expired <br>*    <br>*    Deadlock Warning: expiry will often come from the DiskStore <br>*    expiry thread. It holds a lock to the DiskStore at the time the <br>*    notification is sent. If the implementation of this method calls into a <br>*    synchronized Cache method and that subsequently calls into <br>*    DiskStore a deadlock will result. Accordingly implementers of this method <br>*    should not call back into Cache. <br>*/ <br>void notifyElementExpired(final Ehcache cache, final Element element); <br>/** <br>* Give the replicator a chance to cleanup and free resources when no longer <br>* needed <br>*/ <br>void dispose(); <br>/** <br>* Creates a clone of this listener. This method will only be called by Ehcache <br>* before a cache is initialized. <br>* <br>* This may not be possible for listeners after they have been initialized. <br>* Implementations should throw CloneNotSupportedException if they do not support <br>* clone. <br>* @return a clone <br>* @throws CloneNotSupportedException if the listener could not be cloned. <br>*/ <br>public Object clone() throws CloneNotSupportedException; <br>}</div><div id="ww3_12_3_27_10_3_10" class="Body">Two other methods are also available:</div><div id="ww3_12_3_27_10_3_12_2_3" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="codeph">void notifyElementEvicted(Ehcache cache, Element element)</span></div><div id="ww3_12_3_27_10_3_12_2_5" class="List_1_Continued">Called immediately after an element is evicted from the cache. Eviction, which happens when a cache entry is deleted from a store, should not be confused with removal, which is a result of calling <span class="codeph">Cache.removeElement(Element)</span>.</div><div id="ww3_12_3_27_10_3_12_4_3" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="codeph">void notifyRemoveAll(Ehcache cache)</span></div><div id="ww3_12_3_27_10_3_12_4_5" class="List_1_Continued">Called during <span class="codeph">Ehcache.removeAll()</span> to indicate that all elements have been removed from the cache in a bulk operation. The usual <span class="codeph">notifyElementRemoved(net.sf.ehcache.Ehcache, net.sf.ehcache.Element)</span> is not called. Only one notification is emitted because performance considerations do not allow for serially processing notifications where potentially millions of elements have been bulk deleted.</div><div id="ww3_12_3_27_10_3_14" class="Body">The implementations need to be placed in the classpath accessible to Ehcache. For details on how the loading of these classes will be done, see <span class="heading-page"><a href="../ehcache-webhelp/to-class_loading.html#wwconnect_header" title="Class Loading">Class Loading</a></span>.</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright Â© <span>2010</span><span>-2015</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/ehcache_online.png" alt="Product Logo"><!--	     <a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank" >Contact&#160;Support</a> --><!--         &#160;&#160;|&#160;&#160;  --><!--         <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank" >Community</a>  --><!--         &#160;&#160;  -->
          |&nbsp;&nbsp;
        <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>