<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Configuring the Peer Provider</title><link rel="Prev" href="co-rmi_suitable_element_types.html" title="Previous"><link rel="Next" href="co-rmi_configuring_the_cache_manager_listener.html" title="Next"><link rel="StyleSheet" href="css/ehcache_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/ehcache_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/Ehcache_Documentation_Set/co-rmi_configuring_the_peer_provider.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pN0zK0VnzqrMBCGWom6s37XQ" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/Ehcache_Documentation_Set/co-rmi_configuring_the_peer_provider.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/ehcache_all.1.188.html#wwconnect_header">Related Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/to-title_ehcache_replication_guide.html#wwconnect_header">Ehcache Replication Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/to-rmi_replicated_caching_using_rmi.html#wwconnect_header">Replicated Caching Using RMI</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Configuring the Peer Provider</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_15_7_9_10_1" class="Heading_3">Configuring the Peer Provider</div><div id="ww3_15_7_9_10_3_2_2" class="Section_Title">Peer Discovery</div><div id="ww3_15_7_9_10_3_2_4" class="Body">Ehcache has the notion of a group of caches acting as a replicated cache. Each of the caches is a peer to the others. There is no master cache. How do you know about the other caches that are in your cluster? This problem can be given the name Peer Discovery. Ehcache provides two mechanisms for peer discovery: manual and automatic.</div><div id="ww3_15_7_9_10_3_2_6" class="Body">To use one of the built-in peer discovery mechanisms, specify the class attribute of <span class="apiname">cacheManagerPeerProviderFactory</span> as <span class="apiname">net.sf.ehcache.distribution.RMICacheManagerPeerProviderFactory</span> in the ehcache.xml configuration file.</div><div id="ww3_15_7_9_10_3_4_2" class="Section_Title">Automatic Peer Discovery</div><div id="ww3_15_7_9_10_3_4_4" class="Body">Automatic discovery uses TCP multicast to establish and maintain a multicast group. It features minimal configuration and automatic addition to and deletion of members from the group. No a priori knowledge of the servers in the cluster is required. This is recommended as the default option. Peers send heartbeats to the group once per second. If a peer has not been heard of for 5 seconds it is dropped from the group. If a new peer starts sending heartbeats it is admitted to the group.</div><div id="ww3_15_7_9_10_3_4_6" class="Body">Any cache within the configuration set up as replicated will be made available for discovery by other peers.</div><div id="ww3_15_7_9_10_3_4_8" class="Body">To set automatic peer discovery, specify the properties attribute of <span class="apiname">cacheManagerPeerProviderFactory</span> as follows:</div><div id="ww3_15_7_9_10_3_4_10" class="Preformatted">peerDiscovery=automatic<br>multicastGroupAddress=multicast address | multicast host name<br>multicastGroupPort=port<br>timeToLive=0-255 <span class="emphasis">(See below in common problems before setting this)</span><br>hostName=<span class="emphasis">the hostname or IP of the interface to be used for <br>         sending and receiving multicast packets <br>         (relevant to mulithomed hosts only)</span></div><div id="ww3_15_7_9_10_3_6_2" class="Section_Title">Example</div><div id="ww3_15_7_9_10_3_6_4" class="Body">Suppose you have two servers in a cluster, server1 and server2. You wish to distribute sampleCache11 and sampleCache12. The configuration required for each server is identical, so the configuration for both server1 and server2 is the following:</div><div id="ww3_15_7_9_10_3_6_6" class="Preformatted">&lt;cacheManagerPeerProviderFactory<br>class="net.sf.ehcache.distribution.RMICacheManagerPeerProviderFactory"<br>properties="peerDiscovery=automatic, multicastGroupAddress=230.0.0.1,<br>multicastGroupPort=4446, timeToLive=32"/&gt;</div><div id="ww3_15_7_9_10_3_8_2" class="Section_Title">Manual Peer Discovery</div><div id="ww3_15_7_9_10_3_8_4" class="Body">Manual peer configuration requires the IP address and port of each listener to be known. Peers cannot be added or removed at runtime. Manual peer discovery is recommended where there are technical difficulties using multicast, such as a router between servers in a cluster that does not propagate multicast datagrams. You can also use it to set up one way replications of data, by having server2 know about server1 but not vice versa.</div><div id="ww3_15_7_9_10_3_8_6" class="Body">To set manual peer discovery, specify the properties attribute of <span class="apiname">cacheManagerPeerProviderFactory</span> as follows:</div><div id="ww3_15_7_9_10_3_8_8" class="Preformatted">peerDiscovery=manual<br>rmiUrls=//server:port/cacheName, ...</div><div id="ww3_15_7_9_10_3_8_10" class="Body">The rmiUrls is a list of the cache peers of the server being configured. Do not include the server being configured in the list.</div><div id="ww3_15_7_9_10_3_10_2" class="Section_Title">Example</div><div id="ww3_15_7_9_10_3_10_4" class="Body">Suppose you have two servers in a cluster, server1 and server2. You wish to distribute sampleCache11 and sampleCache12. The following is the configuration required for server1:</div><div id="ww3_15_7_9_10_3_10_6" class="Preformatted">&lt;cacheManagerPeerProviderFactory<br>class="net.sf.ehcache.distribution.RMICacheManagerPeerProviderFactory"<br>properties="peerDiscovery=manual,<br>rmiUrls=//server2:40001/sampleCache11|//server2:40001/sampleCache12"/&gt;</div><div id="ww3_15_7_9_10_3_10_8" class="Body">The following is the configuration required for server2:</div><div id="ww3_15_7_9_10_3_10_10" class="Preformatted">&lt;cacheManagerPeerProviderFactory<br>class="net.sf.ehcache.distribution.RMICacheManagerPeerProviderFactory"<br>properties="peerDiscovery=manual,<br>rmiUrls=//server1:40001/sampleCache11|//server1:40001/sampleCache12"/&gt;</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright Â© <span>2010</span><span>-2015</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/ehcache_online.png" alt="Product Logo"><!--	     <a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank" >Contact&#160;Support</a> --><!--         &#160;&#160;|&#160;&#160;  --><!--         <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank" >Community</a>  --><!--         &#160;&#160;  -->
          |&nbsp;&nbsp;
        <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>