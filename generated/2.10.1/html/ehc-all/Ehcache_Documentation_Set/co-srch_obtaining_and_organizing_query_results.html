<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Obtaining and Organizing Query Results</title><link rel="Prev" href="co-srch_creating_a_query.html" title="Previous"><link rel="Next" href="co-srch_best_practices_for_searches.html" title="Next"><link rel="StyleSheet" href="css/ehcache_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/_ehcache_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/Ehcache_Documentation_Set/co-srch_obtaining_and_organizing_query_results.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pToF3UbZLS7DGQLUiWAlfbw" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/Ehcache_Documentation_Set/co-srch_obtaining_and_organizing_query_results.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/_ehcache_all.1.016.html#wwconnect_header">Product Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/to-title_ehcache_developer_guide.html#wwconnect_header">Ehcache Developer Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/to-srch_searching_a_cache.html#wwconnect_header">Searching a Cache</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Obtaining and Organizing Query Results</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_12_3_13_14_1" class="Heading_3">Obtaining and Organizing Query Results</div><div id="ww3_12_3_13_14_3_2" class="Body">Queries return a Results object that contains a list of objects of class Result. Each element in the cache that a query finds is represented as a Result object. For example, if a query finds 350 elements, there will be 350 Result objects. However, if no keys or attributes are included but aggregators are included, there is exactly one Result present.</div><div id="ww3_12_3_13_14_3_4" class="Body">A Result object can contain:</div><div id="ww3_12_3_13_14_3_6_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>The Element key - when <span class="codeph">includeKeys()</span> is added to the query,</div><div id="ww3_12_3_13_14_3_6_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>The Element value - when <span class="codeph">includeValues()</span> is added to the query,</div><div id="ww3_12_3_13_14_3_6_6" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Predefined attribute(s) extracted from an Element value - when <span class="codeph">includeAttribute(...)</span> is added to the query. To access an attribute from a Result, use <span class="codeph">getAttribute(Attribute&lt;T&gt; attribute)</span>.</div><div id="ww3_12_3_13_14_3_6_8" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Aggregator results - Aggregator results are summaries computed for the search. They are available through Result.getAggregatorResults, which returns a list of Aggregators in the same order in which they were used in the query.</div><div id="ww3_12_3_13_14_3_8_2" class="Section_Title">Aggregators</div><div id="ww3_12_3_13_14_3_8_4" class="Body">Aggregators are added with <span class="codeph">query.includeAggregator(\&lt;attribute\&gt;.\&lt;aggregator\&gt;)</span>. For example, to find the sum of the age attribute:</div><div id="ww3_12_3_13_14_3_8_6" class="Preformatted">query.includeAggregator(age.sum());</div><div id="ww3_12_3_13_14_3_8_8" class="Body">For a complete list of aggregators, see Aggregators in the Ehcache Javadoc at <span class="external"><a href="http://www.ehcache.org/apidocs/2.10.1/" target="external_window">http://www.ehcache.org/apidocs/2.10.1/</a></span>.</div><div id="ww3_12_3_13_14_3_10_2" class="Section_Title">Ordering Results</div><div id="ww3_12_3_13_14_3_10_4" class="Body">Query results can be ordered in ascending or descending order by adding an addOrderBy clause to the query. This clause takes as parameters the attribute to order by and the ordering direction. For example, to order the results by ages in ascending order:</div><div id="ww3_12_3_13_14_3_10_6" class="Preformatted">query.addOrderBy(age, Direction.ASCENDING);</div><div id="ww3_12_3_13_14_3_12_2" class="Section_Title">Grouping Results</div><div id="ww3_12_3_13_14_3_12_4" class="Body">Query query results can be grouped similarly to using an SQL GROUP BY statement. The GroupBy feature provides the option to group results according to specified attributes. You can add an addGroupBy clause to the query, which takes as parameters the attributes to group by. For example, you can group results by department and location:</div><div id="ww3_12_3_13_14_3_12_6" class="Preformatted">Query q = cache.createQuery(); <br>Attribute&lt;String&gt; dept = cache.getSearchAttribute("dept"); <br>Attribute&lt;String&gt; loc = cache.getSearchAttribute("location"); <br>q.includeAttribute(dept); <br>q.includeAttribute(loc); <br>q.addCriteria(cache.getSearchAttribute("salary").gt(100000)); <br>q.includeAggregator(Aggregators.count()); <br>q.addGroupBy(dept, loc);</div><div id="ww3_12_3_13_14_3_12_8" class="Body">The GroupBy clause groups the results from includeAttribute(&nbsp;) and allows aggregate functions to be performed on the grouped attributes. To retrieve the attributes that are associated with the aggregator results, you can use:</div><div id="ww3_12_3_13_14_3_12_10" class="Preformatted">    String dept = singleResult.getAttribute(dept); <br>    String loc = singleResult.getAttribute(loc);</div><div id="ww3_12_3_13_14_3_14_2" class="Section_Title">GroupBy Rules</div><div id="ww3_12_3_13_14_3_14_4" class="Body">Grouping query results adds another step to the query. First, results are returned, and second the results are grouped. Note the following rules and considerations:</div><div id="ww3_12_3_13_14_3_14_6_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>In a query with a GroupBy clause, any attribute specified using includeAttribute(&nbsp;) should also be included in the GroupBy clause.</div><div id="ww3_12_3_13_14_3_14_6_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Special KEY or VALUE attributes cannot be used in a GroupBy clause. This means that includeKeys(&nbsp;) and includeValues(&nbsp;) cannot be used in a query that has a GroupBy clause.</div><div id="ww3_12_3_13_14_3_14_6_6" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Adding a GroupBy clause to a query changes the semantics of any aggregators passed in, so that they apply only within each group.</div><div id="ww3_12_3_13_14_3_14_6_8" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>As long as there is at least one aggregation function specified in a query, the grouped attributes are not required to be included in the result set, but they are typically requested anyway to make result processing easier.</div><div id="ww3_12_3_13_14_3_14_6_10" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>An addCriteria clause applies to all results prior to grouping.</div><div id="ww3_12_3_13_14_3_14_6_12" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>If OrderBy is used with GroupBy, the ordering attributes are limited to those listed in the GroupBy clause.</div><div id="ww3_12_3_13_14_3_16_2" class="Section_Title">Limiting the Size of Results</div><div id="ww3_12_3_13_14_3_16_4" class="Body">By default, a query can return an unlimited number of results. For example, the following query will return all keys in the cache.</div><div id="ww3_12_3_13_14_3_16_6" class="Preformatted">Query query = cache.createQuery(); <br>query.includeKeys(); <br>query.execute();</div><div id="ww3_12_3_13_14_3_16_8" class="Body">If too many results are returned, it could cause an OutOfMemoryError The maxResults clause is used to limit the size of the results. For example, to limit the above query to the first 100 elements found:</div><div id="ww3_12_3_13_14_3_16_10" class="Preformatted">Query query = cache.createQuery(); <br>query.includeKeys(); <br>query.maxResults(100); <br>query.execute();</div><div class="ww_skin_page_overflow"><table class="note1" summary=""><tr><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_12_3_13_14_3_16_12_1_3_1_1_1" class="Note"><span style="font-weight: bold">Note:  </span>&nbsp;</div></td><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_12_3_13_14_3_16_12_1_3_1_2" class="Table_Cell">When maxResults is used with GroupBy, it limits the number of groups.</div></td></tr></table></div><div id="ww3_12_3_13_14_3_16_14" class="Body">When you are done with the results, call the discard(&nbsp;) method to free up resources.</div><div id="ww3_12_3_13_14_3_16_16" class="Body">For additional information about managing large result sets, see the topics that relate to pagination in <span class="heading-page"><a href="../Ehcache_Documentation_Set/co-srch_best_practices_for_searches.html#wwconnect_header" title="Best Practices for Optimizing Searches">Best Practices for Optimizing Searches</a></span>.</div><div id="ww3_12_3_13_14_3_18_2" class="Section_Title">Interrogating Results</div><div id="ww3_12_3_13_14_3_18_4" class="Body">To determine what a query returned, use one of the interrogation methods on Results.:</div><div id="ww3_12_3_13_14_3_18_6_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>hasKeys(&nbsp;)</div><div id="ww3_12_3_13_14_3_18_6_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>hasValues(&nbsp;)</div><div id="ww3_12_3_13_14_3_18_6_6" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>hasAttributes(&nbsp;)</div><div id="ww3_12_3_13_14_3_18_6_8" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>hasAggregators(&nbsp;)</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright © <span>2010</span><span>-2015</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/ehcache_online.png" alt="Product Logo"><!--	     <a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank" >Contact&#160;Support</a> --><!--         &#160;&#160;|&#160;&#160;  --><!--         <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank" >Community</a>  --><!--         &#160;&#160;  -->
          |&nbsp;&nbsp;
        <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>