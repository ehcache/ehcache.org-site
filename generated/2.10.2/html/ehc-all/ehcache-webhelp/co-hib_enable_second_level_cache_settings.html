<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Enabling Second-Level Cache and Query Cache Settings</title><link rel="Prev" href="co-hib_configure_as_second_level_cache_provider.html" title="Previous"><link rel="Next" href="co-hib_configuring_entities_to_use_second_level_caching.html" title="Next"><link rel="StyleSheet" href="css/_ehcache_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/_ehcache_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/ehcache-webhelp/co-hib_enable_second_level_cache_settings.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pFb9NHQN4Vsb52D6rSvKTQw" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/ehcache-webhelp/co-hib_enable_second_level_cache_settings.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../ehcache-webhelp/_ehcache_all.1.187.html#wwconnect_header">Related Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../ehcache-webhelp/to-title_ehcache_integrations.html#wwconnect_header">Integrations</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../ehcache-webhelp/to-hib_using_ehcache_with_hibernate.html#wwconnect_header">Using Ehcache with Hibernate</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Enabling Second-Level Cache and Query Cache Settings</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_15_7_7_13_1" class="Heading_3">Enabling Second-Level Cache and Query Cache Settings</div><div id="ww3_15_7_7_13_2_2" class="Body">In addition to configuring the second-level cache provider setting, you will need to turn on the second-level cache (by default it is configured to off - 'false' - by Hibernate). To do this, set the following property in your Hibernate config:</div><div id="ww3_15_7_7_13_2_4" class="Preformatted">&lt;property name="hibernate.cache.use_second_level_cache"&gt;true&lt;/property&gt;</div><div id="ww3_15_7_7_13_2_6" class="Body">You might also want to turn on the Hibernate query cache. To do this, set the following property in your Hibernate config:</div><div id="ww3_15_7_7_13_2_8" class="Preformatted">&lt;property name="hibernate.cache.use_query_cache"&gt;true&lt;/property&gt;</div><div id="ww3_15_7_7_13_2_10_2" class="Section_Title">Setting the ConfigurationResourceName Property</div><div id="ww3_15_7_7_13_2_10_4" class="Body">You can optionally set the <span class="parmname">ConfigurationResourceName</span> property to specify the location of the Ehcache configuration file to use with the given Hibernate instance and cache provider/region-factory. The resource is searched for in the root of the classpath. It is used to support multiple CacheManagers in the same VM. It tells Hibernate which configuration to use. An example might be "ehcache-2.xml."</div><div id="ww3_15_7_7_13_2_10_6" class="Body">When using multiple Hibernate instances, it is recommended to use multiple non-singleton providers or region factories, each with a dedicated Ehcache configuration resource.</div><div id="ww3_15_7_7_13_2_10_8" class="Preformatted">net.sf.ehcache.configurationResourceName=/<span class="varname">name_of_ehcache</span>.xml</div><div id="ww3_15_7_7_13_2_12_2" class="Section_Title">Setting the Hibernate Cache Provider Programmatically</div><div id="ww3_15_7_7_13_2_12_4" class="Body">You can optionally specify the provider programmatically in Hibernate by adding necessary Hibernate property settings to the configuration before creating the SessionFactory:</div><div id="ww3_15_7_7_13_2_12_6" class="Preformatted">Configuration.setProperty("hibernate.cache.region.factory_class", <br>                     "net.sf.ehcache.hibernate.EhCacheRegionFactory")</div><div id="ww3_15_7_7_13_2_12_8" class="Body">For Hibernate 4, use <span class="codeph">org.hibernate.cache.ehcache.EhCacheRegionFactory</span> instead of <span class="codeph">net.sf.ehcache.hibernate.EhCacheRegionFactory</span>.</div><div id="ww3_15_7_7_13_2_14_2" class="Section_Title">Putting it all Together</div><div id="ww3_15_7_7_13_2_14_4" class="Body">If you are enabling both second-level caching and query caching, then your Hibernate config file should contain the following:</div><div id="ww3_15_7_7_13_2_14_6" class="Preformatted">&lt;property name="hibernate.cache.use_second_level_cache"&gt;true&lt;/property&gt; <br>&lt;property name="hibernate.cache.use_query_cache"&gt;true&lt;/property&gt; <br>&lt;property name="hibernate.cache.region.factory_class"&gt; <br>     net.sf.ehcache.hibernate.EhCacheRegionFactory&lt;/property&gt;</div><div id="ww3_15_7_7_13_2_14_8" class="Body">An equivalent Spring configuration file would contain:</div><div id="ww3_15_7_7_13_2_14_10" class="Preformatted">&lt;prop key="hibernate.cache.use_second_level_cache"&gt;true&lt;/prop&gt; <br>&lt;prop key="hibernate.cache.use_query_cache"&gt;true&lt;/prop&gt; <br>&lt;prop key="hibernate.cache.region.factory_class"&gt; <br>     net.sf.ehcache.hibernate.EhCacheRegionFactory&lt;/prop&gt;</div><div id="ww3_15_7_7_13_2_14_12" class="Body">For Hibernate 4, use <span class="codeph">org.hibernate.cache.ehcache.EhCacheRegionFactory</span> instead of <span class="codeph">net.sf.ehcache.hibernate.EhCacheRegionFactory</span> in both samples given above.</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright Â© <span>2010</span><span>-2016</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/ehcache_online.png" alt="Product Logo"><!--	     <a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank" >Contact&#160;Support</a> --><!--         &#160;&#160;|&#160;&#160;  --><!--         <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank" >Community</a>  --><!--         &#160;&#160;  -->
          |&nbsp;&nbsp;
        <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>