<!DOCTYPE html >
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <meta http-equiv="Content-Style-Type" content="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <base target="connect_page">
    <title>Ehcache</title>
    <script type="text/javascript"><!--
// Copyright (c) 2010-2014 Quadralay Corporation.  All rights reserved.
//
// ePublisher 2014.1
//
// Validated with JSLint <http://www.jslint.com/>
//

/*jslint maxerr: 50, indent: 4 */
/*global window */
/*global DocumentTouch */


// Message
//

var Message = {};

Message.Determine_Origin = function (param_window) {
    'use strict';

    var result, start_prefix_minimum, start_index, end_index;

    if (param_window.location.protocol === 'file:') {
        result = '*';
    } else {
        // Ensure start index starts after protocol and host info
        //
        start_prefix_minimum = param_window.location.protocol + '//' + param_window.location.host;
        start_index = start_prefix_minimum.length;
        end_index = param_window.location.href.indexOf(param_window.location.pathname, start_index);
        result = param_window.location.href.substring(0, end_index);
    }

    return result;
};

Message.Listen = function (param_window, param_function) {
    'use strict';

    var origin, middleware;

    // Use appropriate browser method
    //
    if ((param_window.postMessage !== undefined) && (param_window.JSON !== undefined)) {
        // Wrap function to ensure security
        //
        origin = Message.Determine_Origin(param_window);
        middleware = function (param_event) {
            var accept, event, key;

            // Ensure origin matches
            //
            accept = (param_event.origin === origin);
            if (!accept) {
                if (param_window.location.protocol === 'file:') {
                    accept = (param_event.origin.indexOf('file:') === 0);
                    if (!accept) {
                        accept = (param_event.origin === 'null');
                    }
                }
            }

            // Invoke function if message acceptable
            //
            if (accept) {
                // Copy existing event
                //
                event = {};
                for (key in param_event) {
                    if (param_event[key] !== undefined) {
                        event[key] = param_event[key];
                    }
                }

                // Expand JSON data
                //
                try {
                    event.data = param_window.JSON.parse(param_event.data);
                    param_function(event);
                } catch (ignore) {
                    // Apparently, this message wasn't meant for us
                    //
                }
            }
        };

        if (param_window.addEventListener !== undefined) {
            // Via postMessage
            //
            param_window.addEventListener('message', middleware, false);
        } else if (param_window.attachEvent !== undefined) {
            // Via postMessage
            //
            param_window.attachEvent('onmessage', middleware, false);
        }
    } else {
        // Direct send
        //
        if (!param_window.POSTMESSAGE_message) {
            param_window.POSTMESSAGE_message = param_function;
        }
    }
};

Message.Post = function (param_to_window, param_data, param_from_window) {
    'use strict';

    var data, origin, event;

    // Use appropriate browser method
    //
    if ((param_from_window.postMessage !== undefined) && (param_from_window.JSON !== undefined)) {
        // Via postMessage
        //
        data = param_from_window.JSON.stringify(param_data);
        origin = Message.Determine_Origin(param_from_window);
        param_to_window.postMessage(data, origin);
    } else {
        // Direct send
        //
        if (param_to_window.POSTMESSAGE_message) {
            event = { 'origin': origin, 'source': param_from_window, 'data': param_data };
            param_from_window.setTimeout(function () {
                param_to_window.POSTMESSAGE_message(event);
            }, 1);
        }
    }
};


// ExecuteWithDelay
//

function ExecuteWithDelay(param_window, param_callback, param_delay) {
    'use strict';

    var this_executewithdelay;

    this_executewithdelay = this;

    this.timeout = null;
    this.Execute = function () {
        // Pending invocation?
        //
        if (this_executewithdelay.timeout !== null) {
            // Reset timer and prepare to start over
            //
            param_window.clearTimeout(this_executewithdelay.timeout);
        }

        // Start timer
        //
        this_executewithdelay.timeout = param_window.setTimeout(this_executewithdelay.Invoke, param_delay);
    };
    this.Invoke = function () {
        try {
            // Clear timeout tracker and invoke callback
            //
            this_executewithdelay.timeout = null;
            param_callback();
        } catch (ignore) {
            // Ignore callback exceptions
            //
        }
    };
}


// Tracker
//

function Tracker(param_window, param_element, param_callback) {
    'use strict';

    var this_tracker;

    this.element = param_element;
    this.snapshot = param_element.innerHTML;
    this.snapshot_growing = false;

    this_tracker = this;
    this.Execute = function () {
        var snapshot;

        try {
            // Snapshot changed?
            //
            snapshot = this_tracker.element.innerHTML;
            if (snapshot !== this_tracker.snapshot) {
                this_tracker.snapshot = snapshot;
                this_tracker.snapshot_growing = true;
            } else {
                // Previously growing?
                //
                if (this_tracker.snapshot_growing) {
                    this_tracker.snapshot_growing = false;

                    // Invoke callback
                    //
                    try {
                        param_callback();
                    } catch (ignore) {
                        // Ignore callback exceptions
                        //
                    }
                }
            }

            // Continue
            //
            param_window.setTimeout(function () { this_tracker.Execute(); }, 200);
        } catch (ignore) {
            // Element must no longer be valid
            //
        }
    };
}


// Browser
//

var Browser = {};

Browser.ScrollingSupported = function () {
    'use strict';

    var result, safari_match, mobile_match, version_match;

    // Initialize return value
    //
    result = true;

    // Older mobile browsers, such as Safari under iOS 5 and earlier
    // do not support scrolling of nested overflowed divs or iframes
    //
    // Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_3 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10B329 Safari/8536.25
    //
    safari_match = window.navigator.userAgent.match(/ Safari\//);
    mobile_match = window.navigator.userAgent.match(/ Mobile\//);
    version_match = window.navigator.userAgent.match(/ Version\/(\d+)\.(\d+) /);
    if ((safari_match !== null) && (mobile_match !== null) && (version_match !== null) && (parseInt(version_match[1], 10) < 6)) {
        result = false;
    }

    return result;
};

Browser.GetAJAX = function (param_window) {
    'use strict';

    var result;

    try {
        // Firefox, Opera, Safari, Chrome
        //
        result = new param_window.XMLHttpRequest();
    } catch (e1) {
        // IE
        //
        try {
            result = new param_window.ActiveXObject('Msxml2.XMLHTTP');
        } catch (e2) {
            result = new param_window.ActiveXObject('Microsoft.XMLHTTP');
        }
    }

    return result;
};

Browser.ContainsClass = function (param_className, param_class) {
    'use strict';

    var result, index;

    result = false;

    if ((param_className !== undefined) && (param_className.length > 0) && (param_class.length > 0)) {
        // Exact match?
        //
        if (param_class === param_className) {
            result = true;
        } else {
            // Contains?
            //
            index = param_className.indexOf(param_class);
            if (index >= 0) {
                if (index === 0) {
                    result = (param_className.charAt(param_class.length) === ' ');
                } else if (index === (param_className.length - param_class.length)) {
                    result = (param_className.charAt(index - 1) === ' ');
                } else {
                    result = ((param_className.charAt(index - 1) === ' ') && (param_className.charAt(index + param_class.length) === ' '));
                }
            }
        }
    }

    return result;
};

Browser.AddClass = function (param_className, param_class) {
    'use strict';

    var result;

    result = param_className;
    if (!Browser.ContainsClass(param_className, param_class)) {
        result = param_className + ' ' + param_class;
    }

    return result;
};

Browser.RemoveClass = function (param_className, param_class) {
    'use strict';

    var result, index;

    result = param_className;
    if ((param_className !== undefined) && (param_className.length > 0) && (param_class.length > 0)) {
        // Exact match?
        //
        if (param_class === param_className) {
            result = '';
        } else {
            // Contains?
            //
            index = param_className.indexOf(param_class);
            if (index >= 0) {
                if (index === 0) {
                    if (param_className.charAt(param_class.length) === ' ') {
                        result = param_className.substring(param_class.length + 1);
                    }
                } else if (index === (param_className.length - param_class.length)) {
                    if (param_className.charAt(index - 1) === ' ') {
                        result = param_className.substring(0, index - 1);
                    }
                } else {
                    if ((param_className.charAt(index - 1) === ' ') && (param_className.charAt(index + param_class.length) === ' ')) {
                        result = param_className.substring(0, index - 1) + param_className.substring(index + param_class.length);
                    }
                }
            }
        }
    }

    return result;
};

Browser.ReplaceClass = function (param_className, param_existing_class, param_new_class) {
    'use strict';

    var result;

    result = Browser.RemoveClass(param_className, param_existing_class);
    result = Browser.AddClass(result, param_new_class);

    return result;
};

Browser.SameDocument = function (param_url_1, param_url_2) {
    'use strict';

    var result, current_path, desired_path;

    result = false;

    if (param_url_1 === param_url_2) {
        // Quick and dirty check
        //
        result = true;
    } else {
        // Try more in-depth test
        //
        current_path = param_url_1;
        desired_path = param_url_2;

        // Decompose hrefs
        //
        if (current_path.indexOf('#') !== -1) {
            current_path = current_path.substring(0, current_path.indexOf('#'));
        }
        if (desired_path.indexOf('#') !== -1) {
            desired_path = desired_path.substring(0, desired_path.indexOf('#'));
        }

        // Same document?
        //
        if ((desired_path === current_path) || (decodeURIComponent(desired_path) === current_path) || (desired_path === decodeURIComponent(current_path)) || (decodeURIComponent(desired_path) === decodeURIComponent(current_path))) {
            result = true;
        }
    }

    return result;
};

Browser.SameHierarchy = function (param_base_url, param_test_url) {
    'use strict';

    var result, decoded_base_url, decoded_test_url;

    result = false;

    if (param_test_url.indexOf(param_base_url) === 0) {
        result = true;
    } else {
        decoded_base_url = decodeURIComponent(param_base_url);

        if (param_test_url.indexOf(decoded_base_url) === 0) {
            result = true;
        } else {
            decoded_test_url = decodeURIComponent(param_test_url);

            if (decoded_test_url.indexOf(param_base_url) === 0) {
                result = true;
            } else {
                if (decoded_test_url.indexOf(decoded_base_url) === 0) {
                    result = true;
                }
            }
        }
    }

    return result;
};

Browser.RelativePath = function (param_base_url, param_test_url) {
    'use strict';

    var result, decoded_base_url, decoded_test_url;

    result = '';

    if (param_test_url.indexOf(param_base_url) === 0) {
        result = param_test_url.substring(param_base_url.length);
    } else {
        decoded_base_url = decodeURIComponent(param_base_url);

        if (param_test_url.indexOf(decoded_base_url) === 0) {
            result = param_test_url.substring(decoded_base_url.length);
        } else {
            decoded_test_url = decodeURIComponent(param_test_url);

            if (decoded_test_url.indexOf(param_base_url) === 0) {
                result = decoded_test_url.substring(param_base_url.length);
            } else {
                if (decoded_test_url.indexOf(decoded_base_url) === 0) {
                    result = decoded_test_url.substring(decoded_base_url.length);
                }
            }
        }
    }

    return result;
};

Browser.ResolveURL = function (param_reference_page_url, param_url) {
    'use strict';

    var result, url_parts, resolved_url_parts, url_component;

    // Absolute URL?
    //
    if (param_url.indexOf('//') >= 0) {
        // Absolute URL
        //
        result = param_url;
    } else {
        // Relative URL
        //

        // Expand URL into components
        //
        if (param_url.indexOf('/') >= 0) {
            url_parts = param_url.split('/');
        } else {
            url_parts = [ param_url ];
        }
        resolved_url_parts = param_reference_page_url.split('/');
        resolved_url_parts.length = resolved_url_parts.length - 1;

        // Process URL components
        //
        while (url_parts.length > 0) {
            url_component = url_parts.shift();

            if ((url_component !== '') && (url_component !== '.')) {
                if (url_component === '..') {
                    resolved_url_parts.pop();
                } else {
                    resolved_url_parts.push(url_component);
                }
            }
        }

        // Build resolved URL
        //
        result = resolved_url_parts.join('/');
    }

    return result;
};

Browser.GetDocument = function (param_iframe_or_window) {
    'use strict';

    var result;

    try {
        // <iframe>?
        //
        result = param_iframe_or_window.contentWindow || param_iframe_or_window.contentDocument;
        if (result.document) {
            result = result.document;
        }
    } catch (e) {
        try {
            // window?
            //
            result = param_iframe_or_window.document;
        } catch (ignore) {
            // Give up!
            //
        }
    }

    try {
        if (result.location.href === undefined) {
            result = undefined;
        } else if (result.body === undefined) {
            result = undefined;
        }
    } catch (e3) {
        result = undefined;
    }

    return result;
};

Browser.GetBrowserWidthHeight = function (param_window) {
    'use strict';

    var result;

    result = { width: 0, height: 0 };

    // Determine browser width/height
    //
    if ((param_window.document.documentElement !== undefined) && (param_window.document.documentElement.clientWidth !== 0)) {
        result.width = param_window.document.documentElement.clientWidth;
        result.height = param_window.document.documentElement.clientHeight;
    } else {
        result.width = param_window.document.body.clientWidth;
        result.height = param_window.document.body.clientHeight;
    }

    return result;
};

Browser.GetElementWidthHeight = function (param_element) {
    'use strict';

    var result;

    result = { width: 0, height: 0 };

    // Determine content width/height
    //
    if ((param_element.scrollWidth !== undefined) && (param_element.scrollHeight !== undefined)) {
        result.width = param_element.scrollWidth;
        result.height = param_element.scrollHeight;
        if ((param_element.offsetWidth !== undefined) && (param_element.offsetHeight !== undefined)) {
            if (param_element.offsetWidth > param_element.scrollWidth) {
                result.width = param_element.offsetWidth;
            }
            if (param_element.offsetHeight > param_element.scrollHeight) {
                result.height = param_element.offsetHeight;
            }
        }
    }

    return result;
};

Browser.GetElementScrollPosition = function (param_element, param_stop_at_element) {
    'use strict';

    var result, scroll_left, scroll_top, current_element;

    scroll_left = 0;
    scroll_top = 0;
    current_element = param_element;
    while ((current_element !== null) && (current_element !== param_stop_at_element)) {
        scroll_left += current_element.offsetLeft;
        scroll_top += current_element.offsetTop;

        current_element = current_element.offsetParent;
    }

    result = { 'left': scroll_left, 'top': scroll_top };

    return result;
};

Browser.GetWindowContentWidthHeight = function (param_window) {
    'use strict';

    var result, window_document, element;

    result = { width: 0, height: 0 };

    // Determine iframe width/height
    //
    window_document = Browser.GetDocument(param_window);
    if (window_document !== undefined) {
        // Default width/height info
        //
        element = window_document.body;
        result.width = element.offsetWidth;
        result.height = element.offsetHeight;

        if ((window_document.documentElement !== undefined) && (window_document.documentElement.offsetWidth !== 0)) {
            // Improve upon existing width/height info
            //
            if (window.navigator.userAgent.indexOf('MSIE') === -1) {
                element = window_document.documentElement;
                if (element.offsetWidth > result.width) {
                    result.width = element.offsetWidth;
                }
                if (element.offsetHeight > result.height) {
                    result.height = element.offsetHeight;
                }
            }
        }
    }

    return result;
};

Browser.GetIFrameContentWidthHeight = function (param_iframe) {
    'use strict';

    var result;

    // Determine iframe width/height
    //
    result = Browser.GetWindowContentWidthHeight(param_iframe);

    return result;
};

Browser.FindParentWithTagName = function (param_element, param_tag_name) {
    'use strict';

    var result, parent_element;

    result = null;

    try {
        parent_element = param_element.parentNode;
        while ((result === null) && (parent_element !== undefined) && (parent_element !== null)) {
            // Found target element?
            //
            if (parent_element.nodeName.toLowerCase() === param_tag_name) {
                // Success!
                //
                result = parent_element;
            }

            // Advance
            //
            parent_element = parent_element.parentNode;
        }
    } catch (ignore) {
        // No luck!
        //
    }

    return result;
};

Browser.FirstChildElement = function (param_element) {
    'use strict';

    var result, child_node;

    result = null;

    if ((param_element.firstChild !== undefined) && (param_element.firstChild !== null)) {
        child_node = param_element.firstChild;
        while ((child_node !== null)) {
            if (child_node.nodeType === 1) {
                result = child_node;
                child_node = null;
            } else {
                child_node = Browser.NextSiblingElement(child_node);
            }
        }
    }

    return result;
};

Browser.FirstChildElementWithTagName = function (param_element, param_tag_name) {
    'use strict';

    var result, child_node;

    result = null;

    if ((param_element.firstChild !== undefined) && (param_element.firstChild !== null)) {
        child_node = param_element.firstChild;
        while ((child_node !== null)) {
            if ((child_node.nodeType === 1) && (child_node.nodeName.toLowerCase() === param_tag_name)) {
                result = child_node;
                child_node = null;
            } else {
                child_node = Browser.NextSiblingElement(child_node);
            }
        }
    }

    return result;
};

Browser.PreviousSiblingElement = function (param_element) {
    'use strict';

    var result, current_element;

    result = null;

    current_element = param_element;
    while ((current_element.previousSibling !== undefined) && (current_element.previousSibling !== null)) {
        if (current_element.previousSibling.nodeType === 1) {
            result = current_element.previousSibling;
            break;
        }

        current_element = current_element.previousSibling;
    }

    return result;
};

Browser.NextSiblingElement = function (param_element) {
    'use strict';

    var result, current_element;

    result = null;

    current_element = param_element;
    while ((current_element.nextSibling !== undefined) && (current_element.nextSibling !== null)) {
        if (current_element.nextSibling.nodeType === 1) {
            result = current_element.nextSibling;
            break;
        }

        current_element = current_element.nextSibling;
    }

    return result;
};

Browser.PreviousSiblingElementWithTagName = function (param_element, param_tag_name) {
    'use strict';

    var result;

    result = Browser.PreviousSiblingElement(param_element);
    while ((result !== null) && (result.nodeName.toLowerCase() !== param_tag_name)) {
        result = Browser.PreviousSiblingElement(result);
    }

    return result;
};

Browser.NextSiblingElementWithTagName = function (param_element, param_tag_name) {
    'use strict';

    var result;

    result = Browser.NextSiblingElement(param_element);
    while ((result !== null) && (result.nodeName.toLowerCase() !== param_tag_name)) {
        result = Browser.NextSiblingElement(result);
    }

    return result;
};

Browser.GetAttribute = function (param_element, param_attribute_name) {
    'use strict';

    var result;

    result = null;

    // Notes on browser compatibility
    // http://help.dottoro.com/ljhutuuj.php
    //
    if (param_element.getAttribute !== undefined) {
        result = param_element.getAttribute(param_attribute_name);
    } else if (param_element.getPropertyValue !== undefined) {
        result = param_element.getPropertyValue(param_attribute_name);
    } else {
        if ((param_element[param_attribute_name] !== undefined) && (param_element[param_attribute_name] !== null)) {
            result = param_element[param_attribute_name];
        }
    }

    return result;
};

Browser.SetAttribute = function (param_element, param_attribute_name, param_value) {
    'use strict';

    // Notes on browser compatibility
    // http://help.dottoro.com/ljhutuuj.php
    //
    if (param_element.setAttribute !== undefined) {
        param_element.setAttribute(param_attribute_name, param_value);
    } else if (param_element.setProperty !== undefined) {
        param_element.setProperty(param_attribute_name, param_value);
    } else {
        param_element[param_attribute_name] = param_value;
    }
};

Browser.RemoveAttribute = function (param_element, param_attribute_name, param_empty_value) {
    'use strict';

    var attribute_value;

    // Attribute exists?
    //
    attribute_value = Browser.GetAttribute(param_element, param_attribute_name);
    if ((attribute_value !== null) && (attribute_value !== param_empty_value)) {
        // Notes on browser compatibility
        // http://help.dottoro.com/ljhutuuj.php
        //
        if (param_element.removeAttribute !== undefined) {
            param_element.removeAttribute(param_attribute_name);
        } else if (param_element.removeProperty !== undefined) {
            param_element.removeProperty(param_attribute_name);
        } else {
            param_element[param_attribute_name] = param_empty_value;
        }
    }
};

Browser.GetLinkRelHREF = function (param_document, param_rel) {
    'use strict';

    var result, link_elements, index, link_element;

    result = '';

    link_elements = param_document.getElementsByTagName('link');
    for (index = 0; index < link_elements.length; index += 1) {
        link_element = link_elements[index];
        if (link_element.rel === param_rel) {
            // HREF defined?
            //
            if (link_element.href !== undefined) {
                result = link_element.href;
            }
            break;
        }
    }

    return result;
};

Browser.ApplyToChildElementsWithTagName = function (param_element, param_tag_name, param_process) {
    'use strict';

    var elements, index, element;

    elements = param_element.getElementsByTagName(param_tag_name);
    for (index = 0; index < elements.length; index += 1) {
        element = elements[index];

        param_process(element);
    }
};

Browser.TrackSubtreeChanges = function (param_window, param_element, param_callback) {
    'use strict';

    var tracker, executewithdelay;

    // Address IE short-comings
    //
    if (param_window.navigator.userAgent.indexOf('MSIE') !== -1) {
        // Periodically track changes
        //
        tracker = new Tracker(param_window, param_element, param_callback);
        param_window.setTimeout(tracker.Execute, 1);
    } else {
        executewithdelay = new ExecuteWithDelay(param_window, param_callback, 100);
        if (param_element.addEventListener !== undefined) {
            param_element.addEventListener('DOMSubtreeModified', executewithdelay.Execute, false);
        } else if (param_element.attachEvent !== undefined) {
            param_element.attachEvent('DOMSubtreeModified', executewithdelay.Execute);
        }
    }
};

Browser.TrackDocumentChanges = function (param_window, param_document, param_callback) {
    'use strict';

    Browser.TrackSubtreeChanges(param_window, param_document.body, param_callback);
};

Browser.ApplyToTree = function (param_element, param_recursion_filter, param_processing_filter, param_action) {
    'use strict';

    var index, child_node, queue;

    queue = [];
    for (index = 0; index < param_element.childNodes.length; index += 1) {
        child_node = param_element.childNodes[index];

        // Depth first processing
        //
        if (param_recursion_filter(child_node)) {
            // Recurse!
            //
            Browser.ApplyToTree(child_node, param_recursion_filter, param_processing_filter, param_action);
        }

        // Process?
        //
        if (param_processing_filter(child_node)) {
            // Add to queue
            //
            queue.push(child_node);
        }
    }

    // Process queue
    //
    for (index = 0; index < queue.length; index += 1) {
        child_node = queue[index];
        param_action(child_node);
    }
};

Browser.TouchEnabled = function (param_window) {
    'use strict';

    var result;

    result = (param_window.ontouchstart !== undefined);
    if (!result) {
        try {
            result = ((param_window.DocumentTouch !== undefined) && (param_window.document instanceof DocumentTouch));
        } catch (ignore) {
            // Not fatal!
            //
        }
    }

    return result;
};

Browser.DisableCSSHoverSelectors = function (param_window) {
    'use strict';

    var css_style_rule_type, hover_expression, stylesheet_index, stylesheet, css_rules_index, css_rules, css_rule, parts, filtered_parts, parts_index, part;

    try {
        // Determine style rule type
        //
        css_style_rule_type = param_window.CSSRule.STYLE_RULE;

        // Define hover expression
        //
        hover_expression = /:hover/;

        // Iterate stylesheets
        //
        for (stylesheet_index = 0; stylesheet_index < param_window.document.styleSheets.length; stylesheet_index += 1) {
            stylesheet = param_window.document.styleSheets[stylesheet_index];

            // Iterate rules
            //
            css_rules = stylesheet.cssRules;
            if (css_rules === undefined) {
                css_rules = stylesheet.rules;
            }
            for (css_rules_index = css_rules.length - 1; css_rules_index >= 0; css_rules_index -= 1) {
                css_rule = css_rules[css_rules_index];

                // Check rule type
                //
                if (css_rule.type === css_style_rule_type) {
                    // Expand compound selectors
                    //
                    if (css_rule.selectorText.indexOf(',') !== -1) {
                        parts = css_rule.selectorText.split(',');
                    } else {
                        parts = [ css_rule.selectorText ];
                    }

                    // Filter individual selectors
                    //
                    filtered_parts = [];
                    for (parts_index = 0; parts_index < parts.length; parts_index += 1) {
                        part = parts[parts_index];

                        if (!hover_expression.test(part)) {
                            filtered_parts.push(part);
                        }
                    }

                    // Update rule selectors or delete
                    //
                    if (filtered_parts.length > 0) {
                        css_rule.selectorText = filtered_parts.join(',');
                    } else {
                        stylesheet.deleteRule(css_rules_index);
                    }
                }
            }
        }
    } catch (ignore) {
        // Not fatal
        //
    }
};


// Highlights
//

var Highlight = {};

Highlight.MatchExpression = function (param_expression, param_string) {
    'use strict';

    var result, working_regexp, working_string, offset, match;

    result = [];

    // Find matches within the string in order
    //
    working_regexp = new RegExp('\\s' + param_expression + '\\s', 'i');
    working_string = ' ' + param_string + ' ';
    offset = 0;
    match = working_regexp.exec(working_string);
    while (match !== null) {
        // Record location of this match
        //
        result.push([offset + match.index, match[0].length - 2]);

        // Advance
        //
        offset += match.index + match[0].length - 1;
        working_regexp.lastIndex = 0;
        if (offset < working_string.length) {
            match = working_regexp.exec(working_string.substring(offset));
        } else {
            match = null;
        }
    }

    return result;
};

Highlight.MatchExpressions = function (param_expressions, param_string) {
    'use strict';

    var result, match_locations, expression, index, alpha_locations, beta_locations, gamma_locations, start_index, alpha_location, beta_location, gamma_location;

    // Find all match locations
    //
    match_locations = [];
    for (index = 0; index < param_expressions.length; index += 1) {
        expression = param_expressions[index];

        match_locations[index] = Highlight.MatchExpression(expression, param_string);
    }

    // Combine match locations
    //
    while (match_locations.length > 1) {
        alpha_locations = match_locations.pop();
        beta_locations = match_locations.pop();

        gamma_locations = [];
        start_index = -1;
        alpha_location = undefined;
        beta_location = undefined;
        while ((alpha_locations.length > 0) || (beta_locations.length > 0) || (alpha_location !== undefined) || (beta_location !== undefined)) {
            // Locate next location pair
            //
            while ((alpha_location === undefined) && (alpha_locations.length > 0)) {
                alpha_location = alpha_locations.shift();
                if (alpha_location[0] < start_index) {
                    alpha_location = undefined;
                }
            }
            while ((beta_location === undefined) && (beta_locations.length > 0)) {
                beta_location = beta_locations.shift();
                if (beta_location[0] < start_index) {
                    beta_location = undefined;
                }
            }

            // Pick a location
            //
            gamma_location = undefined;
            if ((alpha_location !== undefined) && (beta_location !== undefined)) {
                // Check start index
                //
                if (alpha_location[0] < beta_location[0]) {
                    // Use alpha
                    //
                    gamma_location = alpha_location;
                    alpha_location = undefined;
                } else if (alpha_location[0] > beta_location[0]) {
                    // Use beta
                    //
                    gamma_location = beta_location;
                    beta_location = undefined;
                } else {
                    // Check lengths (longer match wins)
                    //
                    if (alpha_location[1] > beta_location[1]) {
                        // Use alpha
                        //
                        gamma_location = alpha_location;
                        alpha_location = undefined;
                    } else if (alpha_location[1] < beta_location[1]) {
                        // Use beta
                        //
                        gamma_location = beta_location;
                        beta_location = undefined;
                    } else {
                        // Same location
                        //
                        gamma_location = alpha_location;
                        alpha_location = undefined;
                        beta_location = undefined;
                    }
                }
            } else {
                // Use the one that exists
                //
                if (alpha_location !== undefined) {
                    // Use alpha
                    //
                    gamma_location = alpha_location;
                    alpha_location = undefined;
                } else {
                    // Use beta
                    //
                    gamma_location = beta_location;
                    beta_location = undefined;
                }
            }

            // Track selected location
            //
            if (gamma_location !== undefined) {
                gamma_locations.push(gamma_location);
                start_index = gamma_location[0] + gamma_location[1];
            }
        }

        match_locations.push(gamma_locations);
    }

    result = match_locations[0];

    return result;
};

Highlight.TreeRecusionFilter = function (param_node) {
    'use strict';

    var result = false;

    // Recurse on content elements
    //
    if ((param_node.nodeType === 1) && (param_node.nodeName.toLowerCase() !== 'header') && (param_node.nodeName.toLowerCase() !== 'footer')) {
        result = true;
    }

    return result;
};

Highlight.TreeProcessTextNodesFilter = function (param_node) {
    'use strict';

    var result = false;

    // Keep text nodes
    //
    if (param_node.nodeType === 3) {
        result = true;
    }

    return result;
};

Highlight.TreeProcessHighlightSpansFilter = function (param_css_class, param_node) {
    'use strict';

    var result = false;

    // Find highlight spans
    //
    if ((param_node.nodeType === 1) && (param_node.nodeName.toLowerCase() === 'span') && (param_node.className === param_css_class)) {
        result = true;
    }

    return result;
};

Highlight.Apply = function (param_document, param_css_class, param_expressions, param_node) {
    'use strict';

    var locations, result, location, highlight_node, span_element;

    locations = Highlight.MatchExpressions(param_expressions, param_node.nodeValue);
    result = (locations.length > 0);
    while (locations.length > 0) {
        location = locations.pop();

        if ((location[0] + location[1]) < param_node.nodeValue.length) {
            param_node.splitText(location[0] + location[1]);
        }
        highlight_node = param_node.splitText(location[0]);
        span_element = param_document.createElement('span');
        span_element.className = param_css_class;
        param_node.parentNode.insertBefore(span_element, highlight_node);
        span_element.appendChild(highlight_node);
    }

    return result;
};

Highlight.Remove = function (param_document, param_node) {
    'use strict';

    var parent, previous, next, text, text_node;

    // Remove highlights
    //
    parent = param_node.parentNode;
    previous = param_node.previousSibling;
    next = param_node.nextSibling;
    text = '';
    if ((previous !== null) && (previous.nodeType === 3)) {
        text += previous.nodeValue;
        parent.removeChild(previous);
    }
    if ((param_node.childNodes.length > 0) && (param_node.childNodes[0].nodeType === 3)) {
        text += param_node.childNodes[0].nodeValue;
    }
    if ((next !== null) && (next.nodeType === 3)) {
        text += next.nodeValue;
        parent.removeChild(next);
    }
    text_node = param_document.createTextNode(text);
    parent.insertBefore(text_node, param_node);
    parent.removeChild(param_node);
};

Highlight.ApplyToDocument = function (param_document, param_css_class, param_expressions, param_handle_highlight) {
    'use strict';

    Browser.ApplyToTree(param_document.body, Highlight.TreeRecusionFilter,
        Highlight.TreeProcessTextNodesFilter,
        function (param_node) {
            var applied;

            applied = Highlight.Apply(param_document, param_css_class, param_expressions, param_node);
            if ((applied) && (param_handle_highlight !== undefined)) {
                param_handle_highlight(param_node.parentNode);
            }
        });
};

Highlight.RemoveFromDocument = function (param_document, param_css_class) {
    'use strict';

    // Remove highlights
    //
    Browser.ApplyToTree(param_document.body, Highlight.TreeRecusionFilter,
        function (param_node) {
            var result;

            result = Highlight.TreeProcessHighlightSpansFilter(param_css_class, param_node);

            return result;
        },
        function (param_node) {
            Highlight.Remove(param_document, param_node);
        });
};


// File AJAX
//

var FAJAX = {};

FAJAX.Open = function (method, url, async) {
    'use strict';

    this.url = url;
};

FAJAX.Send = function (param_data) {
    'use strict';

    // Need to inject iframe via innerHTML to support IE 7
    //
    this.iframe_container = this.window.document.createElement('div');
    this.iframe_container.id = 'fajax_iframe_container';
    this.iframe_container.fajax = this;
    this.iframe_container.style.visibility = 'hidden';
    this.window.document.body.appendChild(this.iframe_container);
    this.iframe_container.innerHTML = '<iframe src="' + this.url + '" onload="FAJAX.OnLoad(window.document);"></iframe>';
};

FAJAX.OnLoad = function (param_document) {
    'use strict';

    var iframe_container;

    iframe_container = param_document.getElementById('fajax_iframe_container');
    iframe_container.fajax.HandleLoad();
};

FAJAX.HandleLoad = function () {
    'use strict';

    var iframe, iframe_document, data;

    // Access iframe's content directly
    //
    try {
        iframe = this.iframe_container.getElementsByTagName('iframe')[0];
        iframe_document = Browser.GetDocument(iframe);
        data = iframe_document.body.innerHTML;
    } catch (ignore) {
        // No luck!
        //
    }

    // Try session storage
    //
    if (data === null || data === undefined || data === '') {
        if (this.window.Storage !== undefined) {
            data = this.window.sessionStorage['WebWorks_Connect_Data'];
            delete this.window.sessionStorage['WebWorks_Connect_Data'];
        }
    }

    this.window.document.body.removeChild(this.iframe_container);

    if (data !== null && data !== undefined) {
        this.readyState = 4;
        this.status = 200;
        this.responseText = data;
        this.onreadystatechange();
    } else {
        this.readyState = 4;
        this.status = 404;
        this.responseText = '';
        this.onreadystatechange();
    }
};

FAJAX.Object = function (param_window) {
    'use strict';

    this.window = param_window;
    this.readyState = 1;
    this.status = 404;
    this.responseText = '';
    this.iframe = undefined;
    this.url = '';

    this.open = FAJAX.Open;
    this.send = FAJAX.Send;
    this.HandleLoad = FAJAX.HandleLoad;
};


// Parcels
//

var Parcels = {};

Parcels.KnownParcelURL = function (param_parcel_prefixes, param_url) {
    'use strict';

    var result, parcel_base_url;

    result = false;

    for (parcel_base_url in param_parcel_prefixes) {
        if (typeof param_parcel_prefixes[parcel_base_url] === 'boolean') {
            if (Browser.SameHierarchy(parcel_base_url, param_url)) {
                result = true;
                break;
            }
        }
    }

    return result;
};

Parcels.KnownParcelBaggageURL = function (param_parcel_prefixes, param_url) {
    'use strict';

    var result, parcel_base_url, baggage_url;

    result = false;

    for (parcel_base_url in param_parcel_prefixes) {
        if (typeof param_parcel_prefixes[parcel_base_url] === 'boolean') {
            if (Browser.SameHierarchy(parcel_base_url, param_url)) {
                baggage_url = parcel_base_url + '/baggage/';
                result = Browser.SameHierarchy(baggage_url, param_url);
                break;
            }
        }
    }

    return result;
};
// Copyright (c) 2010-2014 Quadralay Corporation.  All rights reserved.
//
// ePublisher 2014.1
//
// Validated with JSLint <http://www.jslint.com/>
//

/*jslint unparam: true, sub: true, maxerr: 50, indent: 4 */
/*global window */
/*global Browser */
/*global Message */
/*global FAJAX */
/*global Parcels */

var Connect_Window = window;
Connect_Window.name = 'connect_main';


// Progress
//

var Progress = { progress: 0 };

Progress.Reset = function () {
    'use strict';

    var current_progress, progress_segment, progress_div;

    // Reset progress
    //
    Progress.progress = 0;

    // Reset segments
    //
    current_progress = 0;
    while (current_progress < 100) {
        current_progress += 10;

        progress_segment = Connect_Window.document.getElementById('progress_' + current_progress);
        progress_segment.className = Browser.ReplaceClass(progress_segment.className, 'ww_skin_progress_segment_complete', 'ww_skin_progress_segment_pending');
    }

    // Show progress
    //
    progress_div = Connect_Window.document.getElementById('progress');
    progress_div.style.display = 'block';
};

Progress.Update = function (param_progress) {
    'use strict';

    var progress_segment;

    if (param_progress > Progress.progress) {
        if (param_progress <= 100) {
            while ((Progress.progress + 10) <= param_progress) {
                Progress.progress = Progress.progress + 10;

                progress_segment = Connect_Window.document.getElementById('progress_' + Progress.progress);
                progress_segment.className = Browser.ReplaceClass(progress_segment.className, 'ww_skin_progress_segment_pending', 'ww_skin_progress_segment_complete');
            }
        }
    }
};

Progress.Complete = function () {
    'use strict';

    var progress_div;

    progress_div = Connect_Window.document.getElementById('progress');
    progress_div.style.display = 'none';
};


// AJAXData
//

function AJAXData_Execute() {
    'use strict';

    var this_ajaxdata, entry, ajax, parallel, request_url, moment;

    this_ajaxdata = this;
    if (this_ajaxdata.entries.length > 0) {
        // Load entry
        //
        entry = this_ajaxdata.entries.shift();
        if (Connect_Window.document.location.protocol === 'file:') {
            ajax = new FAJAX.Object(Connect_Window);
            parallel = false;
        } else {
            ajax = Browser.GetAJAX(Connect_Window);
            parallel = true;
        }

        ajax.onreadystatechange = function () {
            if (ajax.readyState === 4) {
                // Entry retrieved
                //
                if (ajax.status === 200) {
                    // Success!
                    //
                    this_ajaxdata.completed_entries.push(entry);
                    this_ajaxdata.success(entry, ajax);

                    // Update progress
                    //
                    this_ajaxdata.progress((this_ajaxdata.completed_entries.length / this_ajaxdata.entries_start_length) * 100);
                } else if (ajax.status === 304) {
                    // Already trying to work around 304s?
                    //
                    if (this_ajaxdata.avoid_304_entries[entry] === true) {
                        // Keep moving forward
                        //
                        this_ajaxdata.completed_entries.push(entry);
                        this_ajaxdata.progress((this_ajaxdata.completed_entries.length / this_ajaxdata.entries_start_length) * 100);
                    } else {
                        // Retry
                        //
                        this_ajaxdata.avoid_304_entries[entry] = true;
                        this_ajaxdata.entries.push(entry);
                    }
                } else {
                    this_ajaxdata.completed_entries.push(entry);
                }

                // Load next entry
                //
                Connect_Window.setTimeout(function () { this_ajaxdata.Execute(); }, 1);
            }
        };

        // Avoid 304 (not modified) responses
        //
        request_url = this_ajaxdata.get_url(entry);
        if (this_ajaxdata.avoid_304_entries[entry] === true) {
            moment = new Date();
            request_url += '?moment=' + moment.getTime();
        }

        // Request entry
        //
        ajax.open('GET', request_url, true);
        ajax.send(null);

        // Parallel load?
        //
        if (parallel) {
            // Load next entry
            //
            Connect_Window.setTimeout(function () { this_ajaxdata.Execute(); }, 1);
        }
    } else {
        // Completed?
        //
        if ((this.completed === false) && (this_ajaxdata.completed_entries.length === this_ajaxdata.entries_start_length)) {
            // Entries loaded!
            //
            this_ajaxdata.complete();

            this.completed = true;
        }
    }
}

function AJAXData_Object(param_entries, param_get_url, param_progress, param_success, param_complete) {
    'use strict';

    this.entries = param_entries.slice(0);
    this.entries_start_length = this.entries.length;
    this.completed_entries = [];
    this.completed = false;
    this.avoid_304_entries = {};
    this.get_url = param_get_url;
    this.progress = param_progress;
    this.success = param_success;
    this.complete = param_complete;

    this.Execute = AJAXData_Execute;
}


// Panel
//

function Panel_Visible() {
    'use strict';

    var result;

    result = (Browser.ContainsClass(this.connect.presentation_div.className, 'panel_sidebar') || Browser.ContainsClass(this.connect.presentation_div.className, 'panel_overlay'));

    return result;
}

function Panel_Show() {
    'use strict';

    if (!this.Visible()) {
        // Configure panel
        //
        if (this.display_as_sidebar) {
            this.connect.presentation_div.className = Browser.AddClass(this.connect.presentation_div.className, 'panel_sidebar');
        } else {
            this.connect.presentation_div.className = Browser.AddClass(this.connect.presentation_div.className, 'panel_overlay');
        }

        // Handle layout changes
        //
        this.Resize();
    }
}

function Panel_Resize() {
    'use strict';

    this.resize();
}

function Panel_Hide(param_resize) {
    'use strict';

    if (this.Visible()) {
        // Teardown
        //
        if ((this.teardown !== undefined) && (this.teardown !== null)) {
            this.teardown(this.window, this.panel_content);
            this.teardown = undefined;
        }

        // Hide panel
        //
        if (this.display_as_sidebar) {
            this.connect.presentation_div.className = Browser.RemoveClass(this.connect.presentation_div.className, 'panel_sidebar');
        } else {
            this.connect.presentation_div.className = Browser.RemoveClass(this.connect.presentation_div.className, 'panel_overlay');
        }

        // Handle layout changes
        //
        if (param_resize === undefined) {
            this.Resize();
        } else {
            if (param_resize === true) {
                this.Resize();
            }
        }
    }
}

function Panel_Display(param_display_as_sidebar, param_setup, param_resize, param_teardown) {
    'use strict';

    var this_panel;

    // Setup
    //
    this.display_as_sidebar = (this.connect.navigation_width > 0) ? param_display_as_sidebar : false;
    param_setup(this.window, this.panel_content);

    // Configure resize and teardown
    //
    this.resize = param_resize;
    this.teardown = param_teardown;

    // Show!
    //
    this_panel = this;
    this.window.setTimeout(function () { this_panel.Show(); }, 1);
}

function Panel_Object(param_window, param_connect) {
    'use strict';

    this.window = param_window;
    this.connect = param_connect;
    this.display_as_sidebar = false;
    this.teardown = undefined;
    this.panel_frame = this.window.document.getElementById('panel_frame');
    this.panel_content = this.window.document.getElementById('panel_content');
    this.page_div = this.window.document.getElementById('page_div');
    this.page_iframe = this.window.document.getElementById('page_iframe');

    this.Visible = Panel_Visible;
    this.Show = Panel_Show;
    this.Resize = Panel_Resize;
    this.Hide = Panel_Hide;
    this.Display = Panel_Display;
}


// Lightbox
//

function Lightbox_Show() {
    'use strict';

    var browser_widthheight, lightbox_frame_widthheight, lightbox_frame_left, lightbox_frame_top;

    // Calculate position
    //
    browser_widthheight = Browser.GetBrowserWidthHeight(Connect_Window);
    lightbox_frame_widthheight = Browser.GetElementWidthHeight(this.lightbox_frame);
    lightbox_frame_left = Math.floor((browser_widthheight.width - lightbox_frame_widthheight.width) / 2);
    if (lightbox_frame_left < 0) {
        lightbox_frame_left = 0;
    }
    lightbox_frame_top = Math.floor((browser_widthheight.height - lightbox_frame_widthheight.height) / 2);
    if (lightbox_frame_top < 0) {
        lightbox_frame_top = 0;
    }

    // Set up the background
    //
    this.lightbox_background.style.display = 'block';

    // Configure the frame
    //
    this.lightbox_frame.style.left = String(lightbox_frame_left) + 'px';
    this.lightbox_frame.style.top = String(lightbox_frame_top) + 'px';
    this.lightbox_frame.style.visibility = 'visible';
}

function Lightbox_Hide() {
    'use strict';

    // Hide lightbox
    //
    this.lightbox_frame.style.visibility = 'hidden';
    this.lightbox_background.style.display = 'none';

    // Teardown
    //
    if ((this.teardown !== undefined) && (this.teardown !== null)) {
        this.teardown(this.lightbox_content);
        this.teardown = undefined;
    }
}

function Lightbox_Display(param_setup, param_teardown) {
    'use strict';

    var this_lightbox;

    // Setup
    //
    param_setup(this.lightbox_content);

    // Configure teardown
    //
    this.teardown = param_teardown;

    // Show!
    //
    this_lightbox = this;
    Connect_Window.setTimeout(function () { this_lightbox.Show(); }, 1);
}

function Lightbox_Object(param_connect) {
    'use strict';

    var this_lightbox;

    this.connect = param_connect;

    this.lightbox_background = Connect_Window.document.getElementById('lightbox_background');
    this.lightbox_frame = Connect_Window.document.getElementById('lightbox_frame');
    this.lightbox_content = Connect_Window.document.getElementById('lightbox_content');
    this.lightbox_close = Connect_Window.document.getElementById('lightbox_close');
    this.teardown = undefined;

    this_lightbox = this;
    this.page_iframe = Connect_Window.document.getElementById('page_iframe');
    this.lightbox_close.onclick = function () { this_lightbox.Hide(); };

    this.Show = Lightbox_Show;
    this.Hide = Lightbox_Hide;
    this.Display = Lightbox_Display;
}


var Connect = { loading: false, page_cargo: {} };

Connect.OnLoadAction = function () {
    'use strict';

    var url_header, base_pathname, base_url, splash_page_url, css_rules, css_rules_index, css_rule, css_rule_selector_text, parcel_anchors, index;

    url_header = Connect_Window.location.href.substring(0, Connect_Window.location.href.indexOf(Connect_Window.location.pathname));
    base_pathname = Connect_Window.location.pathname.substring(0, Connect_Window.location.pathname.lastIndexOf('/') + 1);
    base_url = url_header + base_pathname;
    splash_page_url = base_url + 'connect/splash.html';

    Connect.base_url = base_url;
    Connect.default_page_url = splash_page_url;
    Connect.splash_page_url = splash_page_url;
    Connect.search_page_url = base_url + 'connect/search.html';
    Connect.show_first_document = true;
    Connect.layout_wide = false;
    Connect.adjust_for_content_size_timeout = null;
    Connect.adjust_for_content_size_inprogress = false;
    Connect.parcels_loaded = false;
    Connect.ignore_page_load = false;
    Connect.hash = '';
    Connect.parcel_anchors = [];
    Connect.parcel_ix = [];
    Connect.parcel_sx = [];
    Connect.parcel_title = {};
    Connect.navigation_width = 300;
    Connect.navigation_minimum_page_width = 900;
    Connect.lightbox_min_pixel_margin = 48;
    Connect.disqus_id = '';
    Connect.email = '';
    Connect.email_message = 'Feedback: $Location;';
    Connect.toc_class_states = {};
    Connect.toc_selected_entry_key = undefined;
    Connect.toc_cleanup_folders = true;
    Connect.search_input = null;
    Connect.search_query = '';
    Connect.button_behavior_expression = new RegExp('ww_behavior_[a-z]+', 'g');
    Connect.buttons = {};
    Connect.button_behaviors = { 'ww_behavior_home': Connect.Button_Home,
            'ww_behavior_toc': Connect.Button_TOC,
            'ww_behavior_index': Connect.Button_Index,
            'ww_behavior_search': Connect.Button_Search,
            'ww_behavior_globe': Connect.Button_Globe,
            'ww_behavior_prev': Connect.Button_Previous,
            'ww_behavior_next': Connect.Button_Next,
            'ww_behavior_email': Connect.Button_Email,
            'ww_behavior_print': Connect.Button_Print,
            'ww_behavior_pdf': Connect.Button_PDF
        };
    Connect.button_degradation_order = ['ww_behavior_home', 'ww_behavior_globe', 'ww_behavior_index', 'ww_behavior_search', 'ww_behavior_toc'];
    Connect.globe_enabled = false;

    Connect.link_bridge = {
        last_link: null,
        Next: {},
        Prev: {},
        HREFs: { 'splash': splash_page_url },
        Track: function (param_first_link, param_last_link) {
            var firstPageID, lastPageID, lastLinkID;

            firstPageID = param_first_link.id.replace(/\:first$/, '');
            lastPageID = param_last_link.id.replace(/\:last$/, '');

            // Associate previous/next and handle no splash
            //
            if (this.last_link === null) {
                if (Connect.show_first_document) {
                    Connect.default_page_url = param_first_link.href;
                } else {
                    this.Prev[firstPageID] = 'splash';
                }
                this.Next['splash'] = firstPageID;
            } else {
                lastLinkID = this.last_link.id.replace(/\:last$/, '');
                this.Prev[firstPageID] = lastLinkID;
                this.Next[lastLinkID] = firstPageID;
            }

            // Map ids to URIs
            //
            this.HREFs[firstPageID] = param_first_link.href;
            this.HREFs[lastPageID] = param_last_link.href;

            // Remember last link loaded
            //
            this.last_link = param_last_link;
        },

        GetPrev: function (param_page_id) {
            var result;

            result = null;

            if (this.Prev[param_page_id] !== undefined) {
                result = this.HREFs[this.Prev[param_page_id]];
            }

            return result;
        },

        GetNext: function (param_page_id) {
            var result;

            result = null;

            if (this.Next[param_page_id] !== undefined) {
                result = this.HREFs[this.Next[param_page_id]];
            }

            return result;
        },

        Get: function (param_type, param_page_id) {
            var result, type_as_lowercase;

            result = null;

            type_as_lowercase = param_type.toLowerCase();
            if (type_as_lowercase === 'prev') {
                result = this.GetPrev(param_page_id);
            } else if (type_as_lowercase === 'next') {
                result = this.GetNext(param_page_id);
            }

            return result;
        }
    };

    // Layout offsets
    //
    Connect.layout_wide_offset = 0;
    Connect.layout_narrow_offset = 0;
    Connect.layout_current_offset = 0;
    Connect.layout_height_tolerance = 32;
    Connect.layout_top = 0;
    Connect.layout_top_css_rules = [];
    for (index = 0; index < Connect_Window.document.styleSheets.length; index += 1) {
        css_rules = Connect_Window.document.styleSheets[index].cssRules;
        if (css_rules === undefined) {
            css_rules = Connect_Window.document.styleSheets[index].rules;
        }
        for (css_rules_index = 0; css_rules_index < css_rules.length; css_rules_index += 1) {
            css_rule = css_rules[css_rules_index];
            css_rule_selector_text = css_rule.selectorText.toLowerCase();  // Handle IE 7,8

            if (css_rule_selector_text === '.layout_wide') {
                Connect.layout_wide_offset += parseInt(css_rule.style.paddingLeft, 10);
                Connect.layout_wide_offset += parseInt(css_rule.style.paddingRight, 10);
            } else if (css_rule_selector_text === '.layout_narrow') {
                Connect.layout_narrow_offset += parseInt(css_rule.style.paddingLeft, 10);
                Connect.layout_narrow_offset += parseInt(css_rule.style.paddingRight, 10);
            } else if (css_rule_selector_text === 'div#presentation_div') {
                Connect.presentation_div_css_rule = css_rule;
            }
        }

        if (Connect.presentation_div_css_rule !== undefined) {
            break;
        }
    }
    for (css_rules_index = 0; css_rules_index < css_rules.length; css_rules_index += 1) {
        css_rule = css_rules[css_rules_index];
        css_rule_selector_text = css_rule.selectorText.toLowerCase();  // Handle IE 7,8

        if ((css_rule_selector_text === 'div#layout_div.layout_wide div#presentation_div.panel_sidebar div#panel_frame') || (css_rule_selector_text === 'div.layout_wide#layout_div div.panel_sidebar#presentation_div div#panel_frame')) {
            // Assign width
            //
            css_rule.style.width = String(Connect.navigation_width) + 'px';
        } else if ((css_rule_selector_text === 'div#layout_div.layout_wide div#presentation_div.panel_sidebar div#page_div') || (css_rule_selector_text === 'div.layout_wide#layout_div div.panel_sidebar#presentation_div div#page_div')) {
            // Assign left
            //
            css_rule.style.left = String(Connect.navigation_width) + 'px';
        } else if (css_rule_selector_text === 'div#container_div') {
            // Update top
            //
            Connect.layout_top_css_rules.push(css_rule);
        }
    }

    // Cache <div>s
    //
    Connect.layout_div = Connect_Window.document.getElementById('layout_div');
    Connect.toolbar_div = Connect_Window.document.getElementById('toolbar_div');
    Connect.presentation_div = Connect_Window.document.getElementById('presentation_div');
    Connect.parcels_div = Connect_Window.document.getElementById('parcels');
    Connect.container_div = Connect_Window.document.getElementById('container_div');
    Connect.panel_frame_div = Connect_Window.document.getElementById('panel_frame');
    Connect.page_div = Connect_Window.document.getElementById('page_div');
    Connect.page_iframe = Connect_Window.document.getElementById('page_iframe');
    Connect.panels_div = Connect_Window.document.getElementById('panels');
    Connect.panel_progress_div = Connect_Window.document.getElementById('panel_progress');
    Connect.toc_div = Connect_Window.document.getElementById('toc');
    Connect.toc_content_div = Connect_Window.document.getElementById('toc_content');
    Connect.index_div = Connect_Window.document.getElementById('index');
    Connect.index_content_div = Connect_Window.document.getElementById('index_content');
    Connect.search_div = Connect_Window.document.getElementById('search');
    Connect.search_content_div = Connect_Window.document.getElementById('search_content');
    Connect.search_iframe = Connect_Window.document.getElementById('search_iframe');

    // Determine scrolling support
    //
    Connect.scrolling_supported = Browser.ScrollingSupported();
    if (Connect.scrolling_supported) {
        Connect_Window.document.body.className = Browser.AddClass(Connect_Window.document.body.className, 'scrolling_supported');
    }

    // Size content <div>
    //
    Connect_Window.onresize = Connect.OnResize;
    if (Connect_Window.addEventListener !== undefined) {
        Connect_Window.addEventListener('orientationchange', Connect.OnResize, false);
    }

    // Panel
    //
    Connect.Panel = new Panel_Object(Connect_Window, Connect);
    Connect.panel_changing = false;
    Connect.sidebar_behavior = undefined;
    Connect.sidebar_auto_display = (Connect.navigation_width > 0);

    // Lightbox
    //
    Connect.Lightbox = new Lightbox_Object(Connect);

    // Touch enabled?
    //
    if (Browser.TouchEnabled(Connect_Window)) {
        // Adjust CSS rules for touch devices
        //
        Browser.DisableCSSHoverSelectors(Connect_Window);
    }

    // Load parcels
    //
    Connect.parcel_anchors = [];
    Connect.parcel_context_ids = {};
    Connect.parcel_prefixes = {};
    Connect.parcel_prefixes[Connect.base_url + 'connect/'] = true;
    Connect.toc_content_div.innerHTML = Connect.parcels_div.innerHTML;
    Connect.parcels_div.innerHTML = '';
    Connect.parcels_div.style.display = 'none';
    parcel_anchors = Connect.toc_div.getElementsByTagName('a');
    if (parcel_anchors.length === 0) {
        parcel_anchors = Connect_Window.document.links;
    }
    for (index = 0; index < parcel_anchors.length; index += 1) {
        Connect.parcel_anchors[Connect.parcel_anchors.length] = parcel_anchors[index];
    }
    Connect.Parcel_Load();

    // Setup for listening
    //
    Connect.dispatch_listen = undefined;
    Message.Listen(Connect_Window, Connect.Listen);
};

Connect.OnLoad = function () {
    'use strict';

    if (!Connect.loading) {
        Connect.loading = true;
        Connect.OnLoadAction();
    }
};

// Start running as soon as possible
//
if (window.addEventListener !== undefined) {
    window.document.addEventListener('DOMContentLoaded', Connect.OnLoad, false);
}

Connect.AddParcel = function (param_parcel_context,
                              param_parcel_id,
                              param_parcel_url,
                              param_parcel_title) {
    'use strict';

    var parcel_directory_url;

    parcel_directory_url = param_parcel_url.substring(0, param_parcel_url.lastIndexOf('.'));

    // Track context
    //
    Connect.parcel_context_ids[param_parcel_context] = param_parcel_id;

    // Include original file and directory prefix
    //
    Connect.parcel_prefixes[param_parcel_url] = true;
    Connect.parcel_prefixes[parcel_directory_url] = true;
    Connect.parcel_ix.push({ 'id': param_parcel_id, 'url': parcel_directory_url + '_ix.html' });
    Connect.parcel_sx.push(parcel_directory_url + '_sx.js');
    Connect.parcel_title[param_parcel_id] = param_parcel_title;
};

Connect.KnownParcelURL = function (param_url) {
    'use strict';

    var result;

    result = Parcels.KnownParcelURL(Connect.parcel_prefixes, param_url);

    return result;
};

Connect.KnownParcelBaggageURL = function (param_url) {
    'use strict';

    var result;

    result = Parcels.KnownParcelBaggageURL(Connect.parcel_prefixes, param_url);

    return result;
};

Connect.CalculateLayoutWide = function () {
    'use strict';

    var result, browser_widthheight;

    browser_widthheight = Browser.GetBrowserWidthHeight(Connect_Window);
    result = (browser_widthheight.width >= Connect.navigation_minimum_page_width);

    return result;
};

Connect.GuessPageHeight = function () {
    'use strict';

    var browser_widthheight, page_height;

    browser_widthheight = Browser.GetBrowserWidthHeight(Connect_Window);
    page_height = browser_widthheight.height - Connect.layout_top;

    return page_height;
};

Connect.AdjustLayoutForBrowserSize = function () {
    'use strict';

    var previous_layout_wide, toolbar_buttons, left_button, right_button, index, toolbar_button;

    // Adjust navigation based on available space
    //
    previous_layout_wide = Connect.layout_wide;
    Connect.layout_wide = Connect.CalculateLayoutWide();

    // Layout changed?
    //
    if (Connect.layout_wide) {
        // Switched from narrow view?
        //
        if (!previous_layout_wide) {
            // Layout
            //
            Connect.layout_div.className = 'layout_wide';
            Connect.layout_current_offset = Connect.layout_wide_offset;
        }
    } else {
        // Switched from wide view?
        //
        if (previous_layout_wide) {
            // Layout
            //
            Connect.layout_div.className = 'layout_narrow';
            Connect.layout_current_offset = Connect.layout_narrow_offset;

            // Guess page height
            //
            Connect.page_div.style.height = String(Connect.GuessPageHeight() - Connect.layout_height_tolerance) + 'px';
        }
    }

    // Update toolbar buttons
    //
    toolbar_buttons = Connect.toolbar_div.getElementsByTagName('span');
    for (index = 0; index < toolbar_buttons.length; index += 1) {
        toolbar_button = toolbar_buttons[index];
        if ((Browser.ContainsClass(toolbar_button.className, 'ww_skin_toolbar_button_left')) || (Browser.ContainsClass(toolbar_button.className, 'ww_skin_toolbar_button_center')) || (Browser.ContainsClass(toolbar_button.className, 'ww_skin_toolbar_button_right'))) {
            if (left_button === undefined) {
                left_button = toolbar_button;
            }
            right_button = toolbar_button;
        }
    }
    if (left_button !== undefined) {
        if (Connect.layout_wide) {
            left_button.className = Browser.AddClass(left_button.className, 'ww_skin_toolbar_left_background');
        } else {
            left_button.className = Browser.RemoveClass(left_button.className, 'ww_skin_toolbar_left_background');
        }
    }
    if (right_button !== undefined) {
        if (Connect.layout_wide) {
            right_button.className = Browser.AddClass(right_button.className, 'ww_skin_toolbar_right_background');
        } else {
            right_button.className = Browser.RemoveClass(right_button.className, 'ww_skin_toolbar_right_background');
        }
    }

    // Update side panel layout
    //
    if (Connect.Panel.Visible()) {
        // Adjust layout
        //
        if (previous_layout_wide && !Connect.layout_wide && Connect.Panel.display_as_sidebar) {
            Connect.Panel.Hide();
        }
    } else {
        // Display default side panel
        //
        if (!Connect.panel_changing) {
            if ((Connect.layout_wide) && (Connect.sidebar_auto_display) && (Connect.sidebar_behavior !== undefined)) {
                Connect.button_behaviors[Connect.sidebar_behavior]();
            }
        }
    }
};

Connect.HandleToolbarButtonForBrowserSize = function (param_index, param_show) {
    'use strict';

    var done, button_behavior, toolbar_button, browser_widthheight, toolbar_table_element, toolbar_table_widthheight;

    done = false;

    // Possible button to show/hide
    //
    button_behavior = Connect.button_degradation_order[param_index];
    toolbar_button = Connect.buttons[button_behavior];
    if (toolbar_button !== undefined) {
        // Show/hide
        //
        if (param_show) {
            toolbar_button.style.display = 'inline-block';
        } else {
            toolbar_button.style.display = 'none';
        }

        // Keep change?
        //
        browser_widthheight = Browser.GetBrowserWidthHeight(Connect_Window);
        toolbar_table_element = Browser.FirstChildElementWithTagName(Connect.toolbar_div, 'table');
        toolbar_table_widthheight = Browser.GetElementWidthHeight(toolbar_table_element);
        if (param_show) {
            if (toolbar_table_widthheight.width > (browser_widthheight.width - Connect.layout_current_offset)) {
                // Revert change
                //
                toolbar_button.style.display = 'none';
                done = true;
            }
        } else {
            if (toolbar_table_widthheight.width <= (browser_widthheight.width - Connect.layout_current_offset)) {
                // Met the goal size
                //
                done = true;
            }
        }
    }

    return done;
};

Connect.AdjustToolbarForBrowserSize = function () {
    'use strict';

    var browser_widthheight, toolbar_table_element, toolbar_table_widthheight, show, index, done;

    // Show/hide non-critical toolbar buttons based on available space
    //
    browser_widthheight = Browser.GetBrowserWidthHeight(Connect_Window);
    toolbar_table_element = Browser.FirstChildElementWithTagName(Connect.toolbar_div, 'table');
    toolbar_table_widthheight = Browser.GetElementWidthHeight(toolbar_table_element);
    show = (toolbar_table_widthheight.width <= (browser_widthheight.width - Connect.layout_current_offset));
    if (show) {
        // Show buttons in reverse order
        //
        for (index = Connect.button_degradation_order.length - 1; index >= 0; index -= 1) {
            done = Connect.HandleToolbarButtonForBrowserSize(index, show);
            if (done) {
                break;
            }
        }
    } else {
        // Hide buttons in default order
        //
        for (index = 0; index < Connect.button_degradation_order.length; index += 1) {
            done = Connect.HandleToolbarButtonForBrowserSize(index, show);
            if (done) {
                break;
            }
        }
    }
};

Connect.AdjustPageScrolling = function () {
    'use strict';

    var navigation_width_offset, browser_widthheight, target_page_width, data, page_document;

    // Page visible?
    //
    if (Connect.layout_wide || (!Connect.Panel.Visible())) {
        // Parcel page?
        //
        if (Connect.page_info !== undefined) {
            // Clear fallback, if present
            //
            Connect.container_div.className = Browser.RemoveClass(Connect.container_div.className, 'unknown_page');

            // Set max width for page
            //
            navigation_width_offset = 0;
            if (Connect.layout_wide && Connect.Panel.Visible() && Connect.Panel.display_as_sidebar) {
                navigation_width_offset = Connect.navigation_width;
            }
            browser_widthheight = Browser.GetBrowserWidthHeight(Connect_Window);
            target_page_width = browser_widthheight.width - navigation_width_offset - Connect.layout_current_offset;
            data = {
                'action': 'page_set_max_width',
                'max_width': String(target_page_width) + 'px',
                'overflow': (Connect.layout_wide && Connect.scrolling_supported) ? 'visible' : 'auto'
            };
            Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);
        } else {
            if (Connect.scrolling_supported) {
                // Fallback and use scrollbars (risks wasting space on mobile devices)
                //
                Connect.page_div.style.height = '';
                Connect.container_div.className = Browser.AddClass(Connect.container_div.className, 'unknown_page');
            } else {
                // Try to update the frame directly
                //
                try {
                    // Set max width for page (minus a couple of pixels)
                    //
                    page_document = Browser.GetDocument(Connect.page_iframe);
                    page_document.body.style.maxWidth = String(target_page_width) + 'px';

                    // Set content height
                    //
                    Connect_Window.setTimeout(Connect.AdjustPageScrolling_Height, 1);
                } catch (possible) {
                    // Set to browser height and let scrollbars do their thing
                    //
                    Connect.page_div.style.height = String(Connect.GuessPageHeight()) + 'px';

                    // Notify page resize complete
                    //
                    data = {
                        'action': 'resize_complete'
                    };
                    Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);
                }
            }
        }
    }
};

Connect.AdjustPageScrolling_Height = function () {
    'use strict';

    var page_widthheight, data;

    // Set content height
    //
    page_widthheight = Browser.GetIFrameContentWidthHeight(Connect.page_iframe);
    Connect.page_div.style.height = String(page_widthheight.height + Connect.layout_height_tolerance) + 'px';

    // Notify page resize complete
    //
    data = {
        'action': 'resize_complete'
    };
    Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);
};

Connect.AdjustForContentSize = function () {
    'use strict';

    // Halt adjustment requests
    //
    if (Connect.adjust_for_content_size_timeout !== null) {
        Connect_Window.clearTimeout(Connect.adjust_for_content_size_timeout);
        Connect.adjust_for_content_size_timeout = null;
    }

    // Serialize adjustments
    //
    if (!Connect.adjust_for_content_size_inprogress) {
        Connect.adjust_for_content_size_inprogress = true;

        Connect_Window.setTimeout(function () {
            // Adjust navigation based on available space
            //
            Connect.AdjustLayoutForBrowserSize();

            Connect_Window.setTimeout(function () {
                // Adjust toolbar
                //
                Connect.AdjustToolbarForBrowserSize();

                Connect_Window.setTimeout(function () {
                    // Adjust page scrolling
                    //
                    Connect.AdjustPageScrolling();

                    Connect.adjust_for_content_size_inprogress = false;
                }, 1);
            }, 1);
        }, 1);
    }
};

Connect.OnResize = function () {
    'use strict';

    // Adjust for content size
    //
    if (Connect.adjust_for_content_size_timeout !== null) {
        Connect_Window.clearTimeout(Connect.adjust_for_content_size_timeout);
    }
    Connect.adjust_for_content_size_timeout = Connect_Window.setTimeout(Connect.AdjustForContentSize, 100);
};

Connect.Parcel_Load = function () {
    'use strict';

    var ajaxdata;

    ajaxdata = new AJAXData_Object(Connect.parcel_anchors,
        function (param_entry) {
            return param_entry.href;
        },
        function (param_percent) {
            Progress.Update(param_percent);
        },
        function (param_entry, param_ajax) {
            var parcel_div, context_and_id, parcel_context, parcel_id, parcel_toc_div_id, parcel_toc_div, toc_ul, parcel_data_div_id, parcel_data_div;

            // Access parcel
            //
            parcel_div = Connect_Window.document.createElement('div');
            parcel_div.style.visibility = 'hidden';
            parcel_div.innerHTML = param_ajax.responseText;
            Connect_Window.document.body.appendChild(parcel_div);

            // Add to collection of valid parcels
            //
            context_and_id = param_entry.id.split(':');
            parcel_context = context_and_id[0];
            parcel_id = context_and_id[1];
            Connect.AddParcel(parcel_context, parcel_id, param_entry.href, param_entry.innerHTML);

            // TOC
            //
            parcel_toc_div_id = 'toc:' + parcel_id;
            parcel_toc_div = Connect_Window.document.getElementById(parcel_toc_div_id);
            if (parcel_toc_div !== null) {
                toc_ul = Browser.FirstChildElementWithTagName(parcel_toc_div, 'ul');
                if (toc_ul !== null) {
                    // Extract TOC data
                    //
                    if (Connect.parcel_anchors.length === 1) {
                        // Suppress parcel (group) folder
                        //
                        param_entry.parentNode.parentNode.parentNode.parentNode.appendChild(toc_ul);
                    } else {
                        // Preserve parcel (group) folder
                        //
                        param_entry.parentNode.parentNode.appendChild(toc_ul);
                    }
                }
            }

            // Data
            //
            parcel_data_div_id = 'data:' + parcel_id;
            parcel_data_div = Connect_Window.document.getElementById(parcel_data_div_id);
            if (parcel_data_div !== null) {
                Connect.parcels_div.appendChild(parcel_data_div);
            }

            // Remove parcel data
            //
            Connect_Window.document.body.removeChild(parcel_div);

            // Disable parcel link
            //
            if (Connect.parcel_anchors.length === 1) {
                param_entry.parentNode.parentNode.parentNode.parentNode.removeChild(param_entry.parentNode.parentNode.parentNode);
            } else {
                Browser.RemoveAttribute(param_entry, 'href', '');
            }
        },
        function () {
            var index, parcel_anchor, parcel_context_and_id, parcel_id, first_page_div, last_page_div, first_page_a, last_page_a, buttons_to_remove, button_to_remove, ie_match, presentation_div_scroll_position, toolbar_table_element, toolbar_table_widthheight, css_rules_index, css_rule;

            // Parcels loaded!
            //
            Connect.parcels_loaded = true;

            // Add "bridge" links
            //
            for (index = 0; index < Connect.parcel_anchors.length; index += 1) {
                parcel_anchor = Connect.parcel_anchors[index];

                if (parcel_anchor.id.indexOf(':') > 0) {
                    parcel_context_and_id = parcel_anchor.id.split(':');
                    parcel_id = parcel_context_and_id[1];

                    first_page_div = Connect_Window.document.getElementById('page:' + parcel_id + ':first');
                    last_page_div = Connect_Window.document.getElementById('page:' + parcel_id + ':last');
                    if ((first_page_div !== null) && (last_page_div !== null)) {
                        first_page_a = Browser.FirstChildElementWithTagName(first_page_div, 'a');
                        last_page_a = Browser.FirstChildElementWithTagName(last_page_div, 'a');
                        Connect.link_bridge.Track(first_page_a, last_page_a);
                    }
                }
            }

            // Configure TOC levels
            //
            Connect.ConfigureTOCLevels(Connect.toc_div);

            // Intercept all clicks
            //
            Browser.ApplyToChildElementsWithTagName(Connect.toc_div, 'a',
                function (param_link) {
                    param_link.onclick = Connect.NavigationLink;

                    // Track container clicks as well
                    //
                    param_link.parentNode.onclick = Connect.NavigationEntryClick;
                });

            // Track folder clicks
            //
            Browser.ApplyToChildElementsWithTagName(Connect.toc_div, 'div',
                function (param_div) {
                    if (Browser.ContainsClass(param_div.className, 'ww_skin_toc_folder')) {
                        param_div.onclick = Connect.NavigationEntryClick;
                    }
                });

            // Intercept toolbar links
            //
            buttons_to_remove = [];
            Browser.ApplyToChildElementsWithTagName(Connect.toolbar_div, 'a',
                function (param_link) {
                    var match, button_key, button_span, keep;

                    param_link.onclick = Connect.ToolbarLink;

                    // Track buttons
                    //
                    match = param_link.className.match(Connect.button_behavior_expression);
                    if (match !== null) {
                        button_key = match[0];
                        button_span = Browser.FindParentWithTagName(param_link, 'span');
                        if (button_span !== null) {
                            // Keep button?
                            //
                            keep = true;
                            if (Connect_Window.document.location.protocol === 'file:') {
                                if (button_key === 'ww_behavior_globe') {
                                    keep = false;
                                }
                            }

                            // Process button
                            //
                            if (keep) {
                                Connect.buttons[button_key] = button_span;

                                // Initialize sidebar behavior
                                //
                                if ((Connect.sidebar_behavior === undefined) && ((button_key === 'ww_behavior_toc') || (button_key === 'ww_behavior_index'))) {
                                    Connect.sidebar_behavior = button_key;
                                }
                            } else {
                                buttons_to_remove[buttons_to_remove.length] = button_span;
                            }
                        }
                    }
                });

            // Remove buttons
            //
            while (buttons_to_remove.length > 0) {
                button_to_remove = buttons_to_remove.shift();
                if ((button_to_remove.parentNode !== undefined) && (button_to_remove.parentNode !== null)) {
                    button_to_remove.parentNode.removeChild(button_to_remove);
                }
            }

            // Handle toolbar search
            //
            ie_match = Connect_Window.navigator.userAgent.match(/MSIE (\d+)\.\d+;/);
            if ((ie_match === null) || ((ie_match.length > 1) && (parseInt(ie_match[1], 10) > 7))) {
                // Use toolbar search form
                //
                Browser.ApplyToChildElementsWithTagName(Connect.toolbar_div, 'form',
                    function (param_form) {
                        if (Browser.ContainsClass(param_form.className, 'ww_skin_search_form')) {
                            param_form.onsubmit = function () { Connect.Button_Search(); return false; };
                        }
                    });
                Browser.ApplyToChildElementsWithTagName(Connect.toolbar_div, 'input',
                    function (param_input) {
                        if (Browser.ContainsClass(param_input.className, 'ww_skin_search_input')) {
                            Connect.search_input = param_input;
                        }
                    });
            } else {
                // Eliminate toolbar search form for IE
                //
                Browser.ApplyToChildElementsWithTagName(Connect.toolbar_div, 'form',
                    function (param_form) {
                        var parent_element, button_span;

                        // Promote button to form peer
                        //
                        parent_element = param_form.parentNode;
                        button_span = Connect.buttons['ww_behavior_search'];
                        if (button_span !== undefined) {
                            parent_element.insertBefore(button_span, param_form);
                        }

                        // Remove search form
                        //
                        parent_element.removeChild(param_form);
                    });
                Browser.ApplyToChildElementsWithTagName(Connect.toolbar_div, 'input',
                    function (param_input) {
                        var parent_element;

                        parent_element = param_input.parentNode;
                        parent_element.removeChild(param_input);
                    });
            }

            // Display specified document
            //
            if (Connect_Window.location.hash.length > 0) {
                // Use hash
                //
                Connect.DisplaySpecifiedDocument();
            } else {
                // Process default page load
                //
                Connect.DisplayPage(Connect.default_page_url, false);
            }

            // Check for hash changes
            //
            if (('onhashchange' in Connect_Window) && (typeof Connect_Window.history.pushState === 'function')) {
                // Events are so nice!
                //
                Connect_Window.onhashchange = Connect.HashChanged;
            } else {
                // Poll
                //
                Connect.poll_onhashchange = function () {
                    Connect.HashChanged();

                    Connect_Window.setTimeout(Connect.poll_onhashchange, 100);
                };
                Connect_Window.setTimeout(Connect.poll_onhashchange, 1);
            }

            // Done!
            //
            Progress.Complete();

            // Determine top and update CSS rules
            //
            presentation_div_scroll_position = Browser.GetElementScrollPosition(Connect.presentation_div);
            toolbar_table_element = Browser.FirstChildElementWithTagName(Connect.toolbar_div, 'table');
            toolbar_table_widthheight = Browser.GetElementWidthHeight(toolbar_table_element);
            Connect.layout_top = presentation_div_scroll_position.top + toolbar_table_widthheight.height;
            for (css_rules_index = 0; css_rules_index < Connect.layout_top_css_rules.length; css_rules_index += 1) {
                css_rule = Connect.layout_top_css_rules[css_rules_index];
                css_rule.style.top = String(Connect.layout_top) + 'px';
            }

            // Show
            //
            Connect.presentation_div_css_rule.style.visibility = 'visible';
        });
    ajaxdata.Execute();
};

Connect.DisplaySpecifiedDocument = function () {
    'use strict';

    var specified_document_url, context_and_topic, topic_index, context, topic, parcel_id, topic_id, topic_anchor, search_words_parameter, search_words, page_base_relative_url, page_url;

    // Initialize hash tracking
    //
    Connect.hash = Connect_Window.location.hash;

    // Start page load
    //
    specified_document_url = Connect.default_page_url;
    if ((Connect_Window.location.hash === '') || (Connect_Window.location.hash === '#')) {
        // Show default page
        //
        specified_document_url = Connect.default_page_url;
    } else if ((Connect_Window.location.hash.indexOf('#context/') === 0)) {
        // Context/topic requested
        //
        context_and_topic = Connect_Window.location.hash.substring(9);
        topic_index = context_and_topic.indexOf('/');
        context = context_and_topic.substring(0, topic_index);
        topic = context_and_topic.substring(topic_index + 1);

        // Resolve context
        //
        if ((context.length > 0) && (topic.length > 0) && (typeof Connect.parcel_context_ids[context] === 'string')) {
            parcel_id = Connect.parcel_context_ids[context];
            topic_id = 'topic:' + parcel_id + ':' + topic;
            topic_anchor = Connect_Window.document.getElementById(topic_id);
            if (topic_anchor !== null) {
                // Found topic!
                //
                specified_document_url = topic_anchor.href;
            }
        }
    } else if (Connect_Window.location.hash.indexOf('#search/') === 0) {
        // Search enabled?
        //
        if (Connect.search_div !== null) {
            // Page requested
            //
            search_words_parameter = Connect_Window.location.hash.substring(8);
            search_words = decodeURIComponent(search_words_parameter);

            // Initiate search
            //
            Connect.Button_Search(search_words);
        }
    } else if (Connect_Window.location.hash.indexOf('#toc/') === 0) {
        // TOC enabled?
        //
        if (Connect.toc_div !== null) {
            // Display TOC
            //
            if ((!Connect.Panel.Visible()) || (Connect.sidebar_behavior !== 'ww_behavior_toc')) {
                Connect.sidebar_behavior = 'ww_behavior_toc';
                Connect.Button_TOC();
            }
        }
    } else if (Connect_Window.location.hash.indexOf('#index/') === 0) {
        // Index enabled?
        //
        if (Connect.index_div !== null) {
            // Display index
            //
            if ((!Connect.Panel.Visible()) || (Connect.sidebar_behavior !== 'ww_behavior_index')) {
                Connect.sidebar_behavior = 'ww_behavior_index';
                Connect.Button_Index();
            }
        }
    } else if (Connect_Window.location.hash.indexOf('#page/') === 0) {
        // Page requested
        //
        page_base_relative_url = Connect_Window.location.hash.substring(6);

        // Ignore top-level files
        //
        if ((page_base_relative_url.indexOf('/') >= 0) || (page_base_relative_url.indexOf('%2f') >= 0) || (page_base_relative_url.indexOf('%2F') >= 0)) {
            // Build secure URI
            //
            page_base_relative_url = decodeURIComponent(page_base_relative_url);
            page_base_relative_url = page_base_relative_url.replace(/[\\<>:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');

            page_url = Connect.base_url + page_base_relative_url;
            specified_document_url = page_url;
        }
    }

    // Display specified document
    //
    if (specified_document_url !== undefined) {
        Connect.DisplayPage(specified_document_url, false);
    }
};

Connect.HashChanged = function () {
    'use strict';

    if (Connect_Window.location.hash !== Connect.hash) {
        // Update document
        //
        Connect.DisplaySpecifiedDocument();
    }
};

Connect.LocateTOCEntry = function () {
    'use strict';

    var result, page_id, possible_toc_entry_id, possible_toc_link, toc_page_element;

    result = null;

    // See if page exists in TOC
    //
    if (Connect.page_info !== undefined) {
        page_id = Connect.page_info.id;

        // Page ID defined?
        //
        if ((typeof page_id === 'string') && (page_id.length > 0)) {
            // Try instant lookup with document hash
            //
            if ((Connect.page_info.hash.length > 1) && (Connect.page_info.hash.charAt(0) === '#')) {
                possible_toc_entry_id = page_id + ':' + Connect.page_info.hash.substring(1);
                possible_toc_link = Connect_Window.document.getElementById(possible_toc_entry_id);
                if (possible_toc_link !== null) {
                    // TOC link located!
                    //
                    result = Browser.FindParentWithTagName(possible_toc_link, 'li');
                }
            }

            // Result found?
            //
            if (result === null) {
                // Check for page ID in TOC
                //
                toc_page_element = Connect_Window.document.getElementById(page_id);
                if (toc_page_element !== null) {
                    // Found page!
                    //
                    result = Browser.FindParentWithTagName(toc_page_element, 'li');
                }
            }
        }
    }

    return result;
};

Connect.ConfigureTOCLevels = function (param_container_element) {
    'use strict';

    // Configure TOC levels
    //
    Browser.ApplyToChildElementsWithTagName(param_container_element, 'ul',
        function (param_ul) {
            var level, current_node, class_name;

            // Determine level
            //
            level = 1;
            current_node = param_ul.parentNode;
            while (current_node !== param_container_element) {
                if (current_node.nodeName.toLowerCase() === 'ul') {
                    level += 1;
                }

                current_node = current_node.parentNode;
            }

            // Initialize open/close
            //
            class_name = 'ww_skin_toc_level ww_skin_toc_level_' + level;
            if (level === 1) {
                class_name += ' ww_skin_toc_container_open';
            } else {
                class_name += ' ww_skin_toc_container_closed';
            }

            // Update class name
            //
            param_ul.className = class_name;
        });
};

Connect.ToolbarLink = function (param_event) {
    'use strict';

    var event, result;

    // Access event
    //
    event = param_event || window.event;

    // Cancel event bubbling
    //
    event.cancelBubble = true;
    if (event.stopPropagation) {
        event.stopPropagation();
    } else {
        event.cancelBubble = true;
    }

    // Process event
    //
    result = Connect.HandleToolbarLink(this);

    return result;
};

Connect.NavigationLink = function (param_event) {
    'use strict';

    var event, parent_div, result;

    // Access event
    //
    event = param_event || window.event;

    // Cancel event bubbling
    //
    event.cancelBubble = true;
    if (event.stopPropagation) {
        event.stopPropagation();
    } else {
        event.cancelBubble = true;
    }

    // Expand if closed folder
    //
    parent_div = Browser.FindParentWithTagName(this, 'div');
    if ((parent_div !== null) && (Browser.ContainsClass(parent_div.className, 'ww_skin_toc_folder'))) {
        Connect.TOCFolder_Open(parent_div);
    }

    // Process event
    //
    result = Connect.HandleInterceptLink(this, true);
    if (result === false) {
        // Hide panel
        //
        if ((Connect.layout_wide) && (Connect.Panel.display_as_sidebar)) {
            // Keep the panel active!
            //
            Connect.toc_cleanup_folders = false;
        }
    }

    return result;
};

Connect.IndexLink = function (param_event) {
    'use strict';

    var result, event, hash_index, see_also_id, index_entry;

    result = false;

    // Access event
    //
    event = param_event || window.event;

    // Cancel event bubbling
    //
    event.cancelBubble = true;
    if (event.stopPropagation) {
        event.stopPropagation();
    } else {
        event.cancelBubble = true;
    }

    // See/See Also link?
    //
    if (this.rel.toLowerCase() === 'see') {
        hash_index = this.href.indexOf('#');
        if (hash_index >= 0) {
            see_also_id = this.href.substring(hash_index + 1);

            index_entry = Connect_Window.document.getElementById(see_also_id);
            if (index_entry !== null) {
                // Scroll to Index position
                //
                Connect.ScrollToPanelElement(index_entry);
            }
        }

        result = false;
    } else {
        // Document link
        //
        result = Connect.HandleInterceptLink(this, true);
    }

    return result;
};

Connect.TOC_ElementKey = function (param_element) {
    'use strict';

    var element_key, element_in_path, position, sibling;

    // Build key
    //
    element_key = '';
    element_in_path = param_element;
    while ((element_in_path !== undefined) && (element_in_path !== null) && ((typeof element_in_path.id !== 'string') || (element_in_path.id.length === 0))) {
        position = 0;
        sibling = element_in_path;
        while (sibling !== null) {
            position += 1;
            sibling = sibling.previousSibling;
        }
        element_key = element_in_path.nodeName + ':' + position + ':' + element_key;
        element_in_path = element_in_path.parentNode;
    }
    if ((element_in_path !== undefined) && (element_in_path !== null)) {
        element_key = element_in_path.id + ':' + element_key;
    }

    return element_key;
};

Connect.TOC_RecordClassState = function (param_element) {
    'use strict';

    var element_key;

    // Track original class info if enabled
    //
    if (Connect.toc_class_states !== null) {
        // Build key
        //
        element_key = Connect.TOC_ElementKey(param_element);

        // Already tracking?
        //
        if (typeof Connect.toc_class_states[element_key] !== 'object') {
            Connect.toc_class_states[element_key] = { 'element': param_element, 'className': param_element.className};
        }
    }
};

Connect.TOC_RestoreClassStates = function (param_folder_exceptions) {
    'use strict';

    var element_key, preserved_toc_class_states, entry_state;

    if (Connect.toc_class_states !== null) {
        preserved_toc_class_states = {};
        for (element_key in Connect.toc_class_states) {
            if (typeof Connect.toc_class_states[element_key] === 'object') {
                entry_state = Connect.toc_class_states[element_key];
                entry_state.element.className = entry_state.className;

                // Keep folder open?
                //
                if (Browser.ContainsClass(entry_state.className, 'ww_skin_toc_folder')) {
                    if ((param_folder_exceptions !== undefined) && (typeof param_folder_exceptions[element_key] === 'boolean')) {
                        // Keep folder open
                        //
                        preserved_toc_class_states[element_key] = entry_state;
                    } else {
                        // Collapse folder
                        //
                        Connect.TOCFolder_Close(entry_state.element);
                    }
                }
            }
        }

        // Reset tracked states
        //
        Connect.toc_class_states = preserved_toc_class_states;
    }
};

Connect.TOCFolder_Open = function (param_entry_div) {
    'use strict';

    var child_span, sibling_ul;

    if (Browser.ContainsClass(param_entry_div.className, 'ww_skin_toc_folder')) {
        Connect.TOC_RecordClassState(param_entry_div);

        child_span = Browser.FirstChildElementWithTagName(param_entry_div, 'span');
        if (child_span !== null) {
            child_span.className = Browser.ReplaceClass(child_span.className, 'ww_skin_toc_dropdown_closed', 'ww_skin_toc_dropdown_open');
        }
        sibling_ul = Browser.NextSiblingElementWithTagName(param_entry_div, 'ul');
        if (sibling_ul !== null) {
            sibling_ul.className = Browser.ReplaceClass(sibling_ul.className, 'ww_skin_toc_container_closed', 'ww_skin_toc_container_open');
        }
    }
};

Connect.TOCFolder_Close = function (param_entry_div) {
    'use strict';

    var child_span, sibling_ul;

    if (Browser.ContainsClass(param_entry_div.className, 'ww_skin_toc_folder')) {
        Connect.TOC_RecordClassState(param_entry_div);

        child_span = Browser.FirstChildElementWithTagName(param_entry_div, 'span');
        if (child_span !== null) {
            child_span.className = Browser.ReplaceClass(child_span.className, 'ww_skin_toc_dropdown_open', 'ww_skin_toc_dropdown_closed');
        }
        sibling_ul = Browser.NextSiblingElementWithTagName(param_entry_div, 'ul');
        if (sibling_ul !== null) {
            sibling_ul.className = Browser.ReplaceClass(sibling_ul.className, 'ww_skin_toc_container_open', 'ww_skin_toc_container_closed');
        }
    }
};

Connect.TOCFolder_Toggle = function (param_entry_div) {
    'use strict';

    var sibling_ul;

    if (Browser.ContainsClass(param_entry_div.className, 'ww_skin_toc_folder')) {
        sibling_ul = Browser.NextSiblingElementWithTagName(param_entry_div, 'ul');
        if (sibling_ul !== null) {
            if (Browser.ContainsClass(sibling_ul.className, 'ww_skin_toc_container_open')) {
                Connect.TOCFolder_Close(param_entry_div);
            } else if (Browser.ContainsClass(sibling_ul.className, 'ww_skin_toc_container_closed')) {
                Connect.TOCFolder_Open(param_entry_div);
            }
        }
    }
};

Connect.NavigationEntryClick = function (param_event) {
    'use strict';

    var result, event, child_link;

    result = true;

    // Access event
    //
    event = param_event || window.event;

    // Cancel event bubbling
    //
    event.cancelBubble = true;
    if (event.stopPropagation) {
        event.stopPropagation();
    } else {
        event.cancelBubble = true;
    }

    // Intended for the <div> tag?
    //
    if (this.nodeName.toLowerCase() === 'div') {
        // Clicked folder?
        //
        if (Browser.ContainsClass(this.className, 'ww_skin_toc_folder')) {
            // Toggle open/closed
            //
            Connect.TOCFolder_Toggle(this);

            result = false;
        } else {
            // Access child link
            //
            child_link = Browser.FirstChildElementWithTagName(this, 'a');
            if ((child_link !== null) && (child_link.href !== '')) {
                // Display document as current page
                //
                Connect.DisplayPage(child_link.href, true);

                result = false;
            }
        }
    }

    return result;
};

Connect.DisplayPage = function (param_href, param_hide_panel) {
    'use strict';

    // Hide panel
    //
    if (param_hide_panel) {
        if (Connect.Panel.Visible() && ((!Connect.layout_wide) || (!Connect.Panel.display_as_sidebar))) {
            Connect.Panel.Hide();
        }
    }

    Connect_Window.setTimeout(function () {
        var target_href, desired_hash, same_document, data;

        // Ensure target href is valid
        //
        target_href = param_href;
        if ((target_href === undefined) || (target_href === null) || (target_href.length === 0)) {
            target_href = Connect.splash_page_url;
        }

        if (Connect.page_info !== undefined) {
            // Determine desired hash
            //
            desired_hash = '';
            if (target_href.indexOf('#') !== -1) {
                desired_hash = target_href.substring(target_href.indexOf('#'));
            }

            // Load new document or update hash
            //
            same_document = Browser.SameDocument(Connect.page_info.href, target_href);
            if (same_document) {
                // Update hash
                //
                data = {
                    'action': 'update_hash',
                    'hash': desired_hash
                };
                Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);

                // Clear target_href
                //
                target_href = undefined;
            }
        }

        // Display target href if not already handled
        //
        if (target_href !== undefined) {
            if (!Connect.layout_wide) {
                // Guess page height
                //
                Connect.page_div.style.height = String(Connect.GuessPageHeight() - Connect.layout_height_tolerance) + 'px';
            }

            // Display document as page
            //
            if (('onhashchange' in Connect_Window) && (typeof Connect_Window.history.pushState === 'function')) {
                Connect.page_iframe.contentWindow.location.replace(target_href);
            } else {
                Connect.page_iframe.contentWindow.location.assign(target_href);
            }
        }

        // Workaround Google Chrome issues
        //
        Connect.page_iframe.style.display = 'block';
        Connect.page_iframe.style.visibility = 'visible';
    }, 1);
};

Connect.InterceptLink = function (param_event) {
    'use strict';

    var result;

    result = Connect.HandleInterceptLink(this, false);

    return result;
};

Connect.HandleToolbarLink = function (param_link) {
    'use strict';

    var result, behavior;

    result = true;

    if (typeof param_link.className === 'string') {
        // Determine handlers for button
        //
        for (behavior in Connect.button_behaviors) {
            if (typeof Connect.button_behaviors[behavior] === 'function') {
                if (Browser.ContainsClass(param_link.className, behavior)) {
                    Connect.button_behaviors[behavior]();
                    result = false;
                    break;
                }
            }
        }
    }

    return result;
};

Connect.HandleInterceptLink = function (param_link, param_hide_panel) {
    'use strict';

    var result;

    result = Connect.HandleToolbarLink(param_link);
    if (result === true) {
        // Standard link
        //
        if ((param_link.href !== undefined) && (param_link.href !== null) && (param_link.href !== '')) {
            if ((param_link.target === undefined) || (param_link.target === null) || (param_link.target === '') || (param_link.target === 'connect_page')) {
                // Use existing page iframe
                //
                Connect.DisplayPage(param_link.href, param_hide_panel);
            } else {
                // Display in requested window
                //
                Connect_Window.open(param_link.href, param_link.target);
            }

            // Prevent default link behavior
            //
            result = false;
        }
    }

    return result;
};

Connect.DocumentBookkeeping = function (param_same_document) {
    'use strict';

    var cleanup_folders, relative_path, page_hash, page_href, data, behavior;

    // Handle TOC sync
    //
    cleanup_folders = Connect.toc_cleanup_folders;
    Connect.toc_cleanup_folders = true;

    // Determine relative path
    //
    if (Connect.page_info !== undefined) {
        // Update hash
        //
        if (Browser.SameHierarchy(Connect.base_url, Connect.page_info.href)) {
            relative_path = Browser.RelativePath(Connect.base_url, Connect.page_info.href);
            page_hash = '#page/' + encodeURIComponent(relative_path);

            // Splash page?
            //
            if (Browser.SameDocument(Connect.default_page_url, Connect.page_info.href)) {
                if ((Connect_Window.location.hash === page_hash) || (Connect_Window.location.hash === decodeURIComponent(page_hash)) || (Connect_Window.location.hash === '')) {
                    // No change!
                    //
                    page_hash = Connect_Window.location.hash;
                }
            }

            if ((Connect_Window.location.hash !== page_hash) && (Connect_Window.location.hash !== decodeURIComponent(page_hash))) {
                // Determine updated href with new hash
                //
                page_href = Connect_Window.location.href;
                if (Connect_Window.location.hash.length > 0) {
                    page_href = page_href.substring(0, page_href.lastIndexOf(Connect_Window.location.hash));
                }
                page_href += page_hash;

                // Update hash
                //
                if (('onhashchange' in Connect_Window) && (typeof Connect_Window.history.pushState === 'function')) {
                    Connect_Window.history.pushState('', '', page_href);
                } else {
                    Connect_Window.location.replace(page_href);
                }
            }
        }

        // Track current hash
        //
        Connect.hash = Connect_Window.location.hash;

        // Scroll to top if necessary
        //
        if (Connect.page_info.hash === '') {
            Connect_Window.scrollTo(0, 0);
        }

        // Sync TOC
        //
        Connect.SyncTOC(cleanup_folders);

        // Highlight search words
        //
        if (Connect.page_cargo.search_query !== undefined) {
            data = {
                'action': 'page_search_query_highlight',
                'search_query': Connect.page_cargo.search_query
            };
            Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);

            // Reset page cargo
            //
            Connect.page_cargo = {};
        }

        // Adjust for content size
        //
        if (param_same_document) {
            Connect.AdjustLayoutForBrowserSize();
        } else {
            Connect.OnResize();

            // Update anchors
            //
            data = {
                'action': 'update_anchors',
                'target': Connect_Window.name,
                'base_url': Connect.base_url,
                'parcel_prefixes': Connect.parcel_prefixes,
                'button_behaviors': {},
                'email': Connect.email,
                'email_message': Connect.email_message,
                'tolerance': Math.floor(Connect.layout_height_tolerance * 0.25)
            };
            for (behavior in Connect.button_behaviors) {
                if (typeof Connect.button_behaviors[behavior] === 'function') {
                    data.button_behaviors[behavior] = true;
                }
            }
            Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);
        }
    }
};

Connect.Socialize = function () {
    'use strict';

    var data;

    // Socialize
    //
    data = {
        'action': 'page_socialize',
        'disqus_id': Connect.disqus_id
    };
    Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);
};

Connect.Globalize = function () {
    'use strict';

    var data;

    // Google Translation
    //
    if (Connect.globe_enabled) {
        data = {
            'action': 'page_globalize'
        };
        Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);
    }
};

Connect.SearchQueryHighlight = function (param_search_query) {
    'use strict';

    var data;

    data = {
        'action': 'page_search_query_highlight',
        'search_query': param_search_query
    };
    Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);
};

Connect.AdjustForSearchContentSize = function () {
    'use strict';

    var search_div_height, data;

    // Guess page height if not already set
    //
    search_div_height = parseInt(Connect.search_div.style.height, 10);
    if (isNaN(search_div_height)) {
        Connect.search_div.style.height = String(Connect.GuessPageHeight() - Connect.layout_height_tolerance) + 'px';
    }

    data = {
        'action': 'search_get_page_size',
        'stage': 'width'
    };
    Message.Post(Connect.search_iframe.contentWindow, data, Connect_Window);
};

Connect.EnableDisableButton = function (param_button_behavior, param_ccs_class_prefix, param_enable) {
    'use strict';

    var button_span, updated_className;

    button_span = Connect.buttons[param_button_behavior];
    if (button_span !== undefined) {
        // Update class name
        //
        updated_className = button_span.className;
        updated_className = Browser.RemoveClass(updated_className, 'ww_skin_toolbar_button_enabled');
        updated_className = Browser.RemoveClass(updated_className, 'ww_skin_toolbar_button_disabled');
        if (param_enable) {
            // Enable
            //
            updated_className = Browser.AddClass(updated_className, 'ww_skin_toolbar_button_enabled');
        } else {
            // Disable
            //
            updated_className = Browser.AddClass(updated_className, 'ww_skin_toolbar_button_disabled');
        }
        button_span.className = updated_className;
    }
};

Connect.Listen = function (param_event) {
    'use strict';

    // Initialize listen dispatcher
    //
    if (Connect.dispatch_listen === undefined) {
        Connect.dispatch_listen = {
            'page_load': function (param_data) {
                Connect.page_info = param_data;
                delete Connect.page_info['action'];

                Connect.OnDocumentLoad();
                Connect.ignore_page_load = true;
            },
            'page_unload': function (param_data) {
                Connect.page_info = undefined;
                Connect.OnDocumentUnload();
            },
            'page_size': function (param_data) {
                var data;

                if (Connect.page_info !== undefined) {
                    // Clear fallback, if present
                    //
                    Connect.container_div.className = Browser.RemoveClass(Connect.container_div.className, 'unknown_page');

                    // Update dimensions
                    //
                    Connect.page_info.dimensions = param_data.dimensions;

                    // Handle resize
                    //
                    if (param_data.stage === 'width') {
                        // Update height
                        //
                        data = {
                            'action': 'get_page_size',
                            'stage': 'height'
                        };
                        Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);
                    } else if (param_data.stage === 'height') {
                        // Either defer to scrolling or set height
                        //
                        if ((Connect.layout_wide) && (Connect.scrolling_supported)) {
                            // Clear height and allow scroll bars to do their thing
                            //
                            Connect.page_div.style.height = '';
                        } else {
                            // Set content height
                            //
                            Connect.page_div.style.height = String(Connect.page_info.dimensions.height + Connect.layout_height_tolerance) + 'px';
                        }

                        // Notify page resize complete
                        //
                        data = {
                            'action': 'resize_complete'
                        };
                        Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);
                    }
                }
            },
            'page_bookkeeping': function (param_data) {
                // Document bookkeeping
                //
                if (param_data.href !== undefined) {
                    Connect.page_info.href = param_data.href;
                }
                if (param_data.hash !== undefined) {
                    Connect.page_info.hash = param_data.hash;
                }
                Connect.DocumentBookkeeping(true);
            },
            'notify_page_max_width_set': function (param_data) {
                var data;

                // Adjust for content width
                //
                data = {
                    'action': 'get_page_size',
                    'stage': 'width'
                };
                Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);
            },
            'page_content_changed': function (param_data) {
                // Initiate resize operation
                //
                Connect.OnResize();
            },
            'page_scroll_view': function (param_data) {
                var scroll_position, top;

                // Update scroll location to display page data
                //
                scroll_position = Browser.GetElementScrollPosition(Connect.page_iframe);

                // Determine final scroll position and scroll
                //
                top = scroll_position.top + param_data.top;
                Connect_Window.scrollTo(0, top);
            },
            'back_to_top': function (param_data) {
                if (!Connect.layout_wide) {
                    Connect_Window.scrollTo(0, 0);
                }
            },
            'handle_toolbar_link' : function (param_data) {
                // Invoke toolbar link
                //
                Connect.button_behaviors[param_data.behavior]();
            },
            'display_link': function (param_data) {
                if ((param_data.target === undefined) || (param_data.target === null) || (param_data.target === '') || (param_data.target === 'connect_page')) {
                    // Use existing page iframe
                    //
                    Connect.DisplayPage(param_data.href, false);
                } else {
                    // Display in requested window
                    //
                    Connect_Window.open(param_data.href, param_data.target);
                }
            },
            'display_image': function (param_data) {
                Connect.DisplayFullsizeImage(param_data);
            },
            'search_page_load': function (param_data) {
                var data;

                // Record page info
                //
                Connect.search_page_info = param_data;
                delete Connect.search_page_info['action'];

                // Send search file list
                //
                data = {
                    'action': 'search_connect_info',
                    'target': Connect_Window.name,
                    'base_url': Connect.base_url,
                    'parcel_prefixes': Connect.parcel_prefixes,
                    'parcel_sx': Connect.parcel_sx
                };
                Message.Post(Connect.search_iframe.contentWindow, data, Connect_Window);
            },
            'search_ready': function (param_data) {
                var data;

                // Search panel displayed?
                //
                if (Connect.search_div.parentNode !== Connect.panels_div) {
                    // Execute search
                    //
                    data = {
                        'action': 'search_execute',
                        'query': Connect.search_query
                    };
                    Message.Post(Connect.search_iframe.contentWindow, data, Connect_Window);
                }
            },
            'search_complete': function (param_data) {
                // Update search words
                //
                Connect.search_query = param_data.query;

                // Update dimensions
                //
                Connect.search_page_info.dimensions = param_data.dimensions;

                // Adjust layout for search content
                //
                Connect.AdjustForSearchContentSize();
            },
            'search_page_size': function (param_data) {
                var data;

                // Update dimensions
                //
                Connect.search_page_info.dimensions = param_data.dimensions;

                // Handle resize
                //
                if (param_data.stage === 'width') {
                    // Update height
                    //
                    data = {
                        'action': 'search_get_page_size',
                        'stage': 'height'
                    };
                    Message.Post(Connect.search_iframe.contentWindow, data, Connect_Window);
                } else if (param_data.stage === 'height') {
                    // Set content height
                    //
                    Connect.search_div.style.height = String(Connect.search_page_info.dimensions.height + Connect.layout_height_tolerance) + 'px';

                    // Workaround Google Chrome refresh issue
                    //
                    Connect.search_iframe.style.height = '';
                    Connect.search_iframe.style.height = '100%';
                }
            },
            'search_display_link': function (param_data) {
                // Track search words
                //
                Connect.page_cargo.search_href = param_data.href;
                Connect.page_cargo.search_query = Connect.search_query;

                // Shutdown panel
                //
                Connect.Button_Search();

                // Display specified page
                //
                if (param_data.href !== undefined) {
                    Connect_Window.setTimeout(function () {
                        Connect.DisplayPage(param_data.href, true);
                    }, 10);
                }
            }
        };
    }

    // Dispatch event
    //
    try {
        Connect.dispatch_listen[param_event.data.action](param_event.data);
    } catch (ignore) {
        // Keep on rolling
        //
    }
};

Connect.UpdateTitle = function () {
    'use strict';

    var title, page_document;

    // Determine title
    //
    title = '';
    if (Connect.page_info !== undefined) {
        title = Connect.page_info.title;
    } else {
        page_document = Browser.GetDocument(Connect.page_iframe);
        if (page_document !== undefined) {
            title = page_document.title;
        }
    }

    // Set title
    //
    Connect.SetTitle(title);
};

Connect.SetTitle = function (param_title) {
    'use strict';

    // Update window title
    //
    Connect_Window.document.title = param_title;
};

Connect.OnDocumentLoad = function () {
    'use strict';

    var enable_button, prevnext_link;

    // Environment initialized?
    //
    if (Connect.ignore_page_load) {
        Connect.ignore_page_load = false;
    } else {
        if (Connect.parcels_loaded) {
            // Document bookkeeping
            //
            Connect.DocumentBookkeeping(false);

            // Update title
            //
            Connect.UpdateTitle();

            // Update home
            //
            enable_button = ((Connect.page_info === undefined) || (!Browser.SameDocument(Connect.default_page_url, Connect.page_info.href)));
            Connect.EnableDisableButton('ww_behavior_home', 'ww_skin_home', enable_button);

            // Update prev/next
            //
            prevnext_link = Connect.GetPrevNext('Prev');
            enable_button = (prevnext_link !== undefined);
            Connect.EnableDisableButton('ww_behavior_prev', 'ww_skin_prev', enable_button);
            prevnext_link = Connect.GetPrevNext('Next');
            enable_button = (prevnext_link !== undefined);
            Connect.EnableDisableButton('ww_behavior_next', 'ww_skin_next', enable_button);

            // Socialize and Globalize
            //
            Connect_Window.setTimeout(function () {
                Connect.Socialize();
                Connect.Globalize();
            }, 1);

            // Double-check sizing
            //
            Connect.OnResize();
        }
    }
};

Connect.OnDocumentUnload = function () {
    'use strict';

    Connect.UpdateTitle();
};

Connect.DisplayFullsizeImage = function (param_image_data) {
    'use strict';

    var browser_widthheight, fullsize_image;

    // Retrieve width/height info
    //
    browser_widthheight = Browser.GetBrowserWidthHeight(Connect_Window);

    // Enough room for lightbox?
    //
    if (((param_image_data.width + Connect.lightbox_min_pixel_margin) < browser_widthheight.width) && ((param_image_data.height + Connect.lightbox_min_pixel_margin) < browser_widthheight.height)) {
        // Create image to display
        //
        fullsize_image = Connect_Window.document.createElement('img');
        Browser.SetAttribute(fullsize_image, 'width', param_image_data.width);
        Browser.SetAttribute(fullsize_image, 'height', param_image_data.height);
        Browser.SetAttribute(fullsize_image, 'src', param_image_data.src);

        // Display lightbox
        //
        Connect.Lightbox.Display(
            function (param_lightbox_content) {
                param_lightbox_content.appendChild(fullsize_image);
            },
            function (param_lightbox_content) {
                param_lightbox_content.removeChild(fullsize_image);
            }
        );
    } else {
        // Replace displayed document
        //
        Connect.DisplayPage(param_image_data.href, false);
    }
};

Connect.ScrollToPanelElement = function (param_element) {
    'use strict';

    var browser_widthheight, panel_height, element_scroll_position, panel_75_height, panel_50_height, target_scroll_top, panel_frame_scroll_position;

    // Narrow or wide layout?
    //
    if (Connect.layout_wide) {
        // Scroll to element position
        //
        browser_widthheight = Browser.GetBrowserWidthHeight(Connect_Window);
        panel_height = browser_widthheight.height - Connect.layout_top;

        element_scroll_position = Browser.GetElementScrollPosition(param_element, Connect.panel_frame_div);
        panel_75_height = Math.floor(panel_height * 0.75);
        panel_50_height = Math.floor(panel_height * 0.5);
        if ((element_scroll_position.top >= Connect.panel_frame_div.scrollTop) && (element_scroll_position.top <= (Connect.panel_frame_div.scrollTop + panel_75_height))) {
            // Do nothing
            //
            target_scroll_top = Connect.panel_frame_div.scrollTop;
        } else {
            if (element_scroll_position.top < panel_75_height) {
                target_scroll_top = 0;
            } else {
                target_scroll_top = element_scroll_position.top - panel_50_height;
            }
        }
        Connect.panel_frame_div.scrollTop = target_scroll_top;
    } else {
        panel_frame_scroll_position = Browser.GetElementScrollPosition(Connect.panel_frame_div);
        element_scroll_position = Browser.GetElementScrollPosition(param_element);
        Connect_Window.scrollTo(
            panel_frame_scroll_position.left + element_scroll_position.left,
            panel_frame_scroll_position.top + element_scroll_position.top
        );
    }
};

Connect.SyncTOC = function (param_cleanup_folders) {
    'use strict';

    var entry_state, toc_entry, entry_div, folder_exceptions, parent_ul, parent_entry_div;

    // Clear highlight
    //
    if (Connect.toc_selected_entry_key !== undefined) {
        entry_state = Connect.toc_class_states[Connect.toc_selected_entry_key];
        if (entry_state !== undefined) {
            entry_state.element.className = entry_state.className;
        }

        Connect.toc_selected_entry_key = undefined;
    }

    // Locate TOC entry
    //
    toc_entry = Connect.LocateTOCEntry();

    // Expand TOC for context
    //
    if (toc_entry !== null) {
        // Highlight entry
        //
        entry_div = Browser.FirstChildElementWithTagName(toc_entry, 'div');
        if (entry_div !== null) {
            // Clean up folders?
            //
            if (param_cleanup_folders) {
                folder_exceptions = {};
                if (Browser.ContainsClass(entry_div.className, 'ww_skin_toc_folder')) {
                    folder_exceptions[Connect.TOC_ElementKey(entry_div)] = true;
                }
                parent_ul = Browser.FindParentWithTagName(entry_div, 'ul');
                while (parent_ul !== null) {
                    parent_entry_div = Browser.PreviousSiblingElementWithTagName(parent_ul, 'div');
                    if (parent_entry_div !== null) {
                        if (Browser.ContainsClass(parent_entry_div.className, 'ww_skin_toc_folder')) {
                            folder_exceptions[Connect.TOC_ElementKey(parent_entry_div)] = true;
                        }
                    }

                    parent_ul = Browser.FindParentWithTagName(parent_ul, 'ul');
                }
                Connect.TOC_RestoreClassStates(folder_exceptions);
            }

            // Highlight
            //
            Connect.TOC_RecordClassState(entry_div);
            entry_div.className = Browser.AddClass(entry_div.className, 'ww_skin_toc_entry_selected');
            Connect.toc_selected_entry_key = Connect.TOC_ElementKey(entry_div);

            // Expand entry and parents
            //
            Connect.TOCFolder_Open(entry_div);
            parent_ul = Browser.FindParentWithTagName(entry_div, 'ul');
            while (parent_ul !== null) {
                parent_entry_div = Browser.PreviousSiblingElementWithTagName(parent_ul, 'div');
                if (parent_entry_div !== null) {
                    Connect.TOCFolder_Open(parent_entry_div);
                }

                parent_ul = Browser.FindParentWithTagName(parent_ul, 'ul');
            }

            // Scroll to TOC position
            //
            Connect.ScrollToPanelElement(toc_entry);
        }
    }
};

Connect.Button_Home = function () {
    'use strict';

    // Panel visible?
    //
    if ((Connect.Panel.Visible()) && (!(Connect.Panel.display_as_sidebar))) {
        // Hide
        //
        Connect.Panel.Hide();
    }

    // Go to default page
    //
    Connect.DisplayPage(Connect.default_page_url, true);
};

Connect.Button_TOC = function () {
    'use strict';

    var button_span;

    button_span = Connect.buttons['ww_behavior_toc'];

    if (!Connect.Panel.Visible()) {
        // Enable sidebar auto display
        //
        Connect.sidebar_auto_display = true;

        // Show
        //
        Connect.Panel.Display(true,
            function (param_window, param_panel_content) {
                // Highlight toolbar button
                //
                if (button_span !== undefined) {
                    button_span.className = Browser.ReplaceClass(button_span.className, 'ww_skin_toolbar_background_default', 'ww_skin_toolbar_background_selected');
                }

                // Set title
                //
                Connect.SetTitle('Ehcache');

                // Sync TOC
                //
                Connect.SyncTOC(Connect.toc_cleanup_folders);

                // On Stage
                //
                param_panel_content.appendChild(Connect.toc_div);

                // Retry Sync TOC if necessary
                //
                if (!Connect.Panel.Visible()) {
                    Connect_Window.setTimeout(function () {
                        Connect.SyncTOC(Connect.toc_cleanup_folders);
                    }, 10);
                }
            },
            function () {
                Connect.OnResize();
            },
            function (param_window, param_panel_content) {
                // Backstage
                //
                Connect.panels_div.appendChild(Connect.toc_div);

                // Update title
                //
                Connect.UpdateTitle();

                // Restore class info
                //
                Connect.TOC_RestoreClassStates();

                // Highlight toolbar button
                //
                if (button_span !== undefined) {
                    button_span.className = Browser.ReplaceClass(button_span.className, 'ww_skin_toolbar_background_selected', 'ww_skin_toolbar_background_default');
                }
            });
    } else {
        // Panel currently displayed?
        //
        if ((button_span !== undefined) && (Browser.ContainsClass(button_span.className, 'ww_skin_toolbar_background_selected'))) {
            // Disable sidebar auto display
            //
            Connect.sidebar_auto_display = false;

            // Hide
            //
            Connect.Panel.Hide();
        } else {
            // Hide current panel
            //
            Connect.panel_changing = true;
            Connect.Panel.Hide(false);
            Connect.panel_changing = false;

            // Show this panel
            //
            Connect.Button_TOC();
        }
    }
};

Connect.Button_Index = function () {
    'use strict';

    var button_span;

    button_span = Connect.buttons['ww_behavior_index'];

    if (!Connect.Panel.Visible()) {
        // Enable sidebar auto display
        //
        Connect.sidebar_auto_display = true;

        // Show
        //
        Connect.Panel.Display(true,
            function (param_window, param_panel_content) {
                var progress_div;

                // Set title
                //
                Connect.SetTitle('Ehcache');

                // Highlight toolbar button
                //
                if (button_span !== undefined) {
                    button_span.className = Browser.ReplaceClass(button_span.className, 'ww_skin_toolbar_background_default', 'ww_skin_toolbar_background_selected');
                }

                // On Stage
                //
                if (Connect.parcel_ix.length > 0) {
                    // Show progress
                    //
                    Connect.panel_progress_div.innerHTML = '';
                    progress_div = Connect_Window.document.getElementById('progress');
                    Connect.panel_progress_div.appendChild(progress_div);
                    param_panel_content.appendChild(Connect.panel_progress_div);
                    Progress.Reset();

                    // Initiate index load
                    //
                    Connect.index_content_div.innerHTML = '';
                    Connect_Window.setTimeout(Connect.Index_Load, 1);
                } else {
                    // Show index
                    //
                    param_panel_content.appendChild(Connect.index_div);
                }
            },
            function () {
                Connect.OnResize();
            },
            function (param_window, param_panel_content) {
                // Backstage
                //
                Connect.panels_div.appendChild(Connect.index_div);

                // Update title
                //
                Connect.UpdateTitle();

                // Highlight toolbar button
                //
                if (button_span !== undefined) {
                    button_span.className = Browser.ReplaceClass(button_span.className, 'ww_skin_toolbar_background_selected', 'ww_skin_toolbar_background_default');
                }
            });
    } else {
        // Panel currently displayed?
        //
        if ((button_span !== undefined) && (Browser.ContainsClass(button_span.className, 'ww_skin_toolbar_background_selected'))) {
            // Disable sidebar auto display
            //
            Connect.sidebar_auto_display = false;

            // Hide
            //
            Connect.Panel.Hide();
        } else {
            // Hide current panel
            //
            Connect.panel_changing = true;
            Connect.Panel.Hide(false);
            Connect.panel_changing = false;

            // Show this panel
            //
            Connect.Button_Index();
        }
    }
};

Connect.Index_Load = function () {
    'use strict';

    var index, parcel_anchor, parcel_context_and_id, parcel_id, parcel_entry_placeholder_div, ajaxdata;

    // Prepare index for data load
    //
    for (index = 0; index < Connect.parcel_anchors.length; index += 1) {
        parcel_anchor = Connect.parcel_anchors[index];

        if (parcel_anchor.id.indexOf(':') > 0) {
            parcel_context_and_id = parcel_anchor.id.split(':');
            parcel_id = parcel_context_and_id[1];

            // Emit index placeholders
            //
            parcel_entry_placeholder_div = Connect_Window.document.createElement('div');
            parcel_entry_placeholder_div.id = 'parcel_index:' + parcel_id;
            parcel_entry_placeholder_div.className = 'ww_skin_index_title';
            parcel_entry_placeholder_div.innerHTML = Connect.parcel_title[parcel_id];

            Connect.index_content_div.appendChild(parcel_entry_placeholder_div);
        }
    }

    // Load index data
    //
    ajaxdata = new AJAXData_Object(Connect.parcel_ix,
        function (param_entry) {
            return param_entry.url;
        },
        function (param_percent) {
            Progress.Update(param_percent);
        },
        function (param_entry, param_ajax) {
            var parcel_data, parcel_entry_div_id, parcel_entry_div, parcel_index_div_id, parcel_index_div;

            // Access parcel data
            //
            parcel_data = Connect_Window.document.createElement('div');
            parcel_data.style.visibility = 'hidden';
            parcel_data.innerHTML = param_ajax.responseText;
            Connect_Window.document.body.appendChild(parcel_data);

            // Index
            //
            parcel_entry_div_id = 'parcel_index:' + param_entry.id;
            parcel_entry_div = Connect_Window.document.getElementById(parcel_entry_div_id);
            if (parcel_entry_div !== null) {
                parcel_index_div_id = 'index:' + param_entry.id;
                parcel_index_div = Connect_Window.document.getElementById(parcel_index_div_id);
                if ((parcel_index_div !== null) && (parcel_index_div.innerHTML.length > 0)) {
                    if (parcel_entry_div.nextSibling !== null) {
                        Connect.index_content_div.insertBefore(parcel_index_div, parcel_entry_div.nextSibling);
                    } else {
                        Connect.index_content_div.appendChild(parcel_index_div);
                    }
                } else {
                    Connect.index_content_div.removeChild(parcel_entry_div);
                }
            }

            // Remove parcel data
            //
            Connect_Window.document.body.removeChild(parcel_data);
        },
        function () {
            var progress_div;

            // Parcel indexes loaded!
            //
            Connect.parcel_ix = [];

            // Intercept all clicks
            //
            Browser.ApplyToChildElementsWithTagName(Connect.index_div, 'a',
                function (param_link) {
                    param_link.onclick = Connect.IndexLink;
                });

            // Done!
            //
            Progress.Complete();
            progress_div = Connect_Window.document.getElementById('progress');
            Connect.panels_div.appendChild(Connect.panel_progress_div);
            Connect_Window.document.body.appendChild(progress_div);

            // On stage!
            //
            Connect.Panel.panel_content.appendChild(Connect.index_div);
        });
    ajaxdata.Execute();
};

Connect.Button_Search = function (param_search_words) {
    'use strict';

    var button_span;

    button_span = Connect.buttons['ww_behavior_search'];

    if (!Connect.Panel.Visible()) {
        // Show
        //
        Connect.Panel.Display(false,
            function (param_window, param_panel_content) {
                var search_words, data;

                // Highlight toolbar button
                //
                if (button_span !== undefined) {
                    button_span.className = Browser.ReplaceClass(button_span.className, 'ww_skin_toolbar_background_default', 'ww_skin_toolbar_background_selected');
                }

                // Set title
                //
                Connect.SetTitle('Search');

                // Get search words
                //
                search_words = '';
                if ((param_search_words !== undefined) && (typeof param_search_words === 'string')) {
                    search_words = param_search_words;
                } else {
                    if ((Connect.search_input !== null)) {
                        search_words = Connect.search_input.value;
                    } else {
                        search_words = Connect.search_query;
                    }
                }

                // Update search words
                //
                Connect.search_query = search_words;

                // On Stage
                //
                param_panel_content.appendChild(Connect.search_div);

                // Execute search
                //
                if (Connect.search_iframe.src !== Connect.search_page_url) {
                    // Load page
                    //
                    Connect.search_iframe.src = Connect.search_page_url;
                } else {
                    // Search
                    //
                    if (Connect.search_query.length === 0) {
                        Connect.AdjustForSearchContentSize();
                    } else {
                        data = {
                            'action': 'search_execute',
                            'query': Connect.search_query
                        };
                        Message.Post(Connect.search_iframe.contentWindow, data, Connect_Window);
                    }
                }
            },
            function () {
                Connect.AdjustForSearchContentSize();
            },
            function (param_window, param_panel_content) {
                // Update search words
                //
                if (Connect.search_input !== null) {
                    Connect.search_input.value = Connect.search_query;
                }

                // Backstage
                //
                Connect.panels_div.appendChild(Connect.search_div);

                // Update title
                //
                Connect.UpdateTitle();

                // Highlight toolbar button
                //
                if (button_span !== undefined) {
                    button_span.className = Browser.ReplaceClass(button_span.className, 'ww_skin_toolbar_background_selected', 'ww_skin_toolbar_background_default');
                }

                // Ensure layout updated
                //
                Connect_Window.setTimeout(function () { Connect.AdjustLayoutForBrowserSize(); }, 1);
            });
    } else {
        // Panel currently displayed?
        //
        if ((button_span !== undefined) && (Browser.ContainsClass(button_span.className, 'ww_skin_toolbar_background_selected'))) {
            // Hide
            //
            Connect.Panel.Hide();
        } else {
            // Hide current panel
            //
            Connect.panel_changing = true;
            Connect.Panel.Hide(false);
            Connect.panel_changing = false;

            // Show this panel
            //
            Connect.Button_Search(param_search_words);
        }
    }
};

Connect.Button_Globe = function () {
    'use strict';

    var button_span, page_document;

    // Panel visible?
    //
    if ((Connect.Panel.Visible()) && (!(Connect.Panel.display_as_sidebar))) {
        // Hide
        //
        Connect.Panel.Hide();
    }

    // Enabled?
    //
    button_span = Connect.buttons['ww_behavior_globe'];
    if (!Connect.globe_enabled) {
        // Highlight toolbar button
        //
        if (button_span !== undefined) {
            button_span.className = Browser.ReplaceClass(button_span.className, 'ww_skin_toolbar_background_default', 'ww_skin_toolbar_background_selected');
        }

        // Globalize
        //
        Connect.globe_enabled = true;
        Connect_Window.setTimeout(Connect.Globalize, 1);
    } else {
        // Disable globalization
        //
        Connect.globe_enabled = false;
        page_document = Browser.GetDocument(Connect.page_iframe);
        if (page_document !== undefined) {
            Connect_Window.setTimeout(function () { page_document.location.reload(); }, 1);
        }

        // Highlight toolbar button
        //
        if (button_span !== undefined) {
            button_span.className = Browser.ReplaceClass(button_span.className, 'ww_skin_toolbar_background_selected', 'ww_skin_toolbar_background_default');
        }
    }
};

Connect.GetPrevNext = function (param_prevnext) {
    'use strict';

    var result;

    if (Connect.page_info !== undefined) {
        result = Connect.page_info[param_prevnext];
        if (result === undefined) {
            // Spanning parcels?
            //
            if (Connect.link_bridge.Get(param_prevnext, Connect.page_info.id) !== null) {
                result = Connect.link_bridge.Get(param_prevnext, Connect.page_info.id);
            }
        }
    }

    return result;
};

Connect.GotoPrevNext = function (param_prevnext) {
    'use strict';

    var link_href;

    link_href = Connect.GetPrevNext(param_prevnext);
    if (link_href !== undefined) {
        Connect.DisplayPage(link_href, true);
    }
};

Connect.Button_Previous = function () {
    'use strict';

    // Panel visible?
    //
    if ((Connect.Panel.Visible()) && (!(Connect.Panel.display_as_sidebar))) {
        // Hide
        //
        Connect.Panel.Hide();
    }

    Connect.GotoPrevNext('Prev');
};

Connect.Button_Next = function () {
    'use strict';

    // Panel visible?
    //
    if ((Connect.Panel.Visible()) && (!(Connect.Panel.display_as_sidebar))) {
        // Hide
        //
        Connect.Panel.Hide();
    }

    Connect.GotoPrevNext('Next');
};

Connect.Button_Email = function () {
    'use strict';

    var message, mailto;

    // Panel visible?
    //
    if ((Connect.Panel.Visible()) && (!(Connect.Panel.display_as_sidebar))) {
        // Hide
        //
        Connect.Panel.Hide();
    }

    if ((Connect.email.length > 0) && (Connect.email_message.length > 0)) {
        message = Connect.email_message.replace('$Location;', Connect_Window.location.href);
        if (Connect_Window.navigator.userAgent.indexOf('MSIE') !== -1) {
            message = message.replace('#', '%23');
        }
        mailto = 'mailto:' + Connect.email + '?subject=' + encodeURIComponent(message) + '&body=' + encodeURIComponent(message);

        Connect_Window.open(mailto, '_blank');
    }
};

Connect.Button_Print = function () {
    'use strict';

    var page_window, data;

    // Try direct method
    //
    try {
        page_window = Connect.page_iframe.contentWindow || Connect_Window.frames['connect_page'];
        if ((page_window !== undefined) && (page_window !== null)) {
            page_window.print();
        }
    } catch (access_denied) {
        // Try page action
        //
        data = {
            'action': 'ww_behavior_print'
        };
        Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);
    }
};

Connect.Button_PDF = function () {
    'use strict';

    var data;

    // Try page action
    //
    data = {
        'action': 'ww_behavior_pdf'
    };
    Message.Post(Connect.page_iframe.contentWindow, data, Connect_Window);
};

// --></script>
    <style type="text/css"><!--
/* Text size adjustments */

body {
    -webkit-text-size-adjust: none;
    -ms-text-size-adjust: none;
    text-size-adjust: none;
}


/* Company Info */

.ww_skin_company_logo {
    text-align: left;
    margin: 8px 8px 8px 0;
}

.ww_skin_company_logo > a:link {
    color: #007196;
    text-decoration: none;
}

.ww_skin_company_logo > a:visited {
    color: #6186C5;
    text-decoration: none;
}

.ww_skin_company_logo > a:link:hover, .ww_skin_company_logo > a:visited:hover {
    text-decoration: underline;
}

.ww_skin_company_name {
    font-family: Arial, sans-serif;
    font-size: 14pt;
    font-weight: bold;
    text-align: left;
}

.ww_skin_company_name > a:link {
    color: #007196;
    text-decoration: none;
}

.ww_skin_company_name > a:visited {
    color: #6186C5;
    text-decoration: none;
}

.ww_skin_company_name > a:link:hover, .ww_skin_company_name > a:visited:hover {
    text-decoration: underline;
}

.ww_skin_company_phone {
    font-family: Arial, sans-serif;
    font-size: 10pt;
    text-align: right;
}

.ww_skin_company_fax {
    font-family: Arial, sans-serif;
    font-size: 10pt;
    text-align: right;
}

.ww_skin_company_email {
    font-family: Arial, sans-serif;
    font-size: 10pt;
    text-align: right;
}

.ww_skin_company_email > a:link {
    color: #007196;
    text-decoration: none;
}

.ww_skin_company_email > a:visited {
    color: #6186C5;
    text-decoration: none;
}

.ww_skin_company_email > a:link:hover, .ww_skin_company_email > a:visited:hover {
    text-decoration: underline;
}


/* Progress */

.ww_skin_progress_bar {
    border: 1px solid #007196;
    width: 100%;
    height: 18px;
    padding: 1px;
    white-space: nowrap;
}

.ww_skin_progress_segment {
    float: left;
    position: relative;
    width: 10%;
    height: 100%;
}

.ww_skin_progress_segment_pending {
    background-color: transparent;
}

.ww_skin_progress_segment_complete {
    background: #2E7B9C;
    background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #8ABBD0), color-stop(0.76, #2E7B9C));
    background-image: -o-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: -moz-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: -webkit-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: -ms-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: linear-gradient(to bottom, #8ABBD0 0%, #2E7B9C 76%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#8ABBD0', endColorstr='#2E7B9C',GradientType=0 );
}


/* Reference CSS sprite */

.ww_skin {
    background-image: url('../../connect/images/skin.png');
    background-repeat: no-repeat;
}

a.ww_skin {
    color: transparent;
    text-decoration: none;
    outline-width: 0;
}


/* Panel Progress */

.ww_skin_panel_progress_background {
    background-color: white;
}


/* TOC */

.ww_skin_toc_background {
    margin: 0;
    padding: 0;
}

.ww_skin_toc {
    display: inline-block;
    width: 38px;
    height: 38px;
	vertical-align: middle;
    background-position: -304px -32px;
}

.ww_skin_toolbar_background_default > .ww_skin_toc:hover {
    background-position: -376px -32px;
}

.ww_skin_toolbar_background_selected > .ww_skin_toc {
    background-position: -448px -32px;
}

a.ww_skin_toc_spacer {
    background-image: none;
    width: 15px;
}

.layout_narrow a.ww_skin_toc_spacer {
    display: none;
}


/* Index */

.ww_skin_index_background {
    margin: 0;
    padding: 0;
}

.ww_skin_index {
    display: inline-block;
    width: 38px;
    height: 38px;
	vertical-align: middle;
    background-position: -304px -128px;
}

.ww_skin_toolbar_background_default > .ww_skin_index:hover {
    background-position: -376px -128px;
}

.ww_skin_toolbar_background_selected > .ww_skin_index {
    background-position: -448px -128px;
}

a.ww_skin_index_spacer {
    background-image: none;
    width: 15px;
}

.layout_narrow a.ww_skin_index_spacer {
    display: none;
}


/* Home */

.ww_skin_home {
    display: inline-block;
    width: 38px;
    height: 38px;
	vertical-align: middle;
    background-position: -520px -1376px;
}

.ww_skin_toolbar_button_enabled > .ww_skin_home {
    background-position: -304px -1376px;
}

.ww_skin_toolbar_button_enabled.ww_skin_toolbar_background_default > .ww_skin_home:hover {
    background-position: -376px -1376px;
}

.ww_skin_toolbar_button_enabled.ww_skin_toolbar_background_selected > .ww_skin_home {
    background-position: -448px -1376px;
}

a.ww_skin_home_spacer {
    background-image: none;
    width: 15px;
}

.layout_narrow a.ww_skin_home_spacer {
    display: none;
}


/* Search */

.ww_skin_search_background {
    margin: 0;
    padding: 0;
}

.ww_skin_search {
    display: inline-block;
    width: 38px;
    height: 38px;
    background-position: -304px -224px;
}

.ww_skin_toolbar_background_default > .ww_skin_search:hover {
    background-position: -376px -224px;
}

.ww_skin_toolbar_background_selected > .ww_skin_search {
    background-position: -448px -224px;
}

a.ww_skin_search_spacer {
    display: none;
}

.layout_narrow a.ww_skin_search_spacer {
    display: none;
}


/* Globe */

.ww_skin_globe_background {
    padding: 16px;
    background-color: white;
}

.ww_skin_globe {
    display: inline-block;
    width: 38px;
    height: 38px;
	vertical-align: middle;
    background-position: -304px -320px;
}

.ww_skin_toolbar_background_default > .ww_skin_globe:hover {
    background-position: -376px -320px;
}

.ww_skin_toolbar_background_selected > .ww_skin_globe {
    background-position: -448px -320px;
}

a.ww_skin_globe_spacer {
    background-image: none;
    width: 15px;
}

.layout_narrow a.ww_skin_globe_spacer {
    display: none;
}


/* Next */

.ww_skin_next {
    display: inline-block;
    width: 38px;
    height: 38px;
    background-position: -520px -416px;
}

.ww_skin_toolbar_button_enabled > .ww_skin_next {
    background-position: -304px -416px;
}

.ww_skin_toolbar_button_enabled.ww_skin_toolbar_background_default > .ww_skin_next:hover {
    background-position: -376px -416px;
}

.ww_skin_toolbar_button_enabled.ww_skin_toolbar_background_selected > .ww_skin_next {
    background-position: -448px -416px;
}

a.ww_skin_next_spacer {
    display: none;
}

.layout_narrow a.ww_skin_next_spacer {
    display: none;
}


/* Previous */

.ww_skin_prev {
    display: inline-block;
    width: 38px;
    height: 38px;
    background-position: -520px -512px;
}

.ww_skin_toolbar_button_enabled > .ww_skin_prev {
    background-position: -304px -512px;
}

.ww_skin_toolbar_button_enabled.ww_skin_toolbar_background_default > .ww_skin_prev:hover {
    background-position: -376px -512px;
}

.ww_skin_toolbar_button_enabled.ww_skin_toolbar_background_selected > .ww_skin_prev {
    background-position: -448px -512px;
}

a.ww_skin_prev_spacer {
    display: none;
}

.layout_narrow a.ww_skin_prev_spacer {
    display: none;
}


/* PDF */

.ww_skin_pdf {
    display: inline-block;
    width: 21px;
    height: 24px;
    line-height: 24px;
    margin-left: 6px;
    margin-right: 6px;
    background-position: -8px -608px;
}

a.ww_skin_pdf:hover {
    background-position: -80px -608px;
}


/* Email */

.ww_skin_email {
    display: inline-block;
    width: 21px;
    height: 24px;
    line-height: 24px;
    margin-left: 6px;
    margin-right: 6px;
    background-position: -8px -704px;
}

a.ww_skin_email:hover {
    background-position: -80px -704px;
}


/* SAG Print */

.ww_skin_print {
    display: inline-block;
    width: 38px;
    height: 38px;
	vertical-align: middle;
    background-position: -296px -792px;
}

.ww_skin_toolbar_button_enabled > .ww_skin_print {
    background-position: -296px -792px;
}

.ww_skin_toolbar_button_enabled.ww_skin_toolbar_background_default > .ww_skin_print:hover {
    background-position: -296px -792px;
}

.ww_skin_toolbar_button_enabled.ww_skin_toolbar_background_selected > .ww_skin_print {
    background-position: -296px -792px;
}

a.ww_skin_print_spacer {
    display: none;
}

.layout_narrow a.ww_skin_print_spacer {
    display: none;
}

/* Toolbar */

#toolbar_div {
}

.ww_skin_toolbar {
    padding: 0;
    margin: 0;
}

.ww_skin_toolbar_cluster {
    vertical-align: top;
	white-space: nowrap;
}

.ww_skin_toolbar_button_enabled {
}

.ww_skin_toolbar_button_enabled:hover {
    background: #2E7B9C;
    background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #8ABBD0), color-stop(0.76, #2E7B9C));
    background-image: -o-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: -moz-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: -webkit-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: -ms-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: linear-gradient(to bottom, #8ABBD0 0%, #2E7B9C 76%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#8ABBD0', endColorstr='#2E7B9C',GradientType=0 );
}

.ww_skin_toolbar_button_disabled {
}

.ww_skin_toolbar_button_disabled a:hover {
    cursor: default;
}

.ww_skin_toolbar_button_left {
    display: inline-block;
    border-style: solid;
    border-width: 0 1px;
    border-color: #2E7B9C #2E7B9C #2E7B9C #8ABBD0;
}

.ww_skin_toolbar_button_center {
    display: inline-block;
    width: 100%;
    height: 38px;
    border-style: solid;
    border-width: 0 1px;
    border-color: #2E7B9C #2E7B9C #2E7B9C #8ABBD0;
}

.ww_skin_toolbar_button_right {
    display: inline-block;
    border-style: solid;
    border-width: 0 1px;
    border-color: #2E7B9C #2E7B9C #2E7B9C #8ABBD0;
}

.ww_skin_toolbar_background_default {
    background: #2E7B9C;
    background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #8ABBD0), color-stop(0.76, #2E7B9C));
    background-image: -o-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: -moz-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: -webkit-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: -ms-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: linear-gradient(to bottom, #8ABBD0 0%, #2E7B9C 76%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#8ABBD0', endColorstr='#2E7B9C',GradientType=0 );
}

.ww_skin_toolbar_background_selected,
.ww_skin_toolbar_background_selected:hover {
    background: #2E7B9C;
    background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #8ABBD0), color-stop(0.76, #2E7B9C));
    background-image: -o-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: -moz-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: -webkit-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: -ms-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
    background-image: linear-gradient(to bottom, #8ABBD0 0%, #2E7B9C 76%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#8ABBD0', endColorstr='#2E7B9C',GradientType=0 );
}

.ww_skin_toolbar_left_background {
    -moz-border-radius: 5px 0 0 5px;
    -webkit-border-radius: 5px 0 0 5px;
    border-radius: 5px 0 0 5px;
}

.ww_skin_toolbar_right_background {
    -moz-border-radius: 0 5px 5px 0;
    -webkit-border-radius: 0 5px 5px 0;
    border-radius: 0 5px 5px 0;
}

.ww_skin_search_form {
    display: inline-block;
}

.ww_skin_search_input {
    vertical-align: top;
	font-size: 14px;
    height: 16px;
    margin: 7px 10px 0 -4px;
    padding-left: 3px;
    -moz-border-radius: 4px;
    -webkit-border-radius: 4px;
    border-radius: 4px;
}


/* TOC Entry */

.ww_skin_toc_container {
}

.ww_skin_toc_level {
    list-style-type: none;
    padding: 0;
    margin: 0;
}

.ww_skin_toc_level_1 > li > div {
    padding-left: 8px;
}

.ww_skin_toc_level_2 > li > div {
    padding-left: 28px;
}

.ww_skin_toc_level_3 > li > div {
    padding-left: 48px;
}

.ww_skin_toc_level_4 > li > div {
    padding-left: 68px;
}

.ww_skin_toc_level_5 > li > div {
    padding-left: 88px;
}

.ww_skin_toc_level_6 > li > div {
    padding-left: 108px;
}

.ww_skin_toc_level_7 > li > div {
    padding-left: 128px;
}

.ww_skin_toc_level_8 > li > div {
    padding-left: 148px;
}

.ww_skin_toc_level_9 > li > div {
    padding-left: 168px;
}

.ww_skin_toc_level_10 > li > div {
    padding-left: 188px;
}

.ww_skin_toc_level_11 > li > div {
    padding-left: 208px;
}

.ww_skin_toc_level_12 > li > div {
    padding-left: 228px;
}

.ww_skin_toc_level_13 > li > div {
    padding-left: 248px;
}

.ww_skin_toc_level_14 > li > div {
    padding-left: 268px;
}

.ww_skin_toc_level_15 > li > div {
    padding-left: 288px;
}

.ww_skin_toc_level_16 > li > div {
    padding-left: 308px;
}

.ww_skin_toc_entry {
    font-family: Arial, sans-serif;
    font-size: 10pt;
    cursor: pointer;
    border-style: solid;
    border-color: #CCCCCC;
    border-width: 0 0 0 0;
    font-size: 10pt;
    margin: 0;
    padding: 4px 0 4px 0;
}

.ww_skin_toc_level_1:first-child > li:first-child > .ww_skin_toc_entry:first-child {
    border-width: 0;
}

.ww_skin_toc_entry:hover {
    background: #EFEFEE;
}

.ww_skin_toc_entry > a {
    color: #007196;
    text-decoration: none;
    padding-right: 14px;
}

.ww_skin_toc_entry > a:visited {
    color: #6186C5;
}

.ww_skin_toc_entry:hover > a {
  color: #007196;
}

.ww_skin_toc_entry:hover > a:visited {
    color: #6186C5;
}

.ww_skin_toc_entry_selected,
.ww_skin_toc_entry_selected:hover {
    background: #CFCFCE;
}

.ww_skin_toc_entry_selected > a:link,
.ww_skin_toc_entry_selected > a:visited,
.ww_skin_toc_entry_selected:hover > a:link,
.ww_skin_toc_entry_selected:hover > a:visited {
    color: black;
}

.ww_skin_toc_folder {
}

.ww_skin_toc_folder > a {
    display: block;
    margin-right: 20px;
    text-indent: 0;
}

.ww_skin_toc_dropdown {
    display: block;
    float: right;
    width: 16px;
    height: 15px;
    margin: 0 4px 0 0;
}

.ww_skin_toc_dropdown_closed {
    background-position: -8px -896px;
}

.ww_skin_toc_entry_selected > .ww_skin_toc_dropdown_closed {
    background-position: -80px -896px;
}

.ww_skin_toc_entry:hover > .ww_skin_toc_dropdown_closed {
    background-position: -80px -896px;
}

.ww_skin_toc_dropdown_open {
    background-position: -8px -992px;
}

.ww_skin_toc_entry_selected > .ww_skin_toc_dropdown_open {
    background-position: -80px -992px;
}

.ww_skin_toc_entry:hover > .ww_skin_toc_dropdown_open {
    background-position: -80px -992px;
}

.ww_skin_toc_container_open {
    display: block;
}

.ww_skin_toc_container_closed {
    display: none;
}


/* Index Entry */

.ww_skin_index_title {
    font-family: Arial, sans-serif;
    font-size: 14pt;
    font-weight: bold;
    margin-bottom: 6pt;
    color: black;
}

.ww_skin_index_list {
    margin: 0;
    padding: 0;
}

.ww_skin_index_list_group {
    margin: 0 0 6pt 12pt;
    padding: 0;
}

.ww_skin_index_list_entry {
    margin: 0 0 0 12pt;
    padding: 0;
}

.ww_skin_index_group {
    font-family: Arial, sans-serif;
    font-size: 10pt;
    color: black;
}

.ww_skin_index_entry {
    font-family: Arial, sans-serif;
    font-size: 10pt;
    color: black;
}

.ww_skin_index_link {
    color: #007196;
    text-decoration: none;
}

.ww_skin_index_link:visited {
    color: #6186C5;
    text-decoration: none;
}

.ww_skin_index_link:hover {
    text-decoration: underline;
}

/* Page Dropdown */

.ww_skin_dropdown_arrow {
    display: inline-block;
    width: 12px;
    height: 12px;
    vertical-align: middle;
}

.ww_skin_page_dropdown_arrow_expanded {
    background-position: -8px -1280px;
}

.ww_skin_page_dropdown_arrow_expanded:hover {
    background-position: -80px -1280px;
    cursor: pointer;
}

.ww_skin_page_dropdown_arrow_collapsed {
    background-position: -8px -1184px;
}

.ww_skin_page_dropdown_arrow_collapsed:hover {
    background-position: -80px -1184px;
    cursor: pointer;
}

.ww_skin_page_dropdown_div_expanded {
    display: block;
}

.ww_skin_page_dropdown_div_collapsed {
    display: none;
}

.ww_skin_page_back_to_top {
    cursor: pointer;
    background-color: #C0C0C0;
    padding: 8px;
    display: block;
    float: right;
    -moz-border-radius: 2px;
    -webkit-border-radius: 2px;
    border-radius: 2px;
}

.ww_skin_page_back_to_top:hover {
    background-color: #808080;
}

.ww_skin_page_back_to_top > a:link, .ww_skin_page_back_to_top > a:visited {
    text-decoration: none;
	color: white;
}

.ww_skin_page_back_to_top > a:link:hover, .ww_skin_page_back_to_top > a:visited:hover {
    text-decoration: none;
	color: white;
}


/* Panel */

.ww_skin_panel_frame {
    padding: 8px 0 0 0;
}

.ww_skin_panel_content {
    background-color: white;
    border-style: solid;
    border-color: #A4A4A4;
    border-width: 1px;
    -moz-border-radius: 4px;
    -webkit-border-radius: 4px;
    border-radius: 4px;
    box-shadow: 1px 1px 4px 1px #A4A4A4;
    margin-right: 4px;
}


/* Lightbox */

.ww_skin_lightbox_background {
    display: none;
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 100;
    background-color: #303030;
    opacity: .70;
    filter: alpha(opacity = 70);
}

.ww_skin_lightbox_frame {
    position: fixed;
    top: 0;
    left: 0;
    visibility: hidden;
    z-index: 101;
    overflow: visible;
    background-color: #000000;
    margin: 0;
    padding: 4px;
    font-size: 1px;
}

.ww_skin_lightbox_close_container {
    position: absolute;
    top: -11px;
    right: -11px;
    background-color: transparent;
    font-size: 1px;
}

.ww_skin_lightbox_close {
    cursor: pointer;
    display: inline-block;
    position: relative;
    width: 28px;
    height: 28px;
    background-position: -8px -1088px;
}

.ww_skin_lightbox_close:hover {
    background-position: -80px -1088px;
}

.ww_skin_lightbox_content {
    margin: 0;
    padding: 0;
    background-color: transparent;
    font-size: 1px;
}


/* Page */

.ww_skin_page_body {
    margin: 0;
    padding: 12px;
    word-wrap: break-word;
}

.ww_skin_page_overflow {
    overflow-x: auto;
    overflow-y: hidden;
}

.ww_skin_breadcrumbs {
    font-family: Arial, sans-serif;
    font-size: 8pt;

    /* Depends upon .ww_skin_page_body and toolbar button borders */
    margin: -8px -8px 0 -8px;
    padding: 4px 4px 4px 4px;
    color: black;
    font-weight: normal;
    background-color: #EEEEEE;
}

.ww_skin_breadcrumbs_parent {
}

.ww_skin_breadcrumbs_divider {
}

.ww_skin_breadcrumbs_current {
}

.ww_skin_breadcrumbs a:link {
    color: #007196;
    text-decoration: none;
}

.ww_skin_breadcrumbs a:visited {
    color: #6186C5;
    text-decoration: none;
}

.ww_skin_breadcrumbs a:link:hover {
    color: #007196;
    text-decoration: underline;
}

.ww_skin_breadcrumbs a:visited:hover {
    color: #6186C5;
    text-decoration: underline;
}

.ww_skin_page_toolbar {
    text-align: right;
    line-height: 24px;
    padding: 4px 0 4px 0;
    overflow: hidden;
    white-space: nowrap;
}

.ww_skin_page_toolbar_divider {
    display: inline-block;
    width: 1px;
    height: 24px;
    margin-left: 6px;
    margin-right: 6px;
    background-color: #CCCCCC;
}

.ww_skin_page_globalization {
    display: none;
}

/* SAG Logo Left */

.ww_skin_toolbar_left_logo {
    display: inline-block;
	vertical-align: middle;
/*    width: 127px; */
    height: 38px;
}


a.ww_skin_left_logo_spacer {
    background-image: none;
    width: 9px;
}

a.ww_skin_left_logo_image {
    vertical-align: middle;
}
/* Disqus */

div#disqus_thread {
    -moz-border-radius: 5px 5px 5px 5px;
    -webkit-border-radius: 5px 5px 5px 5px;
    border-radius: 5px 5px 5px 5px;
    background-color: #EBEBEB;
    margin: 10px;
    padding: 10px;
    text-align: center;
}


.ww_skin {
    background-image: url('connect/images/skin.png');
    background-repeat: no-repeat;
}

html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
}

.layout_wide {
    margin: 0;
    padding: 0 18px 18px 18px;
}

.layout_narrow {
    margin: 0;
    padding: 0;
}

div#progress {
    margin: 0 0 0 0;
    padding: 24px 20% 24px 20%;
}

div#presentation_div {
    margin: 0;
    padding: 0;
    visibility: hidden;
}

.panel_sidebar {
    /* State tracking class */
}

.panel_overlay {
    /* State tracking class */
}

.unknown_page {
    /* State tracking class */
}

.scrolling_supported {
    /* Behavior configuration class */
}


/* Search input */
/*              */

div#layout_div.layout_narrow input.ww_skin_search_input {
    display: none;
    visibility: hidden;
}

div#layout_div.layout_wide input.ww_skin_search_input {
    display: inline;
    visibility: visible;
}

div#layout_div.layout_wide div#presentation_div.panel_overlay input.ww_skin_search_input {
    display: none;
    visibility: hidden;
}


/* Navigation Panel */
/*                  */

div#panel_frame {
    display: none;
    visibility: hidden;
}

div#presentation_div.panel_sidebar div#panel_frame {
    display: block;
    visibility: visible;
}

div#layout_div.layout_narrow div#presentation_div.panel_sidebar div#panel_frame {
    position: static;
}

div#layout_div.layout_wide div#presentation_div.panel_sidebar div#panel_frame {
    position: absolute;
    top: 0;
    left: 0;
    width: 300px;  /* Updated via JavaScript */
    overflow: auto;
    -webkit-overflow-scrolling: touch;
}

body.scrolling_supported div#layout_div.layout_wide div#presentation_div.panel_sidebar div#panel_frame {
    bottom: 0;
}

div#presentation_div.panel_overlay div#panel_frame {
    display: block;
    visibility: visible;
    position: static;
}


/* Page Content */
/*              */

div#page_div {
    position: absolute;
    top: 0;
    right: 0;
    margin: 0;
    padding: 0;
    overflow: auto;
    -webkit-overflow-scrolling: touch;

    -moz-transition: left 0.5s;
    -webkit-transition: left 0.5s;
    -ms-transition: left 0.5s;
    -o-transition: left 0.5s;
    transition: left 0.5s;
}

div#layout_div.layout_narrow div#page_div {
    left: 0;
}

div#layout_div.layout_wide div#page_div {
    left: 0;
}

body.scrolling_supported div#layout_div.layout_wide div#page_div {
    bottom: 0;
}

div#presentation_div.panel_overlay div#page_div {
    display: none;
    visibility: hidden;
}

div#layout_div.layout_wide div#presentation_div.panel_sidebar div#page_div {
    left: 300px;  /* Updated via JavaScript */

    -moz-transition: left 0s;
    -webkit-transition: left 0s;
    -ms-transition: left 0s;
    -o-transition: left 0s;
    transition: left 0s;
}

body.scrolling_supported div#layout_div.layout_wide div#presentation_div.panel_sidebar div#page_div {
    bottom: 0;
}

div#layout_div.layout_narrow div#presentation_div.panel_sidebar div#page_div {
    display: none;
    visibility: hidden;
}

div#layout_div.layout_narrow div#container_div.unknown_page div#page_div {
    left: 0;
}

body.scrolling_supported div#layout_div.layout_narrow div#container_div.unknown_page div#page_div {
    bottom: 0;
}

iframe#page_iframe {
    position: absolute;
    border: none;
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
}

div#layout_div.layout_narrow iframe#page_iframe {
    overflow-x: auto;
    overflow-y: hidden;
}

div#layout_div.layout_wide iframe#page_iframe {
    overflow: auto;
}

div#layout_div.layout_narrow div#container_div.unknown_page iframe#page_iframe {
    overflow: auto;
}

div#container_div {
    position: absolute;
    top: 64px;  /* Updated via JavaScript */
    left: 0;
    right: 0;
}

div#layout_div.layout_wide div#container_div {
    left: 18px;
    right: 18px;
}

body.scrolling_supported div#layout_div.layout_wide div#container_div {
    bottom: 18px;
}

body.scrolling_supported div#layout_div.layout_narrow div#container_div.unknown_page {
    bottom: 0;
}

div#panels {
    display: none;
}

div#toc {
}

div#toc_title {
    background: #2E7B9C;
	background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #8ABBD0), color-stop(0.76, #2E7B9C));
	background-image: -o-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
	background-image: -moz-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
	background-image: -webkit-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
	background-image: -ms-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
	background-image: linear-gradient(to bottom, #8ABBD0 0%, #2E7B9C 76%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#8ABBD0', endColorstr='#2E7B9C',GradientType=0 );
    -moz-border-radius: 2px 2px 0 0;
    -webkit-border-radius: 2px 2px 0 0;
    border-radius: 2px 2px 0 0;
    color: white;
    font-weight: bold;
    margin: 0;
    padding: 4px 0 4px 8px;
    height: 1em;
}

div#toc_content {
    -moz-border-radius: 0 0 2px 2px;
    -webkit-border-radius: 0 0 2px 2px;
    border-radius: 0 0 2px 2px;
}

div#index {
}

div#index_title {
    background: #2E7B9C;
	background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #8ABBD0), color-stop(0.76, #2E7B9C));
	background-image: -o-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
	background-image: -moz-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
	background-image: -webkit-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
	background-image: -ms-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
	background-image: linear-gradient(to bottom, #8ABBD0 0%, #2E7B9C 76%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#8ABBD0', endColorstr='#2E7B9C',GradientType=0 );
    -moz-border-radius: 2px 2px 0 0;
    -webkit-border-radius: 2px 2px 0 0;
    border-radius: 2px 2px 0 0;
    color: white;
    font-weight: bold;
    margin: 0;
    padding: 4px 0 4px 8px;
    height: 1em;
}

div#index_content {
    padding: 12px;
    -moz-border-radius: 0 0 2px 2px;
    -webkit-border-radius: 0 0 2px 2px;
    border-radius: 0 0 2px 2px;
}

div#search {
}

div#search_title {
    background: #2E7B9C;
	background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #8ABBD0), color-stop(0.76, #2E7B9C));
	background-image: -o-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
	background-image: -moz-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
	background-image: -webkit-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
	background-image: -ms-linear-gradient(bottom, #8ABBD0 0%, #2E7B9C 76%);
	background-image: linear-gradient(to bottom, #8ABBD0 0%, #2E7B9C 76%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#8ABBD0', endColorstr='#2E7B9C',GradientType=0 );
    -moz-border-radius: 2px 2px 0 0;
    -webkit-border-radius: 2px 2px 0 0;
    border-radius: 2px 2px 0 0;
    color: white;
    font-weight: bold;
    margin: 0;
    padding: 4px 0 4px 8px;
    height: 1em;
}

iframe#search_iframe {
    width: 100%;
    height: 100%;
    border: none;
    margin: 0;
    padding: 0;
}

div#parcels {
    display: block;
}

--></style><!--[if IE 9]><link rel="StyleSheet" href="css/skin_IE9.css" type="text/css" media="all"><![endif]--></head>
  <body onload="Connect.OnLoad();">
    <div id="layout_div" class="layout_narrow">
      <!-- Company Info -->
      <!--              -->
      <!-- SAG removed  -->
      <!-- Progress Bar -->
      <!--              -->
      <div id="progress">
        <div class="ww_skin_progress_bar">
          <div id="progress_10" class="ww_skin_progress_segment ww_skin_progress_segment_pending">&nbsp;</div>
          <div id="progress_20" class="ww_skin_progress_segment ww_skin_progress_segment_pending">&nbsp;</div>
          <div id="progress_30" class="ww_skin_progress_segment ww_skin_progress_segment_pending">&nbsp;</div>
          <div id="progress_40" class="ww_skin_progress_segment ww_skin_progress_segment_pending">&nbsp;</div>
          <div id="progress_50" class="ww_skin_progress_segment ww_skin_progress_segment_pending">&nbsp;</div>
          <div id="progress_60" class="ww_skin_progress_segment ww_skin_progress_segment_pending">&nbsp;</div>
          <div id="progress_70" class="ww_skin_progress_segment ww_skin_progress_segment_pending">&nbsp;</div>
          <div id="progress_80" class="ww_skin_progress_segment ww_skin_progress_segment_pending">&nbsp;</div>
          <div id="progress_90" class="ww_skin_progress_segment ww_skin_progress_segment_pending">&nbsp;</div>
          <div id="progress_100" class="ww_skin_progress_segment ww_skin_progress_segment_pending">&nbsp;</div>
        </div>
      </div>
      <!-- Presentation -->
      <!--              -->
      <div id="presentation_div">
        <!-- Toolbar -->
        <!--         -->
        <div id="toolbar_div">
          <table class="ww_skin_toolbar" cellpadding="0" cellspacing="0">
            <tr>
              <td class="ww_skin_toolbar_cluster"><span class="ww_skin_toolbar_button_left ww_skin_toolbar_background_default ww_skin_toolbar_button_enabled"><a class="ww_behavior_toc ww_skin ww_skin_toc ww_skin_toc_spacer" title="Contents" href="#">&nbsp;</a><a class="ww_behavior_toc ww_skin ww_skin_toc" title="Contents" href="#">&nbsp;</a><a class="ww_behavior_toc ww_skin ww_skin_toc ww_skin_toc_spacer" title="Contents" href="#">&nbsp;</a></span><span class="ww_skin_toolbar_button_left ww_skin_toolbar_background_default ww_skin_toolbar_button_disabled"><a class="ww_behavior_home ww_skin ww_skin_home ww_skin_home_spacer" title="Home" href="#">&nbsp;</a><a class="ww_behavior_home ww_skin ww_skin_home" title="Home" href="#">&nbsp;</a><a class="ww_behavior_home ww_skin ww_skin_home ww_skin_home_spacer" title="Home" href="#">&nbsp;</a></span><span class="ww_skin_toolbar_button_left ww_skin_toolbar_background_default ww_skin_toolbar_button_disabled"><a class="ww_behavior_print ww_skin ww_skin_print ww_skin_print_spacer" title="Print" href="#">&nbsp;</a><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a><a class="ww_behavior_print ww_skin ww_skin_print ww_skin_print_spacer" title="Print" href="#">&nbsp;</a></span></td>
              <td width="100%" class="ww_skin_toolbar_cluster"><span class="ww_skin_toolbar_button_center ww_skin_toolbar_background_default">&nbsp;</span></td>
              <td class="ww_skin_toolbar_cluster"><span class="ww_skin_toolbar_button_right ww_skin_toolbar_background_default ww_skin_toolbar_button_disabled"><a class="ww_behavior_prev ww_skin ww_skin_prev ww_skin_prev_spacer" title="Previous" href="#">&nbsp;</a><a class="ww_behavior_prev ww_skin ww_skin_prev" title="Previous" href="#">&nbsp;</a><a class="ww_behavior_prev ww_skin ww_skin_prev ww_skin_prev_spacer" title="Previous" href="#">&nbsp;</a></span><span class="ww_skin_toolbar_button_right ww_skin_toolbar_background_default ww_skin_toolbar_button_disabled"><a class="ww_behavior_next ww_skin ww_skin_next ww_skin_next_spacer" title="Next" href="#">&nbsp;</a><a class="ww_behavior_next ww_skin ww_skin_next" title="Next" href="#">&nbsp;</a><a class="ww_behavior_next ww_skin ww_skin_next ww_skin_next_spacer" title="Next" href="#">&nbsp;</a></span><form class="ww_skin_search_form" method="get" action="javascript:''"><span class="ww_skin_toolbar_button_right ww_skin_toolbar_background_default ww_skin_toolbar_button_enabled"><a class="ww_behavior_search ww_skin ww_skin_search ww_skin_search_spacer" title="Search" href="#">&nbsp;</a><a class="ww_behavior_search ww_skin ww_skin_search" title="Search" href="#">&nbsp;</a><a class="ww_behavior_search ww_skin ww_skin_search ww_skin_search_spacer" title="Search" href="#">&nbsp;</a><!-- <input class="ww_skin_search_input"></input> --></span></form></td>
            </tr>
          </table>
        </div>
        <!-- Container -->
        <!--           -->
        <div id="container_div">
          <!-- Panel -->
          <!--       -->
          <div id="panel_frame" class="ww_skin_panel_frame"><div id="panel_content" class="ww_skin_panel_content"></div></div>
          <!-- Page -->
          <!--      -->
          <div id="page_div"><iframe id="page_iframe" name="connect_page" frameborder="0" width="100%" height="100%" onload="Connect.OnDocumentLoad();" src="javascript:''"></iframe></div>
        </div>
      </div>
    </div>
    <!-- Panels -->
    <!--        -->
    <div id="panels">
      <!-- Panel Progress -->
      <!--                -->
      <div id="panel_progress" class="ww_skin_panel_progress_background">
        Panel Progress
      </div>
      <!-- TOC -->
      <!--     -->
      <div id="toc" class="ww_skin_toc_background ww_skin_toc_container">
        <div id="toc_title"></div>
        <div id="toc_content">
          Table of Contents
        </div>
      </div>
      <!-- Index -->
      <!--       -->
      <div id="index" class="ww_skin_index_background">
        <div id="index_title"></div>
        <div id="index_content">
          Index
        </div>
      </div>
      <!-- Search -->
      <!--        -->
      <div id="search" class="ww_skin_search_background">
        <div id="search_title"></div>
        <iframe id="search_iframe" name="connect_search" frameborder="0" width="100%" height="100%" scrolling="no" src="javascript:''"></iframe>
      </div>
    </div>
    <!-- Lightbox -->
    <!--          -->
    <div id="lightbox_background" class="ww_skin_lightbox_background">&nbsp;</div>
    <div id="lightbox_frame" class="ww_skin_lightbox_frame">
      <div class="ww_skin_lightbox_close_container">
        <span id="lightbox_close" class="ww_skin ww_skin_lightbox_close">&nbsp;</span>
      </div>
      <div id="lightbox_content" class="ww_skin_lightbox_content">&nbsp;</div>
    </div>
    <!-- Parcels -->
    <!--         -->
    <div id="parcels">
      <ul>
        <li>
          <div class="ww_skin_toc_entry ww_skin_toc_folder"><span class="ww_skin ww_skin_toc_dropdown ww_skin_toc_dropdown_closed">&nbsp;</span><a id="ehcache-webhelp:1" href="ehcache-webhelp.html" target="_self" title="ehcache-webhelp">ehcache-webhelp</a></div>
        </li>
      </ul>
    </div>
  </body>
</html>