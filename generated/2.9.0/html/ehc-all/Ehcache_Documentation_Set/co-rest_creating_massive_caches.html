<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Creating Massive Caches with Load Balancers and Partitioning</title><link rel="Prev" href="co-rest_code_samples_7.html" title="Previous"><link rel="Next" href="_ehcache_all.1.215.html" title="Next"><link rel="StyleSheet" href="css/_ehcache_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/_ehcache_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pBEyskax75Hy4lWIxwHbsNg" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/Ehcache_Documentation_Set/co-rest_creating_massive_caches.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/_ehcache_all.1.188.html#wwconnect_header">Related Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/_ehcache_all.1.189.html#wwconnect_header">Cache Server User Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/_ehcache_all.1.200.html#wwconnect_header">Using the RESTful Services</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Creating Massive Caches with Load Balancers and Partitioning</span></div><div class="ww_skin_page_toolbar"><!-- Twitter --><!--         --><!-- FaceBook Like --><!--               --><!-- LinkedIn Share --><!--                --><!-- Google +1 --><!--           --><!--        <a wwpage:condition="print-enabled" class="ww_behavior_print ww_skin ww_skin_print" title="Print" wwpage:attribute-title="navigation-print-title" href="#">&#160;</a>  --></div></header><div id="ww3_12_3_7_18_1" class="Heading_3">Creating Massive Caches with Load Balancers and Partitioning</div><div id="ww3_12_3_7_18_3_2" class="Body">The RESTful Ehcache Server is designed to achieve massive scaling using data partitioning - all from a RESTful interface. The largest Ehcache single instances run at around 20GB in memory. The largest disk stores run at 100Gb each. Add nodes together, with cache data partitioned across them, to get larger sizes. 50 nodes at 20GB gets you to 1 Terabyte. Two deployment choices need to be made:</div><div id="ww3_12_3_7_18_3_4_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>where is partitioning performed, and</div><div id="ww3_12_3_7_18_3_4_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>is redundancy required?</div><div id="ww3_12_3_7_18_3_6" class="Body">These choices can be mixed and matched with a number of different deployment topologies.</div><div id="ww3_12_3_7_18_3_8_3" class="Section_Title">Non-redundant, Scalable with client hash-based routing</div><div class="ww_skin_page_overflow"><div id="ww3_12_3_7_18_3_8_5" class="Figure"><img class="Default" src="../Ehcache_Documentation_Set/images/loadbalancer_client_hashing_nonredundant.png" width="315" height="277" style="display: block; float: none; left: 0pt; top: 0pt" alt=""></div></div><div id="ww3_12_3_7_18_3_8_7" class="Body">This topology is the simplest. It does not use a load balancer. Each node is accessed directly by the cache client using REST. No redundancy is provided. The client can be implemented in any language because it is simply a HTTP client. It must work out a partitioning scheme. Simple key hashing, as used by memcached, is sufficient. Here is a Java code sample:</div><div id="ww3_12_3_7_18_3_8_9" class="Preformatted">String[] cacheservers = new String[]{ <br>"cacheserver0.company.com", <br>"cacheserver1.company.com", <br>"cacheserver2.company.com", <br>"cacheserver3.company.com", <br>"cacheserver4.company.com", <br>"cacheserver5.company.com"}; <br>Object key = "123231"; <br>int hash = Math.abs(key.hashCode()); <br>int cacheserverIndex = hash % cacheservers.length; <br>String cacheserver = cacheservers[cacheserverIndex];</div><div id="ww3_12_3_7_18_3_10_3" class="Section_Title">Redundant, Scalable with client hash-based routing</div><div class="ww_skin_page_overflow"><div id="ww3_12_3_7_18_3_10_5" class="Figure"><img class="Default" src="../Ehcache_Documentation_Set/images/loadbalancer_client_hashing.png" width="418" height="277" style="display: block; float: none; left: 0pt; top: 0pt" alt=""></div></div><div id="ww3_12_3_7_18_3_10_7" class="Body">Redundancy is added as shown in the above diagram by: Replacing each node with a cluster of two nodes. One of the existing distributed caching options in Ehcache is used to form the cluster. Options in Ehcache 1.5 are RMI and JGroups-based clusters. Ehcache-1.6 will add JMS as a further option. Put each Ehcache cluster behind VIPs on a load balancer.</div><div id="ww3_12_3_7_18_3_12_3" class="Section_Title">Redundant, Scalable with load balancer hash-based routing</div><div class="ww_skin_page_overflow"><div id="ww3_12_3_7_18_3_12_5" class="Figure"><img class="Default" src="../Ehcache_Documentation_Set/images/loadbalancer_hashing.png" width="418" height="290" style="display: block; float: none; left: 0pt; top: 0pt" alt=""></div></div><div id="ww3_12_3_7_18_3_12_7" class="Body">Many content-switching load balancers support URI routing using some form of regular expressions. So, you could optionally skip the client-side hashing to achieve partitioning in the load balancer itself. For example:</div><div id="ww3_12_3_7_18_3_12_9" class="Preformatted">/ehcache/rest/sampleCache1/[a-h]* =&gt; cluster1   <br>/ehcache/rest/sampleCache1/[i-z]* =&gt; cluster2</div><div id="ww3_12_3_7_18_3_12_11" class="Body">Things get much more sophisticated with F5 load balancers, which let you create iRules in the TCL language. So rather than regular expression URI routing, you could implement key hashing-based URI routing. Remember in Ehcache's RESTful server, the key forms the last part of the URI. e.g. In the URI http://cacheserver.company.com/ehcache/rest/sampleCache1/3432, 3432 is the key. You hash using the last part of the URI. </div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright Â© <span>2014</span><span> </span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/product_online.png" alt="Product Logo"><!--	     <a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank" >Contact&#160;Support</a> --><!--         &#160;&#160;|&#160;&#160;  --><!--         <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank" >Community</a>  --><!--         &#160;&#160;  -->
             |&nbsp;&nbsp;
         <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></div></body></html>