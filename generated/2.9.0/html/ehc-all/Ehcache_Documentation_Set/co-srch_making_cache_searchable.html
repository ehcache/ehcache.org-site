<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Making a Cache Searchable</title><link rel="Prev" href="co-srch_about_searching.html" title="Previous"><link rel="Next" href="co-srch_defining_attributes.html" title="Next"><link rel="StyleSheet" href="css/_ehcache_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/_ehcache_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pMKG0EtTJrEQsyAvVeFyjUA" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/Ehcache_Documentation_Set/co-srch_making_cache_searchable.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/_ehcache_all.1.017.html#wwconnect_header">Product Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/_ehcache_all.1.018.html#wwconnect_header">Ehcache Developer Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/to-srch_searching_a_cache.html#wwconnect_header">Searching a Cache</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Making a Cache Searchable</span></div><div class="ww_skin_page_toolbar"><!-- Twitter --><!--         --><!-- FaceBook Like --><!--               --><!-- LinkedIn Share --><!--                --><!-- Google +1 --><!--           --><!--        <a wwpage:condition="print-enabled" class="ww_behavior_print ww_skin ww_skin_print" title="Print" wwpage:attribute-title="navigation-print-title" href="#">&#160;</a>  --></div></header><div id="ww3_9_3_11_8_1" class="Heading_3">Making a Cache Searchable</div><div id="ww3_9_3_11_8_3_2" class="Body">Caches can be made searchable, on a per cache basis, either by configuration or programmatically.</div><div id="ww3_9_3_11_8_3_4_3" class="Section_Title">By Configuration</div><div id="ww3_9_3_11_8_3_4_5" class="Body">Caches are made searchable by adding a <span class="parmname">&lt;searchable/&gt;</span> tag to the cache definition in the ehcache.xml file.</div><div id="ww3_9_3_11_8_3_4_7" class="Preformatted">&lt;cache name="cache2" maxBytesLocalHeap="16M" eternal="true" <br>maxBytesLocalOffHeap="256M"&gt; <br>    &lt;persistence strategy="localRestartable"/&gt; <br>    &lt;searchable/&gt; <br>&lt;/cache&gt;</div><div id="ww3_9_3_11_8_3_4_9" class="Body">This configuration will scan keys and values and, if they are of supported search types, add them as attributes called “key” and “value,” respectively. If you do not want automatic indexing of keys and values, you can disable it using:</div><div id="ww3_9_3_11_8_3_4_11" class="Preformatted">&lt;cache name="cacheName" ...&gt; <br>    &lt;searchable keys="false" values="false"&gt; <br>       ... <br>    &lt;/searchable&gt; <br>&lt;/cache&gt;</div><div id="ww3_9_3_11_8_3_4_13" class="Body">You might want to do this if you have a mix of types for your keys or values. The automatic indexing will throw an exception if types are mixed.</div><div id="ww3_9_3_11_8_3_4_15" class="Body">If you think that you will want to add search attributes after the cache is initialized, you can explicitly indicate the dynamic search configuration. Set the <span class="parmname">allowDynamicIndexing</span> attribute to “true” to enable use of the Dynamic Attributes extractor. For more information about the Dynamic Attributes extractor, see <span class="heading-page"><a href="../Ehcache_Documentation_Set/co-srch_defining_attributes.html#wwconnect_header" title="Defining Attributes">Defining Attributes</a></span>.</div><div id="ww3_9_3_11_8_3_4_17" class="Preformatted">&lt;cache name="cacheName" ...&gt; <br>    &lt;searchable allowDynamicIndexing="true"&gt; <br>       ... <br>    &lt;/searchable&gt; <br>&lt;/cache&gt;</div><div id="ww3_9_3_11_8_3_4_19" class="Body">Often keys or values will not be directly searchable and instead you will need to extract searchable attributes from the keys or values. The following example shows a more typical case. Attribute extractors are explained in more detail in <span class="heading-page"><a href="../Ehcache_Documentation_Set/co-srch_defining_attributes.html#wwconnect_header" title="Defining Attributes">Defining Attributes</a></span>.</div><div id="ww3_9_3_11_8_3_4_21" class="Preformatted">&lt;cache name="cache3" maxEntriesLocalHeap="10000" eternal="true" <br>maxBytesLocalOffHeap="10G"&gt; <br>    &lt;persistence strategy="localRestartable"/&gt; <br>    &lt;searchable&gt; <br>        &lt;searchAttribute name="age" class="net.sf.ehcache.search. <br>        TestAttributeExtractor"/&gt; <br>        &lt;searchAttribute name="gender" expression="value.getGender()"/&gt; <br>    &lt;/searchable&gt; <br>&lt;/cache&gt;</div><div id="ww3_9_3_11_8_3_6_3" class="Section_Title">Programmatically</div><div id="ww3_9_3_11_8_3_6_5" class="Body">The following example shows how to programmatically create the cache configuration with search attributes.</div><div id="ww3_9_3_11_8_3_6_7" class="Preformatted">Configuration cacheManagerConfig = new Configuration(); <br>CacheConfiguration cacheConfig = new CacheConfiguration("myCache", 0).eternal(true); <br>Searchable searchable = new Searchable(); <br>cacheConfig.addSearchable(searchable); <br>// Create attributes to use in queries. <br>searchable.addSearchAttribute(new SearchAttribute().name("age")); <br>// Use an expression for accessing values. <br>searchable.addSearchAttribute(new SearchAttribute() <br>    .name("first_name") <br>    .expression("value.getFirstName()")); <br>searchable.addSearchAttribute(new SearchAttribute() <br>     .name("last_name") <br> .expression("value.getLastName()")); <br>searchable.addSearchAttribute(new SearchAttribute() <br>     .name("zip_code") <br> .className("net.sf.ehcache.search.TestAttributeExtractor")); <br>cacheManager = new CacheManager(cacheManagerConfig); <br>cacheManager.addCache(new Cache(cacheConfig)); <br>Ehcache myCache = cacheManager.getEhcache("myCache"); <br>// Now create the attributes and queries, then execute. <br>...</div><div id="ww3_9_3_11_8_3_6_9" class="Body">To learn more about the Search API, see the net.sf.ehcache.search* packages in the Ehcache <span class="external"><a href="http://www.ehcache.org/apidocs/2.9/" target="external_window">Javadoc</a></span>.</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright © <span>2014</span><span> </span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/product_online.png" alt="Product Logo"><!--	     <a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank" >Contact&#160;Support</a> --><!--         &#160;&#160;|&#160;&#160;  --><!--         <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank" >Community</a>  --><!--         &#160;&#160;  -->
             |&nbsp;&nbsp;
         <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></div></body></html>