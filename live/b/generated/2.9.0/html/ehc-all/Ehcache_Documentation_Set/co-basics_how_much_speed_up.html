<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>How Much Will an Application Speed up with Caching?</title><link rel="Prev" href="co-basics_will_app_benefit.html" title="Previous"><link rel="Next" href="co-top_topology_types.html" title="Next"><link rel="StyleSheet" href="css/ehcache_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/ehcache_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pQaR69Z_002fCSxGWUB7uZJ_002bN5g" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/Ehcache_Documentation_Set/co-basics_how_much_speed_up.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/ehcache_all.1.003.html#wwconnect_header">About Ehcache</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/ehcache_all.1.006.html#wwconnect_header">Why Caching Works</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">How Much Will an Application Speed up with Caching?</span></div><div class="ww_skin_page_toolbar"><!-- Twitter --><!--         --><!-- FaceBook Like --><!--               --><!-- LinkedIn Share --><!--                --><!-- Google +1 --><!--           --><!--        <a wwpage:condition="print-enabled" class="ww_behavior_print ww_skin ww_skin_print" title="Print" wwpage:attribute-title="navigation-print-title" href="#">&#160;</a>  --></div></header><div id="ww3_7_7_8_1" class="Heading_2">How Much Will an Application Speed up with Caching?</div><div id="ww3_7_7_8_3_2" class="Body">In applications that are I/O bound, which is most business applications, most of the response time is getting data from a database. In a system where each piece of data is used only one time, there is no benefit. In a system where a high proportion of the data is reused, the speed up is significant.</div><div id="ww3_7_7_8_3_4_3" class="Section_Title">Applying Amdahl's Law</div><div id="ww3_7_7_8_3_4_5" class="Body">Amdahl’s law finds the total system speedup from a speedup in part of the system.</div><div id="ww3_7_7_8_3_4_7" class="Preformatted">1 / ((1 - Proportion Sped Up) + Proportion Sped Up / Speed up)</div><div id="ww3_7_7_8_3_4_9" class="Body">The following examples show how to apply Amdahl’s law to common situations. In the interests of simplicity, we assume:</div><div id="ww3_7_7_8_3_4_11_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>A single server.</div><div id="ww3_7_7_8_3_4_11_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>A system with a single thing in it, which when cached, gets 100% cache hits and lives forever.</div><div id="ww3_7_7_8_3_6_3" class="Section_Title">Persistent Object Relational Caching</div><div id="ww3_7_7_8_3_6_5" class="Body">A Hibernate Session.load() for a single object is about 1000 times faster from cache than from a database. .</div><div id="ww3_7_7_8_3_6_7" class="Body">A typical Hibernate query will return a list of IDs from the database, and then attempt to load each. If Session.iterate() is used, Hibernate goes back to the database to load each object.</div><div id="ww3_7_7_8_3_6_9" class="Body">Imagine a scenario where we execute a query against the database that returns a hundred IDs and then loads each one. The query takes 20% of the time and the round trip loading takes the rest (80%). The database query itself is 75% of the time that the operation takes. The proportion being sped up is thus 60% (75% * 80%).</div><div id="ww3_7_7_8_3_6_11" class="Body">The expected system speedup is thus:</div><div id="ww3_7_7_8_3_6_13" class="Preformatted">1 / ((1 - .6) + .6 / 1000) <br>= 1 / (.4 + .0006) <br>= 2.5 times system speedup</div><div id="ww3_7_7_8_3_8_3" class="Section_Title">Web Page Caching</div><div id="ww3_7_7_8_3_8_5" class="Body">An observed speed up from caching a web page is 1000 times. <span class="ph">Ehcache</span> can retrieve a page from its SimplePageCachingFilter in a few milliseconds. </div><div id="ww3_7_7_8_3_8_7" class="Body">Because the web page is the result of a computation, it has a proportion of 100%.</div><div id="ww3_7_7_8_3_8_9" class="Body">The expected system speedup is thus:</div><div id="ww3_7_7_8_3_8_11" class="Preformatted">   1 / ((1 - 1) + 1 / 1000) <br>    = 1 / (0 + .0001) <br>    = 1000 times system speedup</div><div id="ww3_7_7_8_3_10_3" class="Section_Title">Web Page Fragment Caching</div><div id="ww3_7_7_8_3_10_5" class="Body">Caching the entire page is a big win. Sometimes the liveness requirements vary in different parts of the page. Here the SimplePageFragmentCachingFilter can be used.</div><div id="ww3_7_7_8_3_10_7" class="Body">Let's say we have a 1000 fold improvement on a page fragment that taking 40% of the page render time.</div><div id="ww3_7_7_8_3_10_9" class="Body">The expected system speedup is thus:</div><div id="ww3_7_7_8_3_10_11" class="Preformatted">   1 / ((1 - .4) + .4 / 1000) <br>    = 1 / (.6 + .0004) <br>    = 1.6 times system speedup</div><div id="ww3_7_7_8_3_12_3" class="Section_Title">Cache Efficiency</div><div id="ww3_7_7_8_3_12_5" class="Body">Cache entries do not live forever. Some examples that come close are:</div><div id="ww3_7_7_8_3_12_7_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Static web pages or web page fragments, like page footers.</div><div id="ww3_7_7_8_3_12_7_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Database reference data, such as the currencies in the world.</div><div id="ww3_7_7_8_3_12_9" class="Body">Factors that affect the efficiency of a cache are:</div><div id="ww3_7_7_8_3_12_11_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="inlinetitle">Liveliness</span> — How live the data needs to be. The less live, the more it can be cached</div><div id="ww3_7_7_8_3_12_11_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="inlinetitle">Proportion of data cached</span> — What proportion of the data can fit into the resource limits of the machine. For 32-bit Java systems, there was a hard limit of 2 GB of address space. 64-bit systems do not have that constraint, but garbage collection issues often make it impractical to have the Java heap be large. Various eviction algorithms are used to evict excess entries.</div><div id="ww3_7_7_8_3_12_11_6" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="inlinetitle">Shape of the usage distribution</span> — If only 300 out of 3000 entries can be cached, but the Pareto (80/20 rule) distribution applies, it might be that 80% of the time, those 300 will be the ones requested. This drives up the average request lifespan.</div><div id="ww3_7_7_8_3_12_11_8" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="inlinetitle">Read/Write ratio</span> — The proportion of times data is read compared with how often it is written. Things such as the number of empty rooms in a hotel change often, and will be written to frequently. However the details of a room, such as number of beds, are immutable, and therefore a maximum write of 1 might have thousands of reads.</div><div id="ww3_7_7_8_3_12_13" class="Body"><span class="ph">Ehcache</span> keeps these statistics for each cache and each element, so they can be measured directly rather than estimated.</div><div id="ww3_7_7_8_3_14_3" class="Section_Title">Cluster Efficiency</div><div id="ww3_7_7_8_3_14_5" class="Body">Assume a round-robin load balancer where each hit goes to the next server. The cache has one entry which has a variable lifespan of requests, say caused by a time to live (TTL) setting. The following table shows how that lifespan can affect hits and misses.</div><div id="ww3_7_7_8_3_14_7" class="Preformatted">Server 1    Server 2   Server 3    Server 4 <br> M             M           M           M <br> H             H           H           H <br> H             H           H           H <br> H             H           H           H <br> H             H           H           H <br> ...           ...         ...         ...</div><div id="ww3_7_7_8_3_14_9" class="Body">The cache hit ratios for the system as a whole are as follows:</div><div id="ww3_7_7_8_3_14_11" class="Preformatted">Entry <br>Lifespan  Hit Ratio   Hit Ratio  Hit Ratio   Hit Ratio <br>in Hits   1 Server    2 Servers  3 Servers   4 Servers <br>2          1/2           0/2         0/2         0/2 <br>4          3/4           2/4         1/4         0/4 <br>10         9/10          8/10        7/10        6/10 <br>20         19/20         18/20       17/20       16/10 <br>50         49/50         48/50       47/20       46/50</div><div id="ww3_7_7_8_3_14_13" class="Body">The efficiency of a cluster of standalone caches is generally:</div><div id="ww3_7_7_8_3_14_15" class="Preformatted">(Lifespan in requests - Number of Standalone Caches) / Lifespan in requests</div><div id="ww3_7_7_8_3_14_17" class="Body">Where the lifespan is large relative to the number of standalone caches, cache efficiency is not much affected. However when the lifespan is short, cache efficiency is dramatically affected. This problem can be solved using the distributed caching capability provided in Terracotta BigMemory Max. With distributed cache, entries put into a local cache are propagated to other servers in the cluster.</div><div id="ww3_7_7_8_3_16_3" class="Section_Title">A Cache Version of Amdahl's Law</div><div id="ww3_7_7_8_3_16_5" class="Body">Applying Amdahl's law to caching, we now have:</div><div id="ww3_7_7_8_3_16_7" class="Preformatted">1 / ((1 - Proportion Sped Up * effective cache efficiency) + <br>(Proportion Sped Up  * effective cache efficiency)/ Speed up) <br>effective cache efficiency = (cache efficiency) * (cluster efficiency)</div><div id="ww3_7_7_8_3_18_3" class="Section_Title">Web Page Example</div><div id="ww3_7_7_8_3_18_5" class="Body">Applying this formula to the earlier web page cache example where we have cache efficiency of 35% and average request lifespan of 10 requests and two servers:</div><div id="ww3_7_7_8_3_18_7" class="Preformatted"> cache efficiency = .35 <br> cluster efficiency = .(10 - 1) / 10 <br>                = .9 <br> effective cache efficiency = .35 * .9 <br>                        = .315 <br>    1 / ((1 - 1 * .315) + 1 * .315 / 1000) <br>    = 1 / (.685 + .000315) <br>    = 1.45 times system speedup</div><div id="ww3_7_7_8_3_18_9" class="Body">If the cache efficiency is 70% (two servers):</div><div id="ww3_7_7_8_3_18_11" class="Preformatted"> cache efficiency = .70 <br> cluster efficiency = .(10 - 1) / 10 <br>                = .9 <br> effective cache efficiency = .70 * .9 <br>                            = .63 <br>    1 / ((1 - 1 * .63) + 1 * .63 / 1000) <br>    = 1 / (.37 + .00063) <br>    = 2.69 times system speedup</div><div id="ww3_7_7_8_3_18_13" class="Body">If the cache efficiency is 90% (two servers):</div><div id="ww3_7_7_8_3_18_15" class="Preformatted"> cache efficiency = .90 <br> cluster efficiency = .(10 - 1) / 10 <br>                = .9 <br> effective cache efficiency = .9 * .9 <br>                            = .81 <br>    1 / ((1 - 1 * .81) + 1 * .81 / 1000) <br>    = 1 / (.19 + .00081) <br>    = 5.24 times system speedup</div><div id="ww3_7_7_8_3_18_17" class="Body">The benefit is dramatic because Amdahl’s law is most sensitive to the proportion of the system that is sped up.</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright © <span>2014</span><span> </span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/product_online.png" alt="Product Logo"><!--	     <a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank" >Contact&#160;Support</a> --><!--         &#160;&#160;|&#160;&#160;  --><!--         <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank" >Community</a>  --><!--         &#160;&#160;  -->
             |&nbsp;&nbsp;
         <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></div></body></html>