<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>General Ehcache</title><link rel="Prev" href="re-faq_ehcache_troubleshooting.html" title="Previous"><link rel="Next" href="re-faq_ehcache_troubleshooting_3.html" title="Next"><link rel="StyleSheet" href="css/ehcache_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/ehcache_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/Ehcache_Documentation_Set/re-faq_ehcache_troubleshooting_2.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pG3gUV5XBNqn6_002biwdv3Gsjw" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/Ehcache_Documentation_Set/re-faq_ehcache_troubleshooting_2.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/to-title_ehcache_faq.html#wwconnect_header">FAQ</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../Ehcache_Documentation_Set/re-faq_ehcache_troubleshooting.html#wwconnect_header">Questions about Troubleshooting</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">General Ehcache</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_17_14_4_2" class="Heading_2">General Ehcache</div><div id="ww3_17_14_4_4_2_2" class="Section_Title">I have created a new cache and its status is STATUS_UNINITIALISED. How do I initialize it?</div><div id="ww3_17_14_4_4_2_4" class="Body">You need to add a newly created cache to a CacheManager before it gets initialized. Use code like the following:</div><div id="ww3_17_14_4_4_2_6" class="Preformatted">CacheManager manager = CacheManager.create(); <br>Cache myCache = new Cache("testDiskOnly", 0, true, false, 5, 2); <br>manager.addCache(myCache);</div><div id="ww3_17_14_4_4_4_2" class="Section_Title">Why does Ehcache 1.6 use more memory than 1.5?</div><div id="ww3_17_14_4_4_4_4" class="Body">ConcurrentHashMap does not provide an eviction mechanism. We add that ourselves. For caches larger than 5000 elements, we create an extra ArrayList equal to the size of the cache which holds keys. This can be an issue with larger keys. An optimization which cache clients can use is:</div><div id="ww3_17_14_4_4_4_6" class="Preformatted">http://www.codeinstructions.com/2008/09/instance-pools-with-weakhashmap.html <br>To reduce the number of key instances in memory to just one per logical <br>key, all puts to the underlying ConcurrentHashMap could be replaced by <br>map.put(pool.replace(key), value), as well as keyArray.set(index, <br>pool.replace(key)) <br>You can take this approach when producing the keys before handing them over to EhCache.</div><div id="ww3_17_14_4_4_4_8" class="Body">Even with this approach, there is still some added overhead consumed by a reference consumed by each ArrayList element. Update: Ehcache 2.0 will introduce a new implementation for MemoryStore based on a custom ConcurrentHashMap. This version provides fast iteration and does away with the need for the keyArray thus bringing memory use back down to pre 1.6 levels. And with other memory optimizations made to Element in 1.7, memory use will actually be considerably lower than pre 1.6 levels.</div><div id="ww3_17_14_4_4_6_2" class="Section_Title">Why did a crashed standalone Ehcache node using disk store not come up with all data intact?</div><div id="ww3_17_14_4_4_6_4" class="Body">It was configured for temporary disk swapping that is cleared after a restart. For crash-resilient persistence, configure your cache with persistenceStrategy="localRestartable", or use distributed cache, which is backed by the Terracotta Server Array.</div><div id="ww3_17_14_4_4_8_2" class="Section_Title">I added a cache on Client 1, but I can't see it on Client 2. Why not?</div><div id="ww3_17_14_4_4_8_4" class="Body">A clustered cache created programmatically on one application node does not automatically appear on another node in the cluster. The expected behavior is that caches (whether clustered or not) added programmatically on one client are not visible on other clients. CacheManagers are not clustered, only caches are. So if you want to add a cache programmatically, you would have to add it on all the clients. If that cache is configured to be Terracotta clustered, then it will use the same store, and changes applied to cache entries on one client will automatically reflect on the second client.</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright Â© <span>2010</span><span>-2015</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/ehcache_online.png" alt="Product Logo"><!--	     <a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank" >Contact&#160;Support</a> --><!--         &#160;&#160;|&#160;&#160;  --><!--         <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank" >Community</a>  --><!--         &#160;&#160;  -->
          |&nbsp;&nbsp;
        <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>